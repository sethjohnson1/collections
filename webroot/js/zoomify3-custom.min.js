!function(){var e=function(){return this}.call();e.Z={}}(),Z.version="2.3.01 Pro",Z.showImage=function(e,t,i){if(Z.showImage.done)Z.Utils.declareGlobals(),Z.pageContainerID=e,Z.imagePath="undefined"!=typeof t&&null!==t?Z.Utils.stringRemoveTrailingSlashCharacters(t):null,"undefined"!=typeof i&&(Z.parameters=Z.Utils.parseParameters(i)),Z.initialize();else{if(Z.showImage.done=!0,Z.Utils.addCrossBrowserMethods(),Z.Utils.addCrossBrowserEvents(),Z.Utils.declareGlobals(),Z.pageContainerID=e,Z.setCallback=function(e,t){var i=Z.Utils.arrayIndexOfObjectTwoValues(Z.callbacks,"callbackEvent",e,null,"callbackFunction",t);-1==i&&(i=Z.callbacks.length),Z.callbacks[i]={callbackEvent:e,callbackFunction:t}},Z.clearCallback=function(e,t){var i=Z.Utils.arrayIndexOfObjectTwoValues(Z.callbacks,"callbackEvent",e,null,"callbackFunction",t);-1!=i&&(Z.callbacks=Z.Utils.arraySplice(Z.callbacks,i,1))},Z.imagePath="undefined"!=typeof t&&null!==t?Z.Utils.stringRemoveTrailingSlashCharacters(t):null,"undefined"!=typeof i)if("string"==typeof i){var a=unescape(i),n=Z.Utils.stringUnescapeAmpersandCharacters(a);Z.parameters=Z.Utils.parseParameters(n)}else Z.parameters=Z.Utils.parseParameters(i);"complete"!=document.readyState?(Z.Utils.addEventListener(document,"DOMContentLoaded",Z.initialize),Z.Utils.addEventListener(window,"load",Z.initialize)):Z.initialize()}},Z.initialize=function(){Z.Utils.removeEventListener(document,"DOMContentLoaded",Z.initialize),Z.Utils.removeEventListener(window,"load",Z.initialize),Z.Utils.detectBrowserFeatures(),Z.Utils.setParameters(Z.parameters),Z.Viewer=new Z.ZoomifyImageViewer,Z.Utils.stringValidate(Z.copyrightPath)?Z.Utils.enforceCopyright():Z.Viewer.configureViewer(),Z.debug>0&&Z.Utils.trace(Z.Utils.getResource("UI_TRACEDISPLAYDEBUGINFOTEXT"),!1,!0)},Z.ZoomifyImageViewer=function(){function e(e){var e=Z.Utils.event(e);if(e){var t=null;if(null!==Z.editing&&Z.Viewport.verifyEditsUnsaved())return t=Z.Utils.getResource("ALERT_UNSAVEDEDITSEXIST-BROWSER"),e.returnValue=t,t}}function t(){var e=!0;return null!==Z.editing&&Z.Viewport.verifyEditsUnsaved()&&(e=confirm(Z.Utils.getResource("ALERT_UNSAVEDEDITSEXIST-CUSTOM"))),e}function i(e){function t(){Z.clearCallback("readyViewer",t),Z.viewportCurrent=Z.Viewport0,f.viewportSelect(Z.imageSetStart)}Z.imagePath="multiple",Z.tileSourceMultiple&&Z.Utils.validateImagePath(e[0].media),Z.setCallback("readyViewer",t);for(var i=0,a=e.length;a>i;i++){var n=Z.hotspotFileShared?Z.imageSetHotspotPath:e[i].hotspotPath,l=Z.annotationFileShared?Z.imageSetAnnotationPath:e[i].annotationPath;Z["Viewport"+i.toString()]=new Z.ZoomifyViewport(i,e[i].media,l,n);var o=i==Z.imageSetStart;o&&(Z.viewportCurrent=Z["Viewport"+i.toString()],f.viewportSelect(Z.imageSetStart)),Z["Viewport"+i.toString()].setVisibility(o)}}function a(e,t){("undefined"==typeof t||null===t)&&(t="0");var i=document.getElementById("HotspotList"+t);if(i){var a=e?"visible":"hidden";i.style.visibility=a}}function n(e,t){this.id=e.getAttribute("ID"),this.name=e.getAttribute("NAME"),this.internalID=t,this.media=e.getAttribute("MEDIA"),this.annotationPath=e.getAttribute("ANNOTATIONPATH"),this.hotspotPath=e.getAttribute("HOTSPOTPATH")}function l(e,t,i){var a="0"==e?"hidden":"visible",n=parseInt(Z.Utils.getResource("DEFAULT_IMAGESETLISTWIDTH"),10),l=o(e,n,Z.viewerW,Z.viewerH);if("undefined"==typeof imageSetList||null===imageSetList){imageSetList=new Z.Utils.createSelectElement("imageSetList",t,i,n,l.x,l.y,null,a,r,"change"),Z.ViewerDisplay.appendChild(imageSetList);var s=Z.Utils.stringValidate(Z.imageSetListTitle)&&"none"!=Z.imageSetListTitle?1:0;imageSetList.selectedIndex=s}else Z.Utils.arrayClear(i);var u=parseInt(Z.Utils.getResource("DEFAULT_UIELEMENTBASEZINDEX"),10);imageSetList.style.zIndex=(u+4).toString()}function o(e,t,i,a){var n,l,o=15;switch(e){case"0":n=-1e3,l=-1e3;break;case"1":n=o,l=o;break;case"2":n=i-t-o+2,l=o-5;break;case"3":n=i-t-o,l=null!=toolbar?a-2*o:a-1.5*o;break;case"4":n=o,l=null!=toolbar?a-2*o:a-1.5*o;break;default:n=i-t,l=o}return new Z.Utils.Point(n,l)}function r(e){var e=Z.Utils.event(e);if(e){var t=Z.Utils.target(e);if("null"!=t.options[t.selectedIndex].value){var i=Z.Utils.stringValidate(Z.imageSetListTitle)&&"none"!=Z.imageSetListTitle?1:0;f.viewportSelect(t.selectedIndex-i)}}}function s(){f.initializeViewerKeyEventListeners(!0),Z.Utils.addEventListener(Z.ViewerDisplay,"mouseover",c),Z.Utils.addEventListener(Z.ViewerDisplay,"mouseout",c),Z.Utils.addEventListener(Z.ViewerDisplay,"mousemove",Z.Utils.preventDefault),Z.Utils.addEventListener(Z.ViewerDisplay,"mousewheel",c),Z.Utils.addEventListener(Z.ViewerDisplay,"mousewheel",Z.Utils.preventDefault),u(),Z.autoResize&&Z.Utils.addEventListener(window,"resize",c)}function u(){if(document.getElementsByTagName("body"))document.getElementsByTagName("body")[0].onorientationchange=d;else{window.setTimeout(u,100)}}function d(){Z.interactivityOff||Z.fullView&&(Z.ToolbarDisplay&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),Z.NavigatorDisplay&&Z.navigatorVisible>1&&Z.Navigator.setVisibility(!1),Z.Toolbar&&Z.annotations&&(2==Z.annotationPanelVisible||3==Z.annotationPanelVisible)&&Z.Toolbar.setVisibilityAnnotationPanel(!1),Z.Viewport&&(Z.Viewport.toggleFullViewMode(!1),Z.Viewport.toggleFullViewMode(!0)),Z.Toolbar&&Z.annotations&&(2==Z.annotationPanelVisible||3==Z.annotationPanelVisible)&&Z.Toolbar.setVisibilityAnnotationPanel(!0),Z.NavigatorDisplay&&Z.navigatorVisible>1&&Z.Navigator.setVisibility(!0),Z.ToolbarDisplay&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!0))}function p(e){if(!Z.interactivityOff&&Z.keys&&"INPUT"!=document.activeElement.tagName&&"TEXTAREA"!=document.activeElement.tagName){var e=Z.Utils.event(e);if(18==e.keyCode||e.altKey||(Z.viewportCurrent.zoomAndPanAllStop(!0,!0),Z.maskingSelection&&Z.viewportCurrent.clearLabelMask()),e){var t=e.type,i=e.keyCode;if("keydown"==t){switch(Z.keyIsDown=!0,i){case 90:Z.viewportCurrent.zoom("out");break;case 17:Z.viewportCurrent.zoom("out");break;case 65:Z.viewportCurrent.zoom("in");break;case 16:Z.viewportCurrent.zoom("in");break;case 37:Z.animation&&Z.viewportCurrent.getZoom()==Z.minZ?Z.imageSet&&f.viewportPrior():Z.viewportCurrent.pan("left");break;case 38:Z.animation&&Z.viewportCurrent.getZoom()==Z.minZ?Z.imageSet&&f.viewportNext():Z.viewportCurrent.pan("up");break;case 40:Z.animation&&Z.viewportCurrent.getZoom()==Z.minZ?Z.imageSet&&f.viewportPrior():Z.viewportCurrent.pan("down");break;case 39:Z.animation&&Z.viewportCurrent.getZoom()==Z.minZ?Z.imageSet&&f.viewportNext():Z.viewportCurrent.pan("right");break;case 27:Z.fullView?Z.viewportCurrent.toggleFullViewMode(!1):Z.viewportCurrent.reset();break;case 190:Z.rotationVisible&&Z.viewportCurrent.rotateClockwise();break;case 188:Z.rotationVisible&&Z.viewportCurrent.rotateCounterwise();break;case 33:Z.imageSet&&f.viewportNext();break;case 34:Z.imageSet&&f.viewportPrior()}!Z.imageSet||33!=i&&34!=i||(e.preventDefault?e.preventDefault():e.returnValue=!1)}else"keyup"==t&&(Z.keyIsDown=!1,90==i||17==i||65==i||16==i?Z.viewportCurrent.zoom("stop"):37==i||39==i?Z.viewportCurrent.pan("horizontalStop"):38==i||40==i?Z.viewportCurrent.pan("verticalStop"):!Z.imageSet||33!=i&&34!=i||(Z.imageSet&&Z.viewportCurrent.updateView(!0),e.preventDefault?e.preventDefault():e.returnValue=!1))}}}function c(e){var e=Z.Utils.event(e),t=e.type;if(e&&t){var i=Z.Utils.isRightMouseButton(e),a=e.altKey;if("mouseover"!=t&&"mouseout"!=t&&Z.interactivityOff||"mousedown"==t&&(Z.interactivityOff||Z.coordinatesVisible&&a)||i)return;switch(Z.touchSupport&&!Z.clickZoomAndPanBlock&&"touchmove"!=t&&"gesturechange"!=t&&e.preventDefault(),t){case"mouseover":Z.fullView||"TEXTAREA"==document.activeElement.tagName||Z.Viewer.initializeViewerKeyDefaultListeners(!0);break;case"mouseout":Z.Viewer.initializeViewerKeyDefaultListeners(!1)}if(g(e),"mousedown"==t||"mousemove"==t)return!1}}function g(e){var e=Z.Utils.event(e),t=e.type;if(e&&t){var i,a,n;switch(i=Z.Utils.target(e),a=Z.Utils.relatedTarget(e),"resize"!=t&&(n=Z.Utils.getMousePosition(e)),"DOMMouseScroll"==t&&(t="mousewheel"),t){case"mouseover":var l=Z.Utils.nodeIsInViewer(i),o=Z.Utils.nodeIsInViewer(a);l&&o||(Z.viewportCurrent&&Z.viewportCurrent.showLists(!0),Z.ToolbarDisplay&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!0),Z.NavigatorDisplay&&Z.navigatorVisible>1&&Z.Navigator.setVisibility(!0),Z.RulerDisplay&&Z.rulerVisible>1&&Z.Ruler.setVisibility(!0),Z.Toolbar&&Z.annotations&&(2==Z.annotationPanelVisible||3==Z.annotationPanelVisible)&&Z.Toolbar.setVisibilityAnnotationPanel(!0),Z.mouseOutDownPoint=null);break;case"mouseout":var l=Z.Utils.nodeIsInViewer(i),o=Z.Utils.nodeIsInViewer(a),r="[object HTMLSelectElement]"==i||"[object HTMLOptionElement]"==i||"[object HTMLSelectElement]"==a||"[object HTMLOptionElement]"==a;l&&o||r||(Z.mouseIsDown?Z.mouseOutDownPoint=new Z.Utils.Point(n.x,n.y):(Z.viewportCurrent&&Z.viewportCurrent.showLists(!1),Z.ToolbarDisplay&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),Z.NavigatorDisplay&&Z.navigatorVisible>1&&Z.Navigator.setVisibility(!1),Z.RulerDisplay&&Z.rulerVisible>1&&Z.Ruler.setVisibility(!1),Z.Toolbar&&Z.annotations&&(2==Z.annotationPanelVisible||3==Z.annotationPanelVisible)&&Z.Toolbar.setVisibilityAnnotationPanel(!1)));break;case"resize":E||(E=window.setTimeout(m,v));break;case"mousewheel":var s=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));Z.viewportCurrent.mouseWheelHandler(s)}}}function m(){E&&(window.clearTimeout(E),E=null,h())}function h(){var e=Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay),t=Z.viewportCurrent.calculateZoomForResize(Z.viewportCurrent.getZoom(),Z.viewerW,Z.viewerH,e.x,e.y);f.resizeViewer(e.x,e.y,t)}var f=this,T=[];Z.ViewerDisplay=Z.Utils.createContainerElement("div","ViewerDisplay","inline-block","relative","hidden","100%","100%","0px","0px","none","0px","transparent none","0px","0px","normal","pointer"),Z.pageContainer=document.getElementById(Z.pageContainerID);Z.Utils.getElementStyle(Z.pageContainer);Z.ViewerDisplay.style["-webkit-touch-callout"]="none",Z.ViewerDisplay.style["-moz-user-select"]="none",Z.ViewerDisplay.style["-khtml-user-select"]="none",Z.ViewerDisplay.style["-webkit-user-select"]="none",Z.ViewerDisplay.style["-ms-user-select"]="none",Z.ViewerDisplay.style["-o-user-select"]="none",Z.ViewerDisplay.style["user-select"]="none";var b=Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay);Z.viewerW=b.x,Z.viewerH=b.y,Z.pageContainer.innerHTML="",Z.pageContainer.appendChild(Z.ViewerDisplay),Z.autoResize=Z.autoResize!==!1&&Z.Utils.isElementFluid(Z.pageContainer);var E,v=parseInt(Z.Utils.getResource("DEFAULT_AUTORESIZESKIPDURATION"),10);if(Z.mouseWheelCompleteDuration=parseInt(Z.Utils.getResource("DEFAULT_MOUSEWHEELCOMPLETEDURATION"),10),Z.imageSet)var I=[],y=[];this.configureViewer=function(){function e(){Z.clearCallback(i,e),s(),f.configureComponents(Z.viewportCurrent)}function t(){Z.clearCallback("readyViewer",t),(Z.Utils.getMessage()==Z.Utils.getResource("ALERT_LOADINGIMAGESET")||Z.Utils.getMessage()==Z.Utils.getResource("ALERT_LOADINGANNOTATIONS"))&&Z.Utils.hideMessage(),Z.imageSet&&precacheBackfillTilesDelayed()}var i=Z.imageSet?"initializedViewer":"initializedViewport";if(Z.setCallback(i,e),Z.setCallback("readyViewer",t),Z.imageSet){Z.Utils.showMessage(Z.Utils.getResource("ALERT_LOADINGIMAGESET"),!1,null,"center");var a,n=new Z.NetConnector;".xml"!=Z.imageSetPath.toLowerCase().substring(Z.imageSetPath.length-4,Z.imageSetPath.length)&&(Z.imageSetPath=Z.imageSetPath+"/"+Z.Utils.getResource("DEFAULT_IMAGESETXMLFILE")),a=Z.Utils.cacheProofPath(Z.imageSetPath),n.loadXML(a)}else Z.Viewport=new Z.ZoomifyViewport,Z.viewportCurrent=Z.Viewport},this.configureComponents=function(e){Z.toolbarVisible>0&&!Z.Toolbar&&(Z.Toolbar=new Z.ZoomifyToolbar(e)),Z.navigatorVisible>0&&!Z.Navigator&&(Z.Navigator=new Z.ZoomifyNavigator(e),Z.Navigator&&Z.Navigator.validateNavigatorGlobals()),Z.rulerVisible>0&&!Z.Ruler&&(Z.Ruler=new Z.ZoomifyRuler(e))},this.getVersion=function(){return Z.version},this.setSizeAndPosition=function(e,t,i,a,n){Z.viewerW=e,Z.viewerH=t,Z.ViewerDisplay.style.width=e+"px",Z.ViewerDisplay.style.height=t+"px",Z.Viewport&&Z.Viewport.getStatus("initialized")&&Z.Viewport.setSizeAndPosition(e,t,i,a);var l=1==Z.toolbarPosition?t-Z.toolbarH:0;Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&(Z.Toolbar.setSizeAndPosition(e,null,null,l),Z.toolbarAutoShowHide&&Z.Toolbar.show(!0)),Z.NavigatorDisplay&&Z.Navigator.getInitialized()&&(Z.Navigator.setSizeAndPosition(null,null,i,a,Z.navigatorFit),Z.navigatorVisible>1&&Z.Navigator.setVisibility(!0)),n&&Z.Viewport.updateView(!0)},this.getImagePath=function(){return f.getImage()},this.getImage=function(){return Z.imagePath},this.setImagePath=function(e,t){"undefined"!=typeof t&&Z.Utils.stringValidate(t)&&(Z.imageProperties=t),f.setImage(e)},this.setImage=function(e,i,a){if(Z.Viewport&&(Z.Viewport.getStatus("initialized")||a)){Z.Viewport.zoomAndPanAllStop(!0);var n=!0;if(null!==Z.editing&&(n=t()),n)if(Z.maskingSelection&&f.clearLabelMask(),Z.Utils.clearImageParameters(),Z.imagePath=Z.Utils.stringRemoveTrailingSlashCharacters(e),Z.Utils.validateImagePath(),Z.Viewport.setImagePath(Z.imagePath),"undefined"!=typeof i&&(Z.parameters=Z.Utils.parseParameters(i)),a&&Z.Utils.setParameters(Z.parameters),"unconverted"==Z.tileSource)Z.Viewport.loadUnconvertedImage(e);else if(Z.imageProperties){var l=Z.Utils.xmlConvertTextToDoc(Z.imageProperties);Z.Viewport.parseImageXML(l)}else{var o=new Z.NetConnector;Z.Viewport.loadImageProperties(Z.imagePath,o)}}},this.setImageWithFade=function(e,t,i){Z.Viewport&&(Z.Viewport.getStatus("initialized")||i)&&(Z.slideTransitionTimeout=window.setTimeout(function(){Z.Viewport.slideTransitionTimeoutHandler("out",e,t,i)},50))},this.setTourPath=function(e,t){Z.Viewport&&Z.Viewport.getStatus("initialized")&&Z.Viewport.setHotspotPath(e,t)},this.setHotspotPath=function(e,t){Z.Viewport&&Z.Viewport.getStatus("initialized")&&Z.Viewport.setHotspotPath(e,t)},this.setAnnotationPath=function(e,t){Z.Viewport&&Z.Viewport.getStatus("initialized")&&Z.Viewport.setAnnotationPath(e,t)},this.initializePageExitEventHandler=function(){Z.Utils.addEventListener(window,"beforeunload",e)},this.getStatus=function(e){var t=Z.Utils.arrayIndexOfObjectValue(T,"state",e),i=-1==t?!1:T[t].status;return i},this.setStatus=function(e,t){var i=!1,a=Z.Utils.arrayIndexOfObjectValue(T,"state",e);-1==a?(i=t,T[T.length]={state:e,status:t}):(!T[a].status&&t&&(i=!0),T[a].status=t),i&&(Z.Utils.validateCallback(e+"Viewer"),f.validateViewerReady(e))},this.validateViewerStatus=function(e){var t=!0;if(Z.imageSet)for(var i=0,a=Z.imageSetLength;a>i;i++){var n=Z["Viewport"+i.toString()];if(!n.getStatus(e)){t=!1;break}}t&&f.setStatus(e,!0)},this.validateViewerReady=function(){var e=Z.Viewport&&Z.Viewport.getStatus("initialized")&&("unconverted"==Z.tileSource||Z.Viewport.getStatus("precacheLoaded")&&Z.Viewport.getStatus("backfillLoaded")&&Z.Viewport.getStatus("backfillDrawn"))&&Z.Viewport.getStatus("displayLoaded")&&Z.Viewport.getStatus("displayDrawn"),t=!Z.hotspots||Z.Viewport.getStatus("hotspotsLoaded"),i=!Z.annotations||Z.Viewport.getStatus("annotationsLoaded")&&Z.Viewport.getStatus("annotationPanelInitialized"),a=0==Z.ToolbarVisible||Z.Toolbar&&Z.Toolbar.getInitialized(),n=!Z.NavigatorVisible||Z.Navigator&&Z.Navigator.getInitialized(),l=!Z.RulerVisible||Z.Ruler&&Z.Ruler.getInitialized(),o=!Z.imageSet||Z.Viewer&&Z.Viewer.getStatus("initialized")&&("unconverted"==Z.tileSource||Z.Viewer.getStatus("precacheLoaded")&&Z.Viewer.getStatus("backfillLoaded")&&Z.Viewer.getStatus("backfillDrawn"))&&Z.Viewer.getStatus("displayLoaded")&&Z.Viewer.getStatus("displayDrawn"),r=!Z.imageSet||!Z.hotspots||Z.Viewer&&Z.Viewer.getStatus("hotspotsLoaded"),s=!Z.imageSet||!Z.annotations||Z.Viewer&&Z.Viewer.getStatus("annotationsLoaded")&&Z.Viewer.getStatus("annotationPanelInitialized"),u=e&&t&&i&&a&&n&&l&&o&&r&&s;return u&&Z.Viewer.setStatus("ready",!0),u},this.parseImageSetXML=function(e,t){Z.Utils.arrayClear(I),Z.Utils.arrayClear(y),Z.imageSetListPosition=Z.Utils.getResource("DEFAULT_IMAGESETLISTPOSITION");var a=Z.Utils.getResource("DEFAULT_IMAGESETLISTSOURCE");Z.imageSetListTitle=Z.Utils.getResource("UI_IMAGESETLISTTITLE"),Z.imageSetStart=parseInt(Z.Utils.getResource("UI_IMAGESETSTART"),10),Z.imageSetLoop="1"==Z.Utils.getResource("UI_IMAGESETLOOP"),Z.sliderImageSetVisible="1"==Z.Utils.getResource("UI_IMAGESETSLIDER"),Z.animationAxis=Z.Utils.getResource("DEFAULT_ANIMATIONAXIS"),Z.animator=Z.Utils.getResource("DEFAULT_ANIMATOR");var o=e.getElementsByTagName("SETUP")[0];if(o){var r=o.getAttribute("CHOICELIST");Z.Utils.stringValidate(r)&&(Z.imageSetListPosition=r);var s=o.getAttribute("LISTSOURCE");Z.Utils.stringValidate(s)&&(a=s);var u=o.getAttribute("LISTTITLE");Z.Utils.stringValidate(u)&&(Z.imageSetListTitle=u);var d=o.getAttribute("HOTSPOTPATH");Z.Utils.stringValidate(d)&&(Z.imageSetHotspotPath=d,Z.hotspotFileShared=!0);var p=o.getAttribute("ANNOTATIONPATH");Z.Utils.stringValidate(p)&&(Z.imageSetAnnotationPath=p,Z.annotationFileShared=!0);var c=o.getAttribute("START");Z.Utils.stringValidate(c)&&(Z.imageSetStart=parseInt(c,10)-1);var g=o.getAttribute("LOOP");Z.Utils.stringValidate(g)&&(Z.imageSetLoop="1"==g);var m=o.getAttribute("SLIDER");Z.Utils.stringValidate(m)&&(Z.sliderImageSetVisible="1"==m);var h=o.getAttribute("AXIS");Z.Utils.stringValidate(h)&&(Z.animationAxis=h);var f=o.getAttribute("ANIMATOR");Z.Utils.stringValidate(f)&&(Z.animator=f)}for(var T="animation"==t?"IMAGE":"SLIDE",b=e.getElementsByTagName(T),E=0,v=b.length;v>E;E++){var U=new n(b[E],E);I[I.length]=U;var S="NAME"==a?U.name:U.media.substring(U.media.lastIndexOf("/")+1,U.media.length);y[y.length]={text:S,value:U.internalID}}Z.imageSetLength=I.length,l(Z.imageSetListPosition,Z.imageSetListTitle,y),i(I)},precacheBackfillTilesDelayed=function(){for(var e=0,t=Z.imageSetLength;t>e;e++){var i=Z["Viewport"+e.toString()];i.getStatus("backfillPrecached")||i.precacheBackfillTiles(!0)}},this.viewportChange=function(e){"stop"!=e?("forward"==e?Z.Viewer.viewportNext():Z.Viewer.viewportPrior(),Z.animation&&(Z.viewportChangeTimeout=window.setTimeout(function(){Z.Viewer.viewportChange(e)},10))):Z.viewportChangeTimeout&&(window.clearTimeout(Z.viewportChangeTimeout),Z.viewportChangeTimeout=null)},this.viewportPrior=function(e){e="undefined"==typeof e||null===e?0:Math.round(e);var t=Z.imageSetLength-1,i=Z.viewportCurrentID-(1-e);0>i&&(Z.imageSetLoop?(-t>i&&(i=-(-i%t)),0>i&&(i+=t+1)):i=0),f.viewportSelect(i)},this.viewportNext=function(e){e="undefined"==typeof e||null===e?0:Math.round(e);var t=Z.imageSetLength-1,i=Z.viewportCurrentID+(1+e);i>t&&(Z.imageSetLoop?i%=t+1:i=t),f.viewportSelect(i)},this.viewportSelect=function(e,t){var i=Z.mouseIsDown||Z.buttonIsDown||Z.keyIsDown,n=null===Z.Viewport;("undefined"==typeof e||null===e)&&(e=0);var e=Math.abs(e),l=e.toString(),o=Z["Viewport"+l],r=o==Z.viewportCurrent;if("undefined"!=typeof o&&(!r||n||!i)){var s=Z.viewportCurrentID.toString(),u=Z.viewportCurrent;if(Z.viewportCurrent=o,Z.viewportCurrentID=e,Z.viewportCurrent.setVisibility(!0),Z.Viewport=Z.viewportCurrent,r||u.setVisibility(!1),Z.viewportCurrent&&Z.viewportCurrent.getStatus("initialized")){var d=Z.viewportCurrent.getViewW()!=Z.viewerW||Z.viewportCurrent.getViewH()!=Z.viewerH;if(d?Z.viewportCurrent.syncViewportResize(Z.imageX,Z.imageY,Z.imageZ,Z.imageR):Z.viewportCurrent.updateView(!0),u&&(Z.hotspotFileShared||Z.annotationFileShared)){var p=u.getHotspots();p&&Z.viewportCurrent.setHotspots(p)}if(Z.Navigator&&Z.Navigator.getInitialized()&&Z.navigatorVisible>0&&Z.Navigator.setViewport(Z.viewportCurrent),Z.Toolbar&&Z.Toolbar.getInitialized()&&Z.toolbarVisible>0&&("undefined"!=typeof t&&null!==t&&t||Z.Toolbar.syncSliderToViewportImageSet(Z.viewportCurrentID),Z.Toolbar.setViewport(Z.viewportCurrent)),Z.hotspots&&(a(!1,s),a(!0,l)),imageSetList){imageSetList.blur();var c=Z.Utils.stringValidate(Z.imageSetListTitle)&&"none"!=Z.imageSetListTitle?1:0;imageSetList.selectedIndex=Z.viewportCurrentID+c}}}},this.setVisibilityHotspotChoiceList=function(e,t){a(e,t)},this.sizeAndPositionImageSetList=function(){var e=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONPANELWIDTH"),10)+2,t=o(Z.imageSetListPosition,e,Z.viewerW,Z.viewerH);imageSetList.style.left=t.x+"px",imageSetList.style.top=t.y+"px"},this.initializeViewerKeyEventListeners=function(e){e?(Z.Utils.addEventListener(document,"keydown",p),Z.Utils.addEventListener(document,"keyup",p)):(Z.Utils.removeEventListener(document,"keydown",p),Z.Utils.removeEventListener(document,"keyup",p))},this.initializeViewerKeyDefaultListeners=function(e){e?(Z.Utils.addEventListener(document,"keydown",Z.Utils.preventDefault),Z.Utils.addEventListener(document,"keyup",Z.Utils.preventDefault)):(Z.Utils.removeEventListener(document,"keydown",Z.Utils.preventDefault),Z.Utils.removeEventListener(document,"keyup",Z.Utils.preventDefault))},this.autoResizeViewer=function(){h()},this.resizeViewer=function(e,t,i){f.setSizeAndPosition(e,t,0,0,!1),Z.viewportCurrent.resizeViewport(Z.imageX,Z.imageY,i,Z.imageR)},this.mouseWheelCompleteHandler=function(){Z.mouseWheelIsDown=!1,Z.mouseWheelCompleteTimer&&(window.clearTimeout(Z.mouseWheelCompleteTimer),Z.mouseWheelCompleteTimer=null,Z.zooming="stop",Z.viewportCurrent.updateView(!0))}},Z.ZoomifyViewport=function(e,t,i,a){function n(e){var t=Z.Utils.getResource("DEFAULT_SLIDESXMLFILE");if(".xml"!=Z.slidePath.toLowerCase().substring(Z.slidePath.length-4,Z.slidePath.length)&&(Z.slidePath=Z.slidePath+"/"+t),XMLPath=Z.Utils.cacheProofPath(Z.slidePath),"undefined"!=typeof XMLPath&&Z.Utils.stringValidate(XMLPath)){var e=new Z.NetConnector;e.loadXML(XMLPath)}}function l(e,t,i,a,n,l,o,r){if(g(),Z.imageW=e,Z.imageH=t,Z.imageCenterX=Z.imageW/2,Z.imageCenterY=Z.imageH/2,mn=l,hn=o,fn=r,vn=n,yn=i,Un=a,b(),m(Kn,jn,qn,Qn),Zn.validateXYZDefaults(),Cn>Kl?(Dn=pt(Mn,Z.initialZ),xa&&Oa.scale(Dn,Dn)):(xa=null,wa=null,Oa=null),Pn=pt(Vn,Z.initialZ),On=pt(Nn,Z.initialZ),Rn=On,Z.useCanvas)try{Ha.scale(On,On)}catch(s){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE")),console.log("In function initializeViewportContinue scaling canvas:  "+s)}if(Ya&&Pt(),Z.screensaver&&(Z.Utils.validateCallback("screensaverStarting"),Z.Utils.functionCallWithDelay(function(){Zn.tourStart()},750)),qa&&(Zn.setDrawingColor("buttonColor0"+Sa,!0),Ft(Sa)),Z.virtualPointerVisible&&Zn.showVirtualPointer(),"unconverted"!=Z.tileSource&&Zn.precacheBackfillTiles(),Qi(Z.initialX,Z.initialY,Z.initialZ,Z.initialR,null,!0),Z.coordinatesVisible&&Zn.setCoordinatesDisplayVisibility(!0),Z.initialFullPage&&Zn.toggleFullViewMode(!0),sa(),Zn.setStatus("initialized",!0),Zn.syncViewportRelated(),Z.slideshow){var u=Z.Utils.stringValidate(Z.slideListTitle)&&"none"!=Z.slideListTitle?1:0;"undefined"!=typeof Ur&&(Ur.selectedIndex=u),Lr&&!Z.slideshowPlaying?Zn.slideshowStart():Z.slideshowPlaying&&Zn.nextSlide()}if("multiple"==Z.imagePath){var d=Z.hotspots?"hotspotsLoadedViewer":Z.annotations?"annotationsLoadedViewer":null,p=function(){window.setTimeout(function(){Z.viewportCurrent.redisplayHotspots()},1500)};null!==d&&Z.setCallback(d,p)}}function o(e,t,i,a,n,l,o,s){Zn.setStatus("initialized",!1),r(!0,!1,!0,!0),Z.imageW=e,Z.imageH=t,Z.imageCenterX=Z.imageW/2,Z.imageCenterY=Z.imageH/2,mn=l,hn=o,fn=s,vn=n,yn=i,Un=a,b(),Z.Utils.setParameters(Z.parameters),c(),g(),Zn.validateXYZDefaults(),Cn>Kl?(Dn=pt(Mn,Z.initialZ),Oa.restore(),Oa.scale(Dn,Dn)):xa=wa=Oa=null,Pn=pt(Vn,Z.initialZ),On=pt(Nn,Z.initialZ),Rn=On,Z.useCanvas&&(Ha.restore(),Ha.scale(On,On)),Ya&&Pt(),qa&&(Zn.setDrawingColor("buttonColor0"+Sa,!0),Ft(Sa)),Z.virtualPointerVisible&&Zn.showVirtualPointer(),"unconverted"!=Z.tileSource&&Zn.precacheBackfillTiles(),Zn.setSizeAndPosition(Kn,jn,qn,Qn),Qi(Z.initialX,Z.initialY,Z.initialZ,Z.initialR,null,!0),Zn.setStatus("initialized",!0),Z.Navigator&&Z.navigatorVisible>0&&Z.Navigator.setImage(Z.imagePath),Z.slideshowPlaying&&Zn.nextSlide()}function r(e,t,i,a){e&&s(),t&&u(),i&&d(),a&&p()}function s(){fl=0,Tl=0,"undefined"!=typeof Zl&&Z.Utils.arrayClear(Zl),"undefined"!=typeof gl&&Z.Utils.arrayClear(gl),"undefined"!=typeof cl&&Z.Utils.arrayClear(cl),"undefined"!=typeof Dl&&Z.Utils.arrayClear(Dl),"undefined"!=typeof Cl&&Z.Utils.arrayClear(Cl),"undefined"!=typeof Nl&&Z.Utils.arrayClear(Nl),"undefined"!=typeof Vl&&Z.Utils.arrayClear(Vl),"undefined"!=typeof kl&&Z.Utils.arrayClear(kl),"undefined"!=typeof Ml&&Z.Utils.arrayClear(Ml),"undefined"!=typeof ml&&Z.Utils.arrayClear(ml),"undefined"!=typeof hl&&Z.Utils.arrayClear(hl),"undefined"!=typeof Gl&&Z.Utils.arrayClear(Gl),"undefined"!=typeof Xl&&Z.Utils.arrayClear(Xl),"undefined"!=typeof zl&&Z.Utils.arrayClear(zl),"undefined"!=typeof Wl&&Z.Utils.arrayClear(Wl)}function u(){Cn=1,Nn=0,Vn=0,kn=!1,"undefined"!=typeof _n&&Z.Utils.arrayClear(_n),"undefined"!=typeof Hn&&Z.Utils.arrayClear(Hn),"undefined"!=typeof Bn&&Z.Utils.arrayClear(Bn),"undefined"!=typeof zn&&Z.Utils.arrayClear(zn),"undefined"!=typeof Xn&&Z.Utils.arrayClear(Xn),"undefined"!=typeof Gn&&Z.Utils.arrayClear(Gn),"undefined"!=typeof tierTileOffsetsCount&&Z.Utils.arrayClear(tierTileOffsetsCount),"undefined"!=typeof tierTileOffsetChunks&&Z.Utils.arrayClear(tierTileOffsetChunks),"undefined"!=typeof tierTileOffsetLast&&Z.Utils.arrayClear(tierTileOffsetLast),"undefined"!=typeof Wn&&Z.Utils.arrayClear(Wn),"undefined"!=typeof tierTileByteCountsCount&&Z.Utils.arrayClear(tierTileByteCountsCount),"undefined"!=typeof tierTileByteCountChunks&&Z.Utils.arrayClear(tierTileByteCountChunks),"undefined"!=typeof tierTileByteCountLast&&Z.Utils.arrayClear(tierTileByteCountLast)}function d(){Ya&&("undefined"!=typeof fr&&Z.Utils.arrayClear(fr),"undefined"!=typeof Tr&&Z.Utils.arrayClear(Tr)),qa&&("undefined"!=typeof Dr&&Z.Utils.arrayClear(Dr),"undefined"!=typeof Cr&&Z.Utils.arrayClear(Cr),null!=ps?(ps.parentNode.removeChild(ps),ps=null,"undefined"!=typeof fs&&Z.Utils.arrayClear(fs)):(null!=Ts&&(Ts.parentNode.removeChild(Ts),Ts=null,"undefined"!=typeof Us&&Z.Utils.arrayClear(Us)),null!=Es&&(Es.parentNode.removeChild(Es),Es=null,"undefined"!=typeof Ls&&Z.Utils.arrayClear(Ls),"undefined"!=typeof xs&&Z.Utils.arrayClear(xs)),null!=bs&&(bs.parentNode.removeChild(bs),bs=null,"undefined"!=typeof Ss&&Z.Utils.arrayClear(Ss),"undefined"!=typeof As&&Z.Utils.arrayClear(As))))}function p(){xa&&Z.Utils.clearDisplay(xa),Na&&Z.Utils.clearDisplay(Na),Fa&&Z.Utils.clearDisplay(Fa),za&&Z.Utils.clearDisplay(za),Ya&&Z.Utils.clearDisplay(Ya),dn&&Z.Utils.clearDisplay(dn),qa&&(Z.Utils.clearDisplay(qa),qa=null),tn&&Z.Utils.clearDisplay(tn),on&&Z.Utils.clearDisplay(on)}function c(e){("undefined"==typeof e||null===e)&&(e=0);var t=e.toString();Z.useCanvas&&(xa||(La=Z.Utils.createContainerElement("canvas","oversizeDisplay"+t,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),Z.ViewerDisplay.appendChild(La),xa=La,wa=xa.style)),Pa||(Ra=Z.Utils.createContainerElement("div","viewportContainer"+t,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),Z.ViewerDisplay.appendChild(Ra),Pa=Ra,Da=Pa.style),Na||(Ca=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportBackfillDisplay"+t,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),Ra.appendChild(Ca),Na=Ca,Va=Na.style),Fa||(Ma=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportDisplay"+t,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),Ra.appendChild(Ma),Fa=Ma,_a=Fa.style),Z.useCanvas&&(za||(Ba=Z.Utils.createContainerElement("canvas","transitionCanvas","none","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),Ra.appendChild(Ba),za=Ba,Xa=za.style)),Z.Utils.stringValidate(Z.watermarkPath)&&!Ya&&(Wa=Z.Utils.createContainerElement("div","watermarkDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),Ra.appendChild(Wa),Ya=Wa,Ka=Ya.style),Z.maskVisible&&(Z.hotspots||Z.annotations)&&!dn&&(un=Z.Utils.createContainerElement("canvas","maskCanvas","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),Ra.appendChild(un),dn=un,pn=dn.style,pn.display="none"),(Z.measureVisible||Z.tour&&!Z.screensaver||Z.hotspots||Z.annotations)&&((Z.annotations||Z.measureVisible)&&Z.useCanvas&&!tn&&(en=Z.Utils.createContainerElement("canvas","drawingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),Ra.appendChild(en),tn=en,an=tn.style,(null!==Z.editMode||Z.measureVisible&&!on)&&(ln=Z.Utils.createContainerElement("canvas","editingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),Ra.appendChild(ln),on=ln,rn=on.style)),qa||(ja=Z.Utils.createContainerElement("div","hotspotDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),Ra.appendChild(ja),qa=ja,Qa=qa.style,Z.Utils.addEventListener(ja,"mousedown",Z.Utils.preventDefault))),Z.useCanvas||(Na.innerHTML="",Fa.innerHTML=""),Ya&&(Ya.innerHTML=""),qa&&(qa.innerHTML="")}function g(){xa&&(Oa=xa.getContext("2d")),ka=Na.getContext("2d"),Ha=Fa.getContext("2d"),Ga=za.getContext("2d"),tn&&(nn=tn.getContext("2d")),on&&(sn=on.getContext("2d"))}function m(e,t,i,a){("undefined"==typeof i||null===i)&&(i=0),("undefined"==typeof a||null===a)&&(a=0),Z.viewerW=Kn=e,Z.viewerH=jn=t,Jn=Kn*oo,$n=jn*oo;var n=Z.imageSet?po:"unconverted"==Z.tileSource&&Z.browser==Z.browsers.FIREFOX?uo:so,l=Z.constrainPanStrict?Z.imageW:2*Z.imageW,o=Z.constrainPanStrict?Z.imageH:2*Z.imageH;Jn>n&&(Jn=n),$n>n&&($n=n),Jn>l&&(Jn=l),$n>o&&($n=o),Kn>Jn&&(Jn=Kn),jn>$n&&($n=jn);var r=4;if(el=Z.Utils.roundToFixed(Jn/2,r),tl=Z.Utils.roundToFixed($n/2,r),il=Z.Utils.roundToFixed(-((Jn-Kn)/2)+i,r),al=Z.Utils.roundToFixed((Jn-Kn)/2+i,r),nl=Z.Utils.roundToFixed(-(($n-jn)/2)+a,r),ll=Z.Utils.roundToFixed(($n-jn)/2+a,r),xa&&(xa.width=Kn,xa.height=jn,wa.width=Kn+"px",wa.height=jn+"px",wa.left="0px",wa.top="0px"),Pa.width=Jn,Pa.height=$n,Da.width=Jn+"px",Da.height=$n+"px",Da.left=il+"px",Da.top=nl+"px",Fa.width=Jn,Fa.height=$n,_a.width=Jn+"px",_a.height=$n+"px",Ya&&(Ya.width=Jn,Ya.height=$n,Ka.width=Jn+"px",Ka.height=$n+"px"),dn&&(dn.width=Jn,dn.height=$n,pn.width=Jn+"px",pn.height=$n+"px"),qa&&(qa.width=Jn,qa.height=$n,Qa.width=Jn+"px",Qa.height=$n+"px",Ja)){var s=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTLISTWIDTH"),10),u=ui(Zs,s,Kn,jn);$a.left=u.x+"px",$a.top=u.y+"px"}if(tn&&(tn.width=Jn,tn.height=$n,an.width=Jn+"px",an.height=$n+"px"),on&&(on.width=Jn,on.height=$n,rn.width=Jn+"px",rn.height=$n+"px"),Z.imageSet&&Z.Viewer.sizeAndPositionImageSetList(),Z.useCanvas){xa&&(Oa.translate(Kn/2,jn/2),Oa.save());try{Ha.translate(el,tl)}catch(d){Z.Utils.showMessage(Z.Utils.getResource("ERROR_TRANSLATINGCANVASFORUNCONVERTEDIMAGE")),console.log("In function setSizeAndPosition translating canvas:  "+d)}Ha.save(),dn&&(cn.translate(el,tl),cn.save()),tn&&(nn.translate(el,tl),nn.save()),on&&(sn.translate(el,tl),sn.save())}}function h(e,t,i){if("ZoomifyImageFile"==Z.tileSource)f(e,t,i);else if("ZoomifyImageFolder"==Z.tileSource){var a=Z.Utils.cacheProofPath(e+"/ImageProperties.xml");t.loadXML(a,i)}}function f(e,t){var i=parseFloat(Z.Utils.getResource("DEFAULT_HEADERSTARTBYTE")),a=parseFloat(Z.Utils.getResource("DEFAULT_HEADERENDBYTEZIF"));t.loadByteRange(e,i,a,"header")}function T(e,t){if(u(),"undefined"==typeof Zn.getStatus){window.setTimeout(function(){T(e,t)},100)}else{var i=null,a=null,n=null,r=null,s=null,d=null,p=null,c=null,g=null,m=null,h=null,f=null;"ZoomifyImageFolder"==Z.tileSource&&(i=parseInt(e.documentElement.getAttribute("WIDTH"),10),a=parseInt(e.documentElement.getAttribute("HEIGHT"),10),s=parseInt(e.documentElement.getAttribute("NUMTILES"),10),d=parseInt(e.documentElement.getAttribute("NUMIMAGES"),10),p=parseInt(e.documentElement.getAttribute("VERSION"),10),n=r=parseInt(e.documentElement.getAttribute("TILESIZE"),10)),null!==Z.tileW&&(n=Z.tileW),null!==Z.tileH&&(r=Z.tileH),("ZoomifyImageFolder"==Z.tileSource||"ImageServer"==Z.tileSource)&&((null===n||isNaN(n))&&(n=yn),(null===r||isNaN(r))&&(r=Un),(null===s||isNaN(s))&&(s=1)),!isNaN(i)&&i>0&&!isNaN(a)&&a>0&&!isNaN(n)&&n>0&&!isNaN(r)&&r>0&&s>0?Zn.getStatus("initialized")?o(i,a,n,r,s,p,c,g,m,h,f,t):l(i,a,n,r,s,p,c,g,m,h,f,t):Z.Utils.showMessage("ZoomifyImageFolder"==Z.tileSource?Z.Utils.getResource("ERROR_IMAGEPROPERTIESXMLINVALID"):Z.Utils.getResource("ERROR_IMAGEPROPERTIESINVALID"))
}}function b(){if("unconverted"==Z.tileSource)E();else if("ZoomifyImageFile"==Z.tileSource)v();else{var e=I();e==vn||"ZoomifyImageFolder"!=Z.tileSource&&"ZoomifyImageFile"!=Z.tileSource&&"ZoomifyPFFFile"!=Z.tileSource||(e=y(),e!=vn&&Z.Utils.showMessage(Z.Utils.getResource("ERROR_IMAGETILECOUNTINVALID")))}}function E(){_n[0]=Z.imageW,Hn[0]=Z.imageH,Bn[0]=1,zn[0]=1,Xn[0]=1,Cn=1}function v(){for(var e=Cn-1;e>=0;e--)Bn[e]=Math.ceil(_n[e]/yn),zn[e]=Math.ceil(Hn[e]/Un),Xn[e]=Bn[e]*zn[e]}function I(){for(var e=Z.imageW,t=Z.imageH;e>yn||t>Un;)e/=2,t/=2,Cn++;e=Z.imageW,t=Z.imageH;for(var i=0,a=Cn-1;a>=0;a--)_n[a]=e,Hn[a]=t,Bn[a]=Math.ceil(_n[a]/yn),zn[a]=Math.ceil(Hn[a]/Un),Xn[a]=Bn[a]*zn[a],e/=2,t/=2,i+=Xn[a];return i}function y(){_n=[],Hn=[],Bn=[],zn=[],Cn=1;for(var e="DIV2",t=Z.imageW,i=Z.imageH,a=2;t>yn||i>Un;)"Div2"==e?(t=Math.floor(t/2),i=Math.floor(i/2)):"Plus1Div2"==e?(t=Math.floor((t+1)/2),i=Math.floor((i+1)/2)):(t=Math.floor(Z.imageW/a),i=Math.floor(Z.imageH/a),a*=2,t%2&&t++,i%2&&i++),Cn++;t=Z.imageW,i=Z.imageH,a=2,tileCounter=0;for(var n=Cn-1;n>=0;n--)Bn[n]=Math.floor(t/yn),t%yn&&Bn[n]++,zn[n]=Math.floor(i/Un),i%Un&&zn[n]++,Xn[n]=Bn[n]*zn[n],tileCounter+=Xn[n],_n[n]=t,Hn[n]=i,"Div2"==e?(t=Math.floor(t/2),i=Math.floor(i/2)):"Plus1Div2"==e?(t=Math.floor((t+1)/2),i=Math.floor((i+1)/2)):(t=Math.floor(Z.imageW/a),i=Math.floor(Z.imageH/a),a*=2,t%2&&t++,i%2&&i++);return tileCounter}function U(e){var t=e?"inline-block":"none";La&&!wa&&(wa=La.style),wa&&(wa.display=t),Ra&&!Da&&(Da=Ra.style),Da&&(Da.display=t)}function S(e,t){for(var i=Bn[e]-1,a=zn[e]-1,n=0;i>=n;n++)for(var l=0;a>=l;l++)t[t.length]=e+"-"+n+"-"+l}function A(e){var t=!1;if(e||parseFloat(_a.width)!=Fa.width){if(Z.useCanvas){_a.width=Fa.width+"px",_a.height=Fa.height+"px",_a.left="0px",_a.top="0px",Ha.restore(),Ha.save();try{Ha.scale(On,On)}catch(i){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE")),console.log("In function resetDisplays scaling canvas:  "+i)}dn&&(pn.width=Fa.width+"px",pn.height=Fa.height+"px",pn.left="0px",pn.top="0px"),tn&&(an.width=tn.width+"px",an.height=tn.height+"px",an.left="0px",an.top="0px"),on&&(rn.width=on.width+"px",rn.height=on.height+"px",rn.left="0px",rn.top="0px"),Na&&(kn?(Va.width=Na.width+"px",Va.height=Na.height+"px",Va.left=dl+"px",Va.top=pl+"px",ka.restore(),ka.save(),ka.scale(Pn,Pn)):(Va.width=ol+"px",Va.height=rl+"px",Va.left=dl+"px",Va.top=pl+"px"))}t=!0}if(e||parseFloat(Da.left)!=il||parseFloat(Da.top)!=nl){var a=parseFloat(Da.left)-il,n=parseFloat(Da.top)-nl;if(0!=Z.imageR){var l=Z.Utils.rotatePoint(a,n,Z.imageR);a=l.x,n=l.y}Da.left=il+"px",Da.top=nl+"px",kn||(dl=parseFloat(Va.left)+a,pl=parseFloat(Va.top)+n,Va.left=dl+"px",Va.top=pl+"px");var o=Zn.getZoom();Z.imageX=ya=Z.imageX-a/o,Z.imageY=Ua=Z.imageY-n/o,t=!0}t&&(O(Fa,Nn,Nl,"centerOut",!1,"1a. Updating view: resetting display positions"),Z.maskingSelection&&dn&&displayMask(),kn&&O(Na,Vn,Zl,"simple",!1,"1b. Updating view: resetting backfill positions"))}function L(){On!=Rn&&(Z.imageZ=Zn.getZoom()),Z.imageZ<Z.minZ&&(Z.imageZ=Z.minZ),Z.imageZ>Z.maxZ&&(Z.imageZ=Z.maxZ);for(var e=Sn,t=Cn;e/2>=Z.imageZ;)t--,e/=2;t=0>t-1?0:t-1;var i=pt(t,Z.imageZ);(t!=Nn||i!=On)&&(Z.useCanvas&&(Ha.restore(),Ha.save(),Ha.scale(i,i)),Nn!=t&&(Fn=!0),Nn=t,On=i),Rn=On}function x(){kn=!1,Nn>Kl?(Vn=Nn-jl,kn=!0):Vn=Nn>ql?Ql:Nn>Jl?$l:eo,Pn=pt(Vn,Z.imageZ),tierBackfillScalePrior=Pn;var e=_n[Vn],t=Hn[Vn],i=Z.imageX*Z.imageZ,a=Z.imageY*Z.imageZ;if(kn){var n=ro;ol=Jn*n,rl=$n*n,dl=-(Jn/n),pl=-($n/n),sl=el*n,ul=tl*n,Na.width=ol,Na.height=rl,Va.width=Na.width+"px",Va.height=Na.height+"px",Va.left=dl+"px",Va.top=pl+"px",Z.useCanvas&&(xa&&(Dn=pt(Mn,Z.imageZ),Oa.restore(),Oa.save(),Oa.scale(Dn,Dn),0!=Z.imageR&&Oa.rotate(Z.imageR*Math.PI/180)),ka.restore(),ka.translate(sl,ul),ka.save(),ka.scale(Pn,Pn))}else ol=e*Pn,rl=t*Pn,dl=el-i,pl=tl-a,Na.width=e,Na.height=t,Z.useCanvas&&(Va.width=ol+"px",Va.height=rl+"px"),Va.left=dl+"px",Va.top=pl+"px"}function w(e){if(e){var t=Zn.getViewportDisplayBoundingBoxInTiles(Vn);Z.Utils.arrayClear(gl),Z.Utils.arrayClear(cl);for(var i=t.l,a=t.r;a>=i;i++)for(var n=t.t,l=t.b;l>=n;n++){var o=Vn+"-"+i+"-"+n;cl[cl.length]=o,gl[gl.length]=o}N(gl,Y,"simple","image-backfill")}else{Z.Utils.arrayClear(Dl),Z.Utils.arrayClear(kl),Z.Utils.arrayClear(Ml),Z.Utils.arrayClear(Cl);for(var t=Zn.getViewportDisplayBoundingBoxInTiles(),i=t.l,a=t.r;a>=i;i++)for(var n=t.t,l=t.b;l>=n;n++){var o=Nn+"-"+i+"-"+n;Dl[Dl.length]=o,Cl[Cl.length]=o}if(Zn.getStatus("initialized")&&Zl.length>0&&(Nn==eo||Nn==$l||Nn==Ql))for(var r=0,s=Zl.length;s>r;r++){var u=Zl[r];if(u&&u.t==Nn&&u.c>=t.l&&u.c<=t.r&&u.r>=t.t&&u.r<=t.b){Ml[Ml.length]=u.name,kl[kl.length]=u;var d=Z.Utils.arrayIndexOf(Cl,u.name);-1!=d&&(Cl=Z.Utils.arraySplice(Cl,d,1))}}for(var r=0,s=Nl.length;s>r;r++){var u=Nl[r];if(u&&u.t==Nn&&u.c>=t.l&&u.c<=t.r&&u.r>=t.t&&u.r<=t.b){var d=Z.Utils.arrayIndexOf(Ml,u.name);-1==d&&(Ml[Ml.length]=u.name,kl[kl.length]=u);var p=Z.Utils.arrayIndexOf(Cl,u.name);-1!=p&&(Cl=Z.Utils.arraySplice(Cl,p,1))}}if(0!=Tl){for(var r=0,s=ml.length;s>r;r++){var u=ml[r];u.alpha=1}Z.Utils.arrayClear(ml),Z.Utils.arrayClear(hl)}fl=Cl.length,Zn.traceDebugValues("tilesToDisplay",null,Dl.length,Dl),Zn.traceDebugValues("tilesInCache",null,Ml.length,Ml),Zn.traceDebugValues("tilesToLoad",null,Cl.length,Cl)}}function O(e,t,i,a,n){if(n||Z.Utils.clearDisplay(e),"canvasCopy"==a)Z.Utils.clearDisplay(Fa),Ha.restore(),Ha.save(),Ha.scale(1,1),Ha.drawImage(za,-el,-tl),Ha.restore(),Ha.save(),Ha.scale(On,On);else{var l=Zn.getViewportDisplayBoundingBoxInTiles(t),o=[];if(null===i)for(var r=0,s=kl.length;s>r;r++)o[r]=kl[r];else if(i.length>0)for(var r=0,s=i.length;s>r;r++){var u=i[r];u&&u.t==t&&(t==Vn&&!kn||u.c>=l.l&&u.c<=l.r&&u.r>=l.t&&u.r<=l.b)&&(o[o.length]=i[r])}if(o.length>0)if(Zn.traceDebugValues("redisplayCachedTiles-"+e.id,null,null,o),"centerOut"==a)for(var d=Math.floor(o.length/2),r=d,s=o.length;s>r;r++)j(e,t,o[r]),o.length-r-1!=r&&j(e,t,o[o.length-r-1]);else for(var r=0,s=o.length;s>r;r++)j(e,t,o[r]);else Zn.traceDebugValues("No cached tiles in view");Zn.traceDebugValues("blankLine")}}function R(e,t){var i=Zn.getViewportDisplayBoundingBoxInTiles();syncTransitionCanvas();for(var a=0,n=t.length;n>a;a++){var l=t[a];l&&l.t==e&&(e==Vn||l.c>=i.l&&l.c<=i.r&&l.r>=i.t&&l.r<=i.b)&&j(za,e,l)}}function P(e){wn=null,wn=new Image,wn.onload=D,wn.onerror=C,wn.src=e}function D(){if("undefined"!=typeof wn){var e=Z.Utils.createContainerElement("div","testImageContainer","inline-block","absolute","hidden",Kn+"px",jn+"px","0px","0px","none","0px","transparent none","0px","0px","normal",null,!0);e.appendChild(wn),e.removeChild(wn),e=null;var t=wn.width,i=wn.height;if(Zn.setStatus("displayLoaded",!0),Zn.setStatus("displayDrawn",!0),0!=t&&0!=i)l(t,i,t,i,null,null,null,null,null,null,null);else{window.setTimeout(function(){D()},100)}}else{window.setTimeout(function(){D()},100)}}function C(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNCONVERTEDIMAGEPATHINVALID"))}function N(e,t,i,a){var n="undefined"!=typeof a&&null!==a?"-"+a:"";if(e.length>0){Zn.traceDebugValues("loadNewTiles"+n,null,null,e);var l=(new Date).getTime();if("centerOut"==i&&e.length>4){for(var o=[],r=0,s=0,u=0,d=0,p=0;p<e.length;p++){var c=e[p];if(c){var Z=new V(c,a);o[o.length]=Z,0==p?(r=s=Z.c,u=d=Z.r):(Z.c<r?r=Z.c:Z.c>s&&(s=Z.c),Z.r<u?u=Z.r:Z.r>d&&(d=Z.r))}}for(var g=s-r,m=d-u,h=r+g/2,f=u+m/2,p=0;p<o.length;p++)o[p].r-=f,o[p].c-=h;o.sort(function(e,t){var i=e.r*e.r+e.c*e.c,a=t.r*t.r+t.c*t.c,n=i-a;return n});for(var p=0;p<o.length;p++)o[p].r+=f,o[p].c+=h,G(o[p],l,t)}else for(var p=0,T=e.length;T>p;p++){var c=e[p];if(c){var Z=new V(c,a);G(Z,l,t)}}Zn.traceDebugValues("blankLine")}else Zn.traceDebugValues("loadNewTiles"+n,"No new tiles requested")}function V(e,t){this.name=e;var i=new k(e);this.t=i.t,this.c=i.c,this.r=i.r,this.x=Math.floor(this.c*yn),this.y=Math.floor(this.r*Un),this.image=null,this.alpha=0,this.url=Zn.formatTilePath(this.t,this.c,this.r,t),this.loadTime=null,this.elmt=null,this.style=null}function k(e){this.t=parseInt(e.substring(0,e.indexOf("-")),10),this.c=parseInt(e.substring(e.indexOf("-")+1,e.lastIndexOf("-")),10),this.r=parseInt(e.substring(e.lastIndexOf("-")+1),10)}function M(e,t,i,a){var n,l,o="offsetLoading",r="loading",s="loading";if(1==tierTileOffsetsCount[e])r=Gn[e];else{var u=new F(e,t,i),d=u.chunkID+","+e+","+t+","+i+","+a+",offset";if(n=Z.Utils.arrayIndexOfObjectValue(tierTileOffsetChunks,"chunkID",u.chunkID),-1==n){Zn.traceDebugValues("formatTilePathZIF",u.chunkID+","+e+","+t+","+i+","+a),-1==Z.Utils.arrayIndexOf(Xl,d)&&(Xl[Xl.length]=d),tierTileOffsetChunks[tierTileOffsetChunks.length]={chunkID:u.chunkID,chunk:"loading"};var p=new Z.NetConnector;p.loadByteRange(Aa,u.chunkStart,u.chunkEnd,"offset",null,u.chunkID)}else"loading"==tierTileOffsetChunks[n].chunk?-1==Z.Utils.arrayIndexOf(Xl,d)&&(Xl[Xl.length]=d):"loading"!=tierTileOffsetChunks[n].chunk&&(l=tierTileOffsetChunks[n].chunk,r=Z.Utils.longValue(l,u.offsetStartInChunk))}var c;if(1==tierTileByteCountsCount[e])s=Wn[e];else{var g=t+i*Bn[e];if(2==tierTileByteCountsCount[e]){var m=Wn[e];s=0==g?m.substring(0,m.indexOf(",")):m.substring(m.indexOf(",")+1,m.length)}else{var h=new _(e,t,i),c=h.chunkID+","+e+","+t+","+i+","+a+",byteCount";if(n=Z.Utils.arrayIndexOfObjectValue(tierTileByteCountChunks,"chunkID",h.chunkID),-1==n){-1==Z.Utils.arrayIndexOf(Xl,c)&&(Xl[Xl.length]=c),tierTileByteCountChunks[tierTileByteCountChunks.length]={chunkID:h.chunkID,chunk:"loading"};var p=new Z.NetConnector;p.loadByteRange(Aa,h.chunkStart,h.chunkEnd,"byteCount",null,h.chunkID)}else"loading"==tierTileByteCountChunks[n].chunk?-1==Z.Utils.arrayIndexOf(Xl,c)&&(Xl[Xl.length]=c):"loading"!=tierTileByteCountChunks[n].chunk&&(l=tierTileByteCountChunks[n].chunk,s=Z.Utils.intValue(l,h.bcStartInChunk))}}return"loading"==r||isNaN(r)||"loading"==s||isNaN(s)||(o=Aa+"?"+r.toString()+","+s.toString()),o}function F(e,t,i){var a=t+i*Bn[e],n=8*a+Gn[e],l=Math.floor(a/Tn),o=l*Tn,r=o+Tn,s=r>Xn[e]?8*(Xn[e]-o):bn;this.chunkStart=Gn[e]+l*bn,this.chunkEnd=this.chunkStart+s,this.offsetStartInChunk=n-this.chunkStart,this.chunkID=e.toString()+"-"+l.toString()}function _(e,t,i){var a=t+i*Bn[e],n=4*a+Wn[e],l=Math.floor(a/Tn),o=l*Tn,r=o+Tn,s=r>Xn[e]?4*(Xn[e]-o):En;this.chunkStart=Wn[e]+l*En,this.chunkEnd=this.chunkStart+s,this.bcStartInChunk=n-this.chunkStart,this.chunkID=e.toString()+"-"+l.toString()}function H(e,t,i){for(var a=i*Bn[e]+t,n=0;e>n;n++)a+=Xn[n];var l=Math.floor(a/In),o=Aa+"/TileGroup"+l+"/"+e+"-"+t+"-"+i+"."+Z.tileType;return(Z.browser==Z.browsers.IE&&Z.browserVersion<9||0==Ln)&&(o=Z.Utils.cacheProofPath(o)),o}function B(e,t){for(var i=0,a=Xl.length;a>i;i++){var n=Xl[i].split(",");n[0]==e&&n[5]==t&&(void 0!==n[4]&&"image-display"==n[4]?zl[zl.length]=n[1]+"-"+n[2]+"-"+n[3]:"image-backfill"==n[4]&&(Wl[Wl.length]=n[1]+"-"+n[2]+"-"+n[3]),Xl=Z.Utils.arraySplice(Xl,i,1),i--,a--)}if(zl.length>0){zl.sort(),zl=Z.Utils.arrayUnique(zl),Zn.traceDebugValues("selectTilesRetryZIF",zl);var l=W;z(zl,l,"simple","image-display")}if(Wl.length>0){Wl.sort(),Wl=Z.Utils.arrayUnique(Wl);var l=Y;z(Wl,l,"simple","image-backfill")}}function z(e,t,i,a){for(var n=(new Date).getTime(),l=0,o=e.length;o>l;l++){var r=null,s=e[l];if(s)if(e=Z.Utils.arraySplice(e,l,1),l--,o--,index=Z.Utils.arrayIndexOfObjectValue(Gl,"name",s),-1!=index?(r=Gl[index],Gl=Z.Utils.arraySplice(Gl,index,1),r.url=Zn.formatTilePath(r.t,r.c,r.r,a)):r=new V(s,a),null!=r&&-1==r.url.indexOf("NaN"))Zn.traceDebugValues("loadNewTilesRetry",r.name+"  "+r.url),G(r,n,t);else if(-1==r.url.indexOf("NaN")){var u=parseInt(Z.Utils.getResource("ERROR_MESSAGEDURATIONMEDIUM"),10);Z.Utils.showMessage(Z.Utils.getResource("ERROR_TILEPATHINVALID-ZIF")+r.name+".jpg",!1,u,"center",!1)}}}function X(e){bt(e);var t=e.name,i=Z.Utils.arrayIndexOf(Cl,t);if(-1!=i&&(Cl=Z.Utils.arraySplice(Cl,i,1)),"ZoomifyImageFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource){var a=Z.Utils.arrayIndexOf(zl,t);-1!=a&&(zl=Z.Utils.arraySplice(zl,a,1))}ml[ml.length]=e,hl[hl.length]=t}function G(e,t,i){var a=e.name;if("skipTile"==e.url.substr(0,8))X(e);else if("offsetLoading"==e.url){var n=Z.Utils.arrayIndexOfObjectValue(Gl,"name",a);-1==n&&(Gl[Gl.length]=e),Zn.traceDebugValues("loadTileDelayForOffset",a)}else if("offsetLoading"!=e.url){var l;i==W?l="image-display":i==Y&&(l="image-backfill");var o=e.t==eo&&to||e.t==$l&&io||e.t==Ql&&ao;"image-display"==l&&o||(e.loadTime=t,Zn.traceDebugValues("loadTile-"+l,a),Yl.loadImage(e.url,Z.Utils.createCallback(null,i,e),l,e))}}function W(e,t){if(e&&t){e.image=t;var i=e.name,a=Z.Utils.arrayIndexOf(Cl,i);if(-1!=a){if(Cl=Z.Utils.arraySplice(Cl,a,1),bt(e),-1==Z.Utils.arrayIndexOf(hl,i)&&(hl[hl.length]=i,ml[ml.length]=e),Go||(Go=window.setInterval(K,50)),Tl=Cl.length,0==Tl){if(Z.useCanvas&&Ln>0)if(Fn){R(Nn,Nl),O(Fa,Nn,Nl,"canvasCopy",!1,"4. Updating view: all new tiles loaded");{window.setTimeout(function(){Z.Utils.clearDisplay(za)},200)}Fn=!1}else O(Fa,Nn,Nl,"centerOut",!1,"4. Updating view: all new tiles loaded");Tt(),fl=0}Zn.traceDebugValues("onTileLoad",e.name,e.loadTime),Zn.updateProgress(fl,Tl)}Sl==Al+xl&&Zn.setStatus("displayLoaded",!0)}else("undefined"==typeof t||null===t)&&console.log(Z.mobileDevice?Z.Utils.getResource("ERROR_TILEPATHINVALID")+e.name+".jpg":Z.Utils.getResource("ERROR_TILEPATHINVALID")+e.name+".jpg")}function Y(e,t){if(e&&t){e.image=t;var i=e.name;Zl[Zl.length]=e;var a=Z.Utils.arrayIndexOf(gl,i);if(-1!=a&&(gl=Z.Utils.arraySplice(gl,a,1)),"ZoomifyImageFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource){var n=Z.Utils.arrayIndexOf(Wl,i);-1!=n&&(Wl=Z.Utils.arraySplice(Wl,n,1))}e.alpha=1,e.t==Vn&&j(Na,Vn,e),Zn.traceDebugValues("onTileBackfillPrecache",e.name),bl==El&&Zn.setStatus("precacheLoaded",!0),Zn.traceDebugValues("onTileBackfillLoad",e.name),Il+yl>=vl&&Zn.setStatus("backfillLoaded",!0),e.t==Nn&&W(e,t)}else("undefined"==typeof t||null===t)&&(Z.mobileDevice?console.log(Z.Utils.getResource("ERROR_TILEPATHINVALID")+e.name+".jpg"):Z.Utils.showMessage(Z.Utils.getResource("ERROR_TILEPATHINVALID")+e.name+".jpg"))}function K(){for(var e=0,t=0,i=ml.length;i>t;t++){var a=ml[t];if(a.t==Nn)0!=Xo&&a.alpha+Xo<1?a.alpha+=Xo:(a.alpha=1,e++),j(Fa,Nn,a),e>=i&&(window.clearInterval(Go),Go=null,t=i);else{ml=Z.Utils.arraySplice(ml,t,1),hl=Z.Utils.arraySplice(hl,t,1);var n=Z.Utils.arrayIndexOf(Cl,a.name);-1!=n&&(Cl=Z.Utils.arraySplice(Cl,n,1)),i--}}}function j(e,t,i){if("skipTile"!=i.url.substr(0,8)&&0!=i.image.width&&0!=i.image.height){var a=i.x,n=i.y,l=dt(t,1);Dn=pt(Mn,Zn.getZoom());var o=Dn>8;if(Z.useCanvas){if(e==Fa||e==za||e==Na&&kn)a-=Z.imageX*l,n-=Z.imageY*l;else if(e==xa&&(kn||o)){var r=Zn.calculateCurrentCenterCoordinates();a-=r.x*l,n-=r.y*l}q(e,i,a,n)}else{var s;e==Fa?(a-=Z.imageX*l-el/On,n-=Z.imageY*l-tl/On,s=On):s=Pn,Q(e,i,a,n,s)}e==Fa?(Zn.traceDebugValues("displayTile",i.name),Sl==wl&&Zn.setStatus("displayDrawn",!0)):(Zn.traceDebugValues("displayBackfillTile",i.name),Ul>=vl&&Zn.setStatus("backfillDrawn",!0))}}function q(e,t,i,a){var n=e.getContext("2d");Z.alphaSupported&&t.alpha<1&&"transitionCanvas"!=e.id&&-1==e.id.indexOf("oversizeDisplay")&&(n.globalAlpha=t.alpha),n.drawImage(t.image,i,a),Z.alphaSupported&&t.alpha<1&&"transitionCanvas"!=e.id&&"oversizeDisplay"!=e.id&&(n.globalAlpha=1),2==Z.debug&&J(e,t.name,i,a,On)}function Q(e,t,i,a,n){t.elmt||(t.elmt=Z.Utils.createContainerElement("img"),t.elmt.onmousedown=Z.Utils.preventDefault,Z.Utils.addEventListener(t.elmt,"contextmenu",Z.Utils.preventDefault),t.elmt.src=t.url,t.style=t.elmt.style,t.style.position="absolute",Z.Utils.renderQuality(t,Z.renderQuality),Z.cssTransformsSupported&&(t.style[Z.cssTransformProperty+"Origin"]="0px 0px")),t.elmt.parentNode!=e&&e.appendChild(t.elmt);var l=t.style;l.display="none",Z.cssTransformsSupported?l[Z.cssTransformProperty]=["matrix(",(t.image.width/t.elmt.width*n).toFixed(8),",0,0,",(t.image.height/t.elmt.height*n).toFixed(8),",",(i*n).toFixed(8),Z.cssTransformNoUnits?",":"px,",(a*n).toFixed(8),Z.cssTransformNoUnits?")":"px)"].join(""):(l.width=t.image.width*n+"px",l.height=t.image.height*n+"px",l.left=i*n+"px",l.top=a*n+"px"),l.display="inline-block",Z.Utils.setOpacity(t,t.alpha),2==Z.debug&&J(e,t.name,i,a,n)}function J(e,t,i,a,n){Z.useCanvas?$(e,t,i,a,n):et(e,t,i,a,n)}function $(e,t,i,a,n){var l=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONFONTSIZE"),10),o=parseInt(Z.Utils.getResource("DEFAULT_MINHOTSPOTCAPTIONFONTSIZE"),10),r=parseInt(Z.Utils.getResource("DEFAULT_MAXHOTSPOTCAPTIONFONTSIZE"),10),s=Math.round(l*n),u=2*(o>s?o:s>r?r:s),d=e.getContext("2d");d.font=u+"px verdana",d.textAlign="left",d.textBaseline="top";var p=yn*n/2,c=Un*n/2;d.fillStyle="#FFFFFF",d.fillText(t,i+p,a+c),d.fillStyle="#000000",d.fillText(t,i+p+1,a+c+1)}function et(e,t,i,a,n){var l=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONFONTSIZE"),10),o=parseInt(Z.Utils.getResource("DEFAULT_MINHOTSPOTCAPTIONFONTSIZE"),10),r=parseInt(Z.Utils.getResource("DEFAULT_MAXHOTSPOTCAPTIONFONTSIZE"),10),s=Math.round(l*n),u=2*(o>s?o:s>r?r:s),d=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONPADDING"),10)*n,p=Z.Utils.createContainerElement("div","tileNameTextBox","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px","transparent none","0px",d+"px","nowrap"),c=document.createTextNode(t);p.appendChild(c),e.appendChild(p),Z.Utils.setTextNodeStyle(c,"white","verdana",u+"px","none","normal","normal","normal","normal","1em","center","none");var g=Z.Utils.createContainerElement("div","tileNameTextBox2","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px","transparent none","0px",d+"px","nowrap"),m=document.createTextNode(t);g.appendChild(m),e.appendChild(g),Z.Utils.setTextNodeStyle(m,"black","verdana",u+"px","none","normal","normal","normal","normal","1em","center","none");var d=parseFloat(p.style.padding),h=parseFloat(Z.Utils.getElementStyleProperty(p,"width"));if(isNaN(h)){var f=parseFloat(Z.Utils.getResource("DEFAULT_FONTTOPIXELSCONVERSIONFACTOR")),T=parseFloat(p.style.fontSize)/f;h=Math.round(parseFloat(t.length*T))}var b=yn*n/2,E=Un*n/2;p.style.left=i*n+(b-h/2-d)+"px",p.style.top=a*n+E+"px",g.style.left=1+i*n+(b-h/2-d)+"px",g.style.top=1+a*n+E+"px",Z.Utils.addEventListener(p,"contextmenu",Z.Utils.preventDefault),Z.Utils.disableTextInteraction(c),Z.Utils.addEventListener(g,"contextmenu",Z.Utils.preventDefault),Z.Utils.disableTextInteraction(m)}function tt(e){var e=Z.Utils.event(e),t=Zn.getZoom(),i=Zn.getClickCoordsInImage(e,t),a=Math.round(i.x).toString(),n=Math.round(i.y).toString(),l=(Math.round(1e3*t)/10).toString(),o='X="'+a+'"   Y="'+n+'"   ZOOM="'+l+'"';return o}function it(e,t){var i=dt(t,1),a=Math.floor(e.l*i/yn),n=Math.floor(e.r*i/yn),l=Math.floor(e.t*i/Un),o=Math.floor(e.b*i/Un);0>a&&(a=0),n>Bn[t]-1&&(n=Bn[t]-1),0>l&&(l=0),o>zn[t]-1&&(o=zn[t]-1),this.l=a,this.r=n,this.t=l,this.b=o}function at(e,t,i,a,n,l,o){this.l=e+i/o,this.r=e+a/o,this.t=t+n/o,this.b=t+l/o}function nt(e,t){var i=e-Z.Utils.getElementPosition(Z.ViewerDisplay).x,a=t-Z.Utils.getElementPosition(Z.ViewerDisplay).y;return new Z.Utils.Point(i,a)}function lt(e,t){var i=nt(e,t),a=Z.Utils.getPageScroll(),n=i.x-il+a.x,l=i.y-nl+a.y;return new Z.Utils.Point(n,l)}function ot(e,t,i,a){("undefined"==typeof i||null===i)&&(i=Z.imageZ),("undefined"==typeof a||null===a)&&(a=Z.imageR),0>a&&(a+=360);var n,l,o=il-e,r=nl-t,s=o/i,u=r/i;switch(a){case 0:n=Z.imageX+s,l=Z.imageY+u;break;case 90:n=Z.imageX+u,l=Z.imageY-s;break;case 180:n=Z.imageX-s,l=Z.imageY-u;break;case 270:n=Z.imageX-u,l=Z.imageY+s}return new Z.Utils.Point(n,l)}function rt(e,t,i,a){("undefined"==typeof i||null===i)&&(i=Z.imageZ),("undefined"==typeof a||null===a)&&(a=Z.imageR),0>a&&(a+=360);var n,l;switch(a){case 0:n=e-Z.imageX,l=t-Z.imageY;break;case 90:n=Z.imageY-t,l=e-Z.imageX;break;case 180:n=Z.imageX-e,l=Z.imageY-t;break;case 270:n=t-Z.imageY,l=Z.imageX-e}var o=n*i,r=l*i,s=il-o,u=nl-r;return new Z.Utils.Point(s,u)}function st(e,t,i,a){("undefined"==typeof i||null===i)&&(i=Z.imageZ),("undefined"==typeof a||null===a)&&(a=Z.imageR),0>a&&(a+=360);var n=parseFloat(Da.left)+el,l=parseFloat(Da.top)+tl,o=e-n,r=t-l;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(o,r,a),o=viewportClickPt.x,r=viewportClickPt.y);var s=o/i,u=r/i,d=Z.imageX+s,p=Z.imageY+u;return new Z.Utils.Point(d,p)}function ut(e,t,i,a){("undefined"==typeof i||null===i)&&(i=Z.imageZ),("undefined"==typeof a||null===a)&&(a=Z.imageR),0>a&&(a+=360);var n=Z.imageX-e,l=Z.imageY-t,o=n*i,r=l*i;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(o,r,-a),o=viewportClickPt.x,r=viewportClickPt.y);var s=il+o,u=nl+r;return new Z.Utils.Point(s,u)}function dt(e,t){var i=t*(_n[e]/Z.imageW);return i}function pt(e,t){var i=t/(_n[e]/Z.imageW);return i}function ct(e,t,i,a,n){if(Z.constrainPan){a=Math.round(a);var l=e,o=t,r="undefined"!=typeof i&&null!==i?i:Z.imageZ,s="undefined"!=typeof a&&null!==a?a:Z.imageR;0>s&&(s+=360);var u=Z.Utils.getDisplayPositionRotated(Da,s),d=Z.imageW,p=Z.imageH,c=Kn,g=jn,m=Math.round(d*r),h=Math.round(p*r);if("container"==n){var f=ot(e,t,r,s);e=f.x,t=f.y}var T=Z.constrainPanStrict?0:c/2/r,b=Z.constrainPanStrict?0:g/2/r,E=(c+u.y)/2/r-T,v=d-(c+u.y)/2/r+T,I=(g+u.x)/2/r-b,y=p-(g+u.x)/2/r+b,U=(0==s||180==s)&&m>c||(90==s||270==s)&&m>g,S=(0==s||180==s)&&h>g||(90==s||270==s)&&h>c;if(e=U||!Z.constrainPanStrict?E>=e?E:e>=v?v:e:d/2,t=S||!Z.constrainPanStrict?I>=t?I:t>=y?y:t:p/2,"container"==n){var A=rt(e,t,r,s);e=A.x,t=A.y}(e!=l||t!=o)&&Z.Utils.validateCallback("panConstrained")}return new Z.Utils.Point(e,t)}function Zt(e){return e>Z.maxZ?(e=Z.maxZ,Z.Utils.validateCallback("zoomConstrainedMax")):e<Z.minZ&&(e=Z.minZ,Z.Utils.validateCallback("zoomConstrainedMin")),e}function gt(e){var t=90*Math.round(Math.abs(e)/90)*Z.Utils.getSign(e);return-360>=t?t+=360:t>=360&&(t-=360),t}function mt(){if(Z.ToolbarDisplay&&Z.Toolbar.getInitialized()){var e=Zn.getZoom();Z.Toolbar.syncSliderToViewportZoom(e)}Z.Utils.validateCallback("viewZoomingGetCurrentZoom")}function ht(){Z.Navigator&&Z.Navigator.getInitialized()&&Z.Navigator.syncToViewport()}function ft(e){Z.Ruler&&Z.Ruler.getInitialized()&&Z.Ruler.syncToViewport(e)}function Tt(){for(;Vl.length>Ln&&Nl.length>Ln;)Vl=Z.Utils.arraySplice(Vl,0,1),Nl=Z.Utils.arraySplice(Nl,0,1)}function bt(e){if(Ln>0){var t=Z.Utils.arrayIndexOf(Vl,e.name);-1!=t&&(Vl=Z.Utils.arraySplice(Vl,t,1),Nl=Z.Utils.arraySplice(Nl,t,1)),Vl[Vl.length]=e.name,Nl[Nl.length]=e}}function Et(){window.clearTimeout(Fl),Fl=null;var e=(new Date).getTime();Rl=(e-tilesTimeStart)/1e3;var t=Pl*Rl,i=Ol&&t>xl,a=Ol&&xl>=Ll;(2==Z.debug||3==Z.debug)&&(Z.Utils.trace("View validation-time elapsed: "+Rl),Ol>0&&Z.Utils.trace(i?"Loading delay - re-calling updateView":a?"Display delay - re-calling updateView":"Progress slow, resetting timer"),Z.Utils.trace(""),Z.traces.scrollTop=Z.traces.scrollHeight,Z.Utils.traceTileSpeed(Rl,Pl)),Ol>0?Hl>_l?i||a?(_l+=1,Zn.updateView(!0)):Fl=window.setTimeout(Et,Bl):console.log(Z.Utils.getResource("ERROR_VALIDATEVIEW")):(_l=0,Z.Utils.validateCallback("viewUpdateComplete"),Z.Utils.validateCallback("viewUpdateCompleteGetLabelIDs"))}function vt(e,t){if(0!=e||0!=t){var i=Math.round(100-t/e*100);return Math.round(i/10)}Z.Utils.validateCallback("loadingTilesComplete"),Z.Utils.validateCallback("loadingTilesCompleteGetLabelIDs")}function It(){rr=new Image,rr.url=sr,rr.onload=Zn.showVirtualPointer,rr.onerror=Ut,rr.src=sr}function yt(e,t,i,a){var n=rr.cloneNode(!1);n.width=e,n.height=t,or=Z.Utils.createContainerElement("div","piC","inline-block","absolute","hidden",e+"px",t+"px",i+"px",a+"px","none","0px","transparent none","0px","0px","normal"),or.appendChild(n),Z.ViewerDisplay.appendChild(or),or.setAttribute("title",Z.Utils.getResource("TIP_VIRTUALPOINTER"));var l=parseInt(Z.Utils.getResource("DEFAULT_UIELEMENTBASEZINDEX"),10);or.style.zIndex=(l+13).toString(),Z.Utils.addEventListener(or,"mousedown",St),Z.Utils.addEventListener(or,"touchstart",xt),Z.Utils.addEventListener(or,"touchmove",wt),Z.Utils.addEventListener(or,"touchend",Ot),Z.Utils.addEventListener(or,"touchcancel",Rt),Z.Utils.addEventListener(n,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(n,"mousedown",Z.Utils.preventDefault)}function Ut(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_VIRTUALPOINTERPATHINVALID")+this.url,!0)}function St(e){var e=Z.Utils.event(e);if(e&&or){Z.Utils.removeEventListener(or,"mousedown",St),Z.Utils.addEventListener(Z.ViewerDisplay,"mousemove",At),Z.Utils.addEventListener(Z.ViewerDisplay,"mouseup",Lt);var t=Z.Utils.getMousePosition(e);co=new Z.Utils.Point(t.x,t.y);var i=lt(e.clientX,e.clientY),a=new Z.Utils.Point(parseFloat(or.style.left),parseFloat(or.style.top)),n=i.x-a.x,l=i.y-a.y;or.mouseXPrior=co.x,or.mouseYPrior=co.y,or.mouseXOffset=n,or.mouseYOffset=l}}function At(e){var e=Z.Utils.event(e);if(e&&or){var t=Z.Utils.getMousePosition(e);Zo=new Z.Utils.Point(t.x,t.y);var i=Zo.x-or.mouseXPrior,a=Zo.y-or.mouseYPrior;or.mouseXPrior=Zo.x,or.mouseYPrior=Zo.y;var n=or.style,l=parseFloat(n.left)+i,o=parseFloat(n.top)+a;n.left=l+"px",n.top=o+"px"}}function Lt(e){var e=Z.Utils.event(e);if(e&&or){var t,i=Z.Utils.getMousePosition(e);t=Z.mouseOutDownPoint?Z.mouseOutDownPoint:new Z.Utils.Point(i.x,i.y),Z.Utils.removeEventListener(Z.ViewerDisplay,"mousemove",At),Z.Utils.removeEventListener(Z.ViewerDisplay,"mouseup",Lt),Z.Utils.addEventListener(or,"mousedown",St);var a=t.x-or.mouseXPrior,n=t.y-or.mouseYPrior,l=or.style,o=parseFloat(l.left)+a,r=parseFloat(l.top)+n;l.left=o+"px",l.top=r+"px"}}function xt(e){var e=Z.Utils.event(e);if(e){if(e.preventDefault(),Z.interactivityOff)return;if(or){var t=Z.Utils.getFirstTouch(e);if(t){var i=(t.target,new Z.Utils.Point(t.pageX,t.pageY));co=new Z.Utils.Point(i.x,i.y),or.mouseXPrior=i.x,or.mouseYPrior=i.y}}}}function wt(e){var e=Z.Utils.event(e);if(e){if(e.preventDefault(),Z.interactivityOff)return;if(!Z.mousePan)return;if(or){var t=Z.Utils.getFirstTouch(e);if(t){var i=(t.target,new Z.Utils.Point(t.pageX,t.pageY)),a=or.style,n=parseFloat(a.left),l=parseFloat(a.top);return a.left=n+(i.x-or.mouseXPrior)+"px",a.top=l+(i.y-or.mouseYPrior)+"px",or.mouseXPrior=i.x,or.mouseYPrior=i.y,!1}}}return!1}function Ot(e){var e=Z.Utils.event(e);if(e){if(e.preventDefault(),Z.interactivityOff)return;if(or){var t=Z.Utils.getFirstTouch(e);if(t){var i=(t.target,new Z.Utils.Point(t.pageX,t.pageY)),a=new Z.Utils.Point(i.x,i.y),n=a.x-or.mouseXPrior,l=a.y-or.mouseYPrior,o=or.style,r=parseFloat(o.left)+n,s=parseFloat(o.top)+l;o.left=r+"px",o.top=s+"px"}}}}function Rt(e){var e=Z.Utils.event(e);if(e){if(e.preventDefault(),Z.interactivityOff)return;if(or){var t=Z.Utils.getFirstTouch(e);if(t){var i=(t.target,new Z.Utils.Point(t.pageX,t.pageY)),a=new Z.Utils.Point(i.x,i.y),n=a.x-or.mouseXPrior,l=a.y-or.mouseYPrior,o=or.style,r=parseFloat(o.left)+n,s=parseFloat(o.top)+l;o.left=r+"px",o.top=s+"px"}}}}function Pt(){mr=new Image,hr=parseFloat(Z.Utils.getResource("DEFAULT_WATERMARKALPHA")),mr.url=Z.watermarkPath,mr.onload=Dt,mr.onerror=kt,mr.src=Z.watermarkPath}function Dt(){if(Ya)for(var e=parseFloat(Z.Utils.getResource("DEFAULT_WATERMARKMINSCALE")),t=parseFloat(Z.Utils.getResource("DEFAULT_WATERMARKSPANW")),i=parseFloat(Z.Utils.getResource("DEFAULT_WATERMARKSPANH")),a=Zn.getZoom(),n=(Z.imageW*a-Ya.width)/2,l=(Z.imageH*a-Ya.height)/2,o=(Z.imageW/2-Z.imageX)*a,r=(Z.imageH/2-Z.imageY)*a,s=e>a?e:a,u=Math.round(Z.imageW/t),d=Math.round(Z.imageH/i),p=Zn.getViewportDisplayBoundingBoxInPixels(),c=mr.width*s,g=mr.height*s,m=0,h=0,f=1;u>=f;f++)for(var T=1;d>=T;T++){var b=Math.round(Z.imageW/(u+1)*f),E=Math.round(Z.imageH/(d+1)*T);if(b>p.l&&b<p.r&&E>p.t&&E<p.b){var v=Math.round(b*a-c/2-n+o),I=Math.round(E*a-g/2-l+r);if(Z.imageW>4e3){var y=m+100,U=h+100;if(y>v&&U>I)continue;m=v,h=I}Ct(c,g,v,I)}}}function Ct(e,t,i,a){Nt(e,t,i,a)}function Nt(e,t,i,a){var n=mr.cloneNode(!1);Z.Utils.setOpacity(n,hr),n.width=e,n.height=t;var l=Z.Utils.createContainerElement("div","wiC","inline-block","absolute","hidden",e+"px",t+"px",i+"px",a+"px","none","0px","transparent none","0px","0px","normal");l.appendChild(n),Ya.appendChild(l),Z.Utils.addEventListener(n,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(n,"mousedown",Z.Utils.preventDefault)}function Vt(){Ya&&(Z.Utils.clearDisplay(Ya),Dt())}function kt(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_WATERMARKPATHINVALID")+this.url)}function Mt(e,t,i,a){var n,l,o=a?1:t.currentZ,r=e.z/100,s=o/r;if(s=s<t.constrainedScaleMin?t.constrainedScaleMin:s>t.constrainedScaleMax?t.constrainedScaleMax:s,"text"==e.mediaType){var t=new Kt,r=e.z/100;hCaption=Jt(e,t),qa.appendChild(hCaption);var u=new ti(hCaption,r,!0);qa.removeChild(hCaption),n=u.w,l=u.h}else if("icon"==e.mediaType)n=e.iW,l=e.iH;else if("polygon"==e.mediaType){var d=Z.Utils.polygonDimensions(e.polygonPts,i);n=d.x,l=d.y}n*=s*(e.xScale/100),l*=s*(e.yScale/100),this.w=n,this.h=l}function Ft(e){if(Z.Utils.stringValidate(Ea))if(Z.simplePath)dataPath=Ea;else{if(".xml"!=Ea.toLowerCase().substring(Ea.length-4,Ea.length)){var t=Z.Utils.getResource(Z.tour?"DEFAULT_TOURSXMLFILE":"DEFAULT_HOTSPOTSXMLFILE");Ea=Ea+"/"+t}dataPath=Z.Utils.cacheProofPath(Ea)}if("undefined"!=typeof dataPath&&Z.Utils.stringValidate(dataPath)){vpIDTemp=Z.imageSet?e:null;var i=new Z.NetConnector;-1!=dataPath.toLowerCase().indexOf(".xml")&&i.loadXML(dataPath,vpIDTemp)}}function _t(e,t){var i=Z.Utils.arrayIndexOfObjectValue(Cr,"media",e.media);if(-1!=i){var a=new Image;a.src=e.media;var n=a.width,l=a.height;if(a=null,Cr[i].element&&(e.image=Cr[i].element.cloneNode(!1)),e.iW=n,e.iH=l,t){var o=new Kt;Wt(e,o)}}else{Cr[Cr.length]={media:e.media,element:null};var r=(new Date).getTime();Bt(e.media,r)}}function Ht(e){var t,i;t=e.getAttribute("ID"),this.id=""!=t?t:Ti("labelExternal"),t=e.getAttribute("INTERNALID"),this.internalID=isNaN(parseInt(t))?Ti(ps?"hotspot":"label"):t,this.poiID=e.getAttribute("POIID"),t=e.getAttribute("NAME"),this.name=""!=t?t:this.id,this.mediaType=e.getAttribute("MEDIATYPE"),this.media=e.getAttribute("MEDIA"),this.image=null,this.iW=null,this.iH=null,i=parseFloat(e.getAttribute("X")),this.x=isNaN(i)?0:i,i=parseFloat(e.getAttribute("Y")),this.y=isNaN(i)?0:i,i=parseFloat(e.getAttribute("ZOOM")),this.z=isNaN(i)?-1:i,i=parseFloat(e.getAttribute("XSCALE")),this.xScale=isNaN(i)?100:i,i=parseFloat(e.getAttribute("YSCALE")),this.yScale=isNaN(i)?100:i,this.clickURL=e.getAttribute("CLICKURL"),this.urlTarget=e.getAttribute("URLTARGET"),t=e.getAttribute("ROLLOVER"),this.rollover="1"==t||"true"==t,this.caption=e.getAttribute("CAPTION"),this.comment=e.getAttribute("COMMENT"),this.tooltip=e.getAttribute("TOOLTIP"),this.user=e.getAttribute("USER"),this.date=e.getAttribute("DATE"),this.textColor=e.getAttribute("TEXTCOLOR"),this.backColor=e.getAttribute("BACKCOLOR"),this.lineColor=e.getAttribute("LINECOLOR"),this.fillColor=e.getAttribute("FILLCOLOR"),t=e.getAttribute("TEXTVISIBLE"),this.textVisible="false"!=t&&"0"!=t&&Z.captionTextVisible,t=e.getAttribute("BACKVISIBLE"),this.backVisible="false"!=t&&"0"!=t&&Z.captionBackVisible,t=e.getAttribute("LINEVISIBLE"),this.lineVisible="false"!=t&&"0"!=t&&Z.polygonLineVisible,t=e.getAttribute("FILLVISIBLE"),this.fillVisible="false"!=t&&"0"!=t&&Z.polygonFillVisible;var a=e.getAttribute("CAPTIONPOSITION");this.captionPosition=Z.Utils.stringValidate(a)?a:"8";var n=e.getAttribute("SAVED");this.saved=null===n?!0:n,this.visibility=!0;var l=e.getElementsByTagName("CAPTION");l.length>0&&(this.captionHTML=unescape(Z.Utils.xmlConvertDocToText(l[0])));var o=e.getElementsByTagName("TOOLTIP");if(o.length>0&&(this.tooltipHTML=unescape(Z.Utils.xmlConvertDocToText(o[0]))),"freehand"==e.getAttribute("MEDIA")||"rectangle"==e.getAttribute("MEDIA")||"polygon"==e.getAttribute("MEDIA")||"measure"==e.getAttribute("MEDIA")){var r=e.getElementsByTagName("POLYGON");if(r.length>0){var s=e.getElementsByTagName("POLYGON")[0];this.polyClosed="0"!=s.getAttribute("CLOSED");for(var u=s.getElementsByTagName("POINT"),d=[],p=0,c=u.length;c>p;p++){var g=parseFloat(u[p].getAttribute("X")),m=isNaN(g)?0:g,h=parseFloat(u[p].getAttribute("Y")),f=isNaN(h)?0:h;d[d.length]={x:m,y:f}}this.polygonPts=d}}this.audio=e.getAttribute("AUDIO"),Z.Utils.stringValidate(this.audio)&&(Z.audioContent=!0),i=parseFloat(e.getAttribute("SHOWFOR")),this.showFor=isNaN(i)?0:i,this.transition=e.getAttribute("TRANSITION"),i=parseFloat(e.getAttribute("CHANGEFOR")),this.changeFor=isNaN(i)?0:i;
var T=parseFloat(e.getAttribute("ROTATION"));this.rotation=isNaN(T)?0:T,this.category=e.getAttribute("CATEGORY"),this.zIndex=Dr.length.toString()}function Bt(e,t){Yr.loadImage(e,Z.Utils.createCallback(null,zt,e,t),"hotspot")}function zt(e,t,i){if(e&&t&&i)for(var a=new Kt,n=0,l=Dr.length;l>n;n++){var o=Dr[n];if(o.media==e){var r=Z.Utils.arrayIndexOfObjectValue(Cr,"media",e);-1!=r?Cr[r].element=i:Cr[Cr.length]={media:e,element:i},o.image=i.cloneNode(!1),o.iW=i.width,o.iH=i.height,Wt(o,a)}}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_HOTSPOTPATHINVALID"))}function Xt(){qa&&Zn.getStatus("initialized")&&(Z.Utils.clearDisplay(qa),tn&&Z.Utils.clearDisplay(tn),on&&Z.Utils.clearDisplay(on),"inline-block"==Qa.display&&Gt())}function Gt(){for(var e=new Kt,t=0,i=Dr.length;i>t;t++)Wt(Dr[t],e);if(0==qa.childNodes.length){var a=Z.Utils.createContainerElement("div","hotspotImmortal","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal");qa.appendChild(a)}}function Wt(e,t){if(Nr.length>0){var i=Z.Utils.arrayIndexOf(Nr,e.id);if(-1==i)return}else if(Vr.length>0){var i=Z.Utils.arrayIndexOf(Vr,e.internalID);if(-1==i)return}if("polygon"==e.media&&(!Z.hotspotsDrawOnlyInView||e.x+qr>t.box.l&&e.x-qr<t.box.r&&e.y+qr>t.box.t&&e.y-qr<t.box.b)&&Di(e),!Z.hotspotsDrawOnlyInView||e.x>t.box.l&&e.x<t.box.r&&e.y>t.box.t&&e.y<t.box.b){var a=Z.mouseIsDown&&0==e.rollover;Yt(e,t,null,a)}}function Yt(e,t,i,a){var n=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",e.internalID);if(-1!=n&&si(e.internalID),Z.useCanvas&&"polygon"==e.media){var l=e.polygonPts;if(l){var o=Z.Utils.polygonDimensions(e.polygonPts,i);e.iW=o.x,e.iH=o.y}}var r=!Z.Utils.stringValidate(e.media),s=!Z.Utils.stringValidate(e.caption)&&!Z.Utils.stringValidate(e.captionHTML)&&"measure"!=e.mediaType,u=null===e.iW||null===e.iH,d="polygon"!=e.media;if(!(r&&s&&u&&d)){var p="polygon"!=e.media?e.z/100:1,c=t.currentZ/p;"polygon"!=e.media&&(t.constrainedScaleMin>0&&c<t.constrainedScaleMin&&(c=t.constrainedScaleMin),t.constrainedScaleMax>0&&c>t.constrainedScaleMax&&(c=t.constrainedScaleMax));var g,m=e.iW*c*(e.xScale/100),h=e.iH*c*(e.yScale/100);"placeholder"!=e.media&&e.image&&(g=e.image,g.align="top",g.width=m,g.height=h);var f=Math.round(e.x*t.currentZ-m/2-t.displayOffsetL+t.imageOffsetL),T=Math.round(e.y*t.currentZ-h/2-t.displayOffsetT+t.imageOffsetT),b=null,E=null;s||(Z.captionBoxes||"measure"==e.mediaType?b=Jt(e,t):(E=Jt(e,t,!0,!0),b=Jt(e,t,!0,!1)));var v=Z.Utils.createContainerElement("div","hCloak","inline-block","absolute","visible"),I="hot"+e.internalID.toString(),y=Z.Utils.createContainerElement("div",I,"inline-block","absolute","visible",m+"px",h+"px",f+"px",T+"px","none","0px","transparent none","0px","0px","normal");if("TOOLTIP"==ys?y.title=Z.Utils.stringValidate(e.tooltip)?e.tooltip:"":"COMMENT"==ys&&(y.title=Z.Utils.stringValidate(e.comment)?e.comment:""),!Z.labelClickSelect&&Z.Utils.stringValidate(e.clickURL)){if(null!==Z.editMode)Z.Utils.addEventListener(v,"mousedown",yi),Z.Utils.addEventListener(v,"touchstart",Ui);else if("function"==e.clickURL)Z.Utils.addEventListener(y,"mousedown",Si),Z.Utils.addEventListener(y,"touchstart",Si);else{if(g){var U=document.createElement("a");U.setAttribute("href",e.clickURL),U.setAttribute("target",e.urlTarget),U.setAttribute("outline","none"),U.appendChild(g),g.style.cursor="help",g.style.border="none"}if(b){var S=document.createElement("a");S.setAttribute("href",e.clickURL),S.setAttribute("target",e.urlTarget),S.setAttribute("outline","none"),E&&(S.appendChild(E),E.style.cursor="help"),S.appendChild(b),b.style.cursor="help"}v.style.border="none"}null===Z.editMode&&(Z.clickZoom||Z.clickPan)&&(Z.Utils.addEventListener(v,"mousedown",Ei),Z.Utils.addEventListener(v,"touchstart",Ii))}if(!Z.labelClickSelect&&Z.Utils.stringValidate(e.clickURL)&&null===Z.editMode&&"function"!=e.clickURL?(U&&v.appendChild(U),S&&v.appendChild(S)):(g&&v.appendChild(g),E&&v.appendChild(E),b&&v.appendChild(b)),y.appendChild(v),qa.appendChild(y),y.zIndex=e.zIndex,!s&&(Z.captionBoxes||"measure"==e.mediaType)){var A=e.backColor.toString();if(A){var L=Z.Utils.hexToRGB(A).r,x=Z.Utils.hexToRGB(A).g,w=Z.Utils.hexToRGB(A).b,O=gr,R="rgba("+L+","+x+","+w+","+O+")";b.style.backgroundColor=R}}e.rollover&&(v.rollover=e.rollover),y.internalID=e.internalID,a||Zn.setHotspotVisibility(y,!e.rollover&&e.visibility),E&&$t(e,E,m,h,!0),$t(e,b,m,h),e.rollover&&(Z.Utils.addEventListener(y,"mouseover",bi),Z.Utils.addEventListener(y,"mouseout",vi)),Z.Utils.addEventListener(y,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(y,"contextmenu",Z.Utils.preventDefault)}}function Kt(e){qa&&(this.box=Zn.getViewportDisplayBoundingBoxInPixels(e),this.currentZ=Zn.getZoom(),this.constrainedScale=this.currentZ<ms?ms:this.currentZ>hs?hs:this.currentZ,this.constrainedScaleMax=hs,this.constrainedScaleMin=ms,this.displayOffsetL=(Z.imageW*this.currentZ-qa.width)/2,this.displayOffsetT=(Z.imageH*this.currentZ-qa.height)/2,this.imageOffsetL=(Z.imageW/2-Z.imageX)*this.currentZ,this.imageOffsetT=(Z.imageH/2-Z.imageY)*this.currentZ)}function jt(e){("undefined"==typeof e||null===e)&&(e=document.getElementById("progressTextBox"));var t=null;return-1!=e.id.indexOf("hot")&&-1==e.id.indexOf("hotspotDisplay")?t=e:e.parentNode&&-1!=e.parentNode.id.indexOf("hot")&&-1==e.parentNode.id.indexOf("hotspotDisplay")?t=e.parentNode:e.parentNode.parentNode&&-1!=e.parentNode.parentNode.id.indexOf("hot")&&-1==e.parentNode.parentNode.id.indexOf("hotspotDisplay")?t=e.parentNode.parentNode:e.parentNode.parentNode.parentNode&&-1!=e.parentNode.parentNode.parentNode.id.indexOf("hot")&&-1==e.parentNode.parentNode.parentNode.id.indexOf("hotspotDisplay")&&(t=e.parentNode.parentNode.parentNode),t}function qt(e,t){for(var i=t.x-e.x,a=t.y-e.y,n=e.polygonPts.slice(0),l=0,o=n.length;o>l;l++)n[l].x+=i,n[l].y+=a;e.polygonPts=n.slice(0)}function Qt(e,t,i){for(var a=e.polygonPts.slice(0),n="xScale"==t?"x":"y",l=e[n]-e[n]*i,o=0,r=a.length;r>o;o++)a[o][n]=a[o][n]*i+l;e.polygonPts=a.slice(0)}function Jt(e,t,i,a){var n=e.z/100,l=t.currentZ/n;t.constrainedScaleMin>0&&l<t.constrainedScaleMin&&(l=t.constrainedScaleMin),t.constrainedScaleMax>0&&l>t.constrainedScaleMax&&(l=t.constrainedScaleMax);var o,r,s,u=Math.round(ls*l),d="text"==e.mediaType?u:os>u?os:u>rs?rs:u,p=ss*l,c=us>p?us:p>ds?ds:p,g=Z.Utils.stringValidate(e.textColor)?e.textColor:as;"undefined"!=typeof i&&null!==i&&i?(o="0px",r="transparent none",s="normal"):e.backVisible?(o="1px",r=e.backColor,s="normal"):(o="1px",r=Z.Utils.stringValidate(e.backColor)?e.backColor:ns,s="normal"),"undefined"!=typeof a&&null!==a&&a&&(g=e.backColor),e.textVisible||(g="transparent none"),Z.captionBoxes&&Z.captionsColorsDefault&&"measure"!=e.mediaType&&(g=e.backColor,r=e.textColor),g==r&&("#ffffff"==g?r="#000000":"#000000"==g&&(r="#ffffff"));var m=Z.Utils.createContainerElement("div","captionTextBox","inline-block","absolute","hidden","auto","auto","1px","1px","solid",o,r,"0px",c+"px","pre");if("undefined"!=typeof e.captionHTML&&Z.Utils.stringValidate(e.captionHTML))m.innerHTML=e.captionHTML,Z.Utils.setHTMLTextDefaultCaptionStyle(m,e.captionHTML,g,"verdana",d+"px","none","normal","normal","normal","normal","1em","center","none");else if("transparent none"!=g&&"undefined"!=typeof e.caption&&Z.Utils.stringValidate(e.caption)){var h=document.createTextNode(e.caption);m.appendChild(h),Z.Utils.setTextNodeStyle(h,g,"verdana",d+"px","none","normal","normal","normal",s,"1em","center","none"),Z.Utils.disableTextInteraction(h)}else if("measure"==e.mediaType){var f=new Z.Utils.Point(e.x,e.y);ai(e,f)}return Z.Utils.addEventListener(m,"contextmenu",Z.Utils.preventDefault),m}function $t(e,t,i,a,n){if(t){var l=Mr==e.internalID&&"polygon"==e.media,o=ei(t,e.captionPosition,i,a,Z.imageR,l);if(o){var r=n?1:0;t.style.left=o.x+r+"px",t.style.top=o.y+r+"px"}}}function ei(e,t,i,a,n,l){var o,r,s,u=e.style,d=l&&("addLabel"==Z.editing||"editLabel"==Z.editing||null===Z.editMode&&"measure"==Z.labelMode)?40:0,p=parseFloat(u.padding),t=ii(t,n),t=parseInt(t,10);0>n&&(n+=360);var c=new ti(e);o=(i-c.w)/2-p,r=(a-c.h)/2-p,Z.Utils.rotateElement(u,-n);var g=i/2+c.w/2+p+d,m=a/2+c.h+p+d;switch((90==n||270==n)&&(s=g,g=m,m=s),t){case 1:o-=g,r-=m;break;case 2:r-=m;break;case 3:o+=g,r-=m;break;case 4:o-=g;break;case 6:o+=g;break;case 7:o-=g,r+=m;break;case 8:r+=m;break;case 9:o+=g,r+=m}return new Z.Utils.Point(o,r)}function ti(e,t,i){("undefined"==typeof t||null===t)&&(t=1);var a=e.style,n=Zn.getZoom(),l=parseFloat(Z.Utils.getElementStyleProperty(e,"width"));if(isNaN(l)){var o=parseFloat(Z.Utils.getResource("DEFAULT_FONTTOPIXELSCONVERSIONFACTOR")),r=parseFloat(a.fontSize)/o;l=Math.round(parseFloat(e.firstChild.length*r))}var s=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONFONTSIZE"),10),u=(s/parseFloat(a.fontSize),2*parseFloat(Z.Utils.getResource("DEFAULT_MINHOTSPOTCAPTIONFONTSIZE"))),d=2*parseFloat(Z.Utils.getResource("DEFAULT_MAXHOTSPOTCAPTIONFONTSIZE")),p=1.7*s*n/t;i&&(u>p?p=u:p>d&&(p=d)),this.w=l,this.h=p}function ii(e,t){var i=parseInt(e,10);switch(0>t&&(t+=360),i){case 1:i=0==t?i:90==t?7:180==t?9:270==t?3:5;break;case 2:i=0==t?i:90==t?4:180==t?8:270==t?6:5;break;case 3:i=0==t?i:90==t?1:180==t?7:270==t?9:5;break;case 4:i=0==t?i:90==t?8:180==t?6:270==t?2:5;break;case 6:i=0==t?i:90==t?2:180==t?4:270==t?8:5;break;case 7:i=0==t?i:90==t?9:180==t?3:270==t?1:5;break;case 8:i=0==t?i:90==t?6:180==t?2:270==t?4:5;break;case 9:i=0==t?i:90==t?3:180==t?1:270==t?7:5}return e=i.toString()}function ai(e,t){var i=e.polyClosed,a=e.polygonPts.slice(0),n=a.length,l="",o=0,r="",s="pixels"==Z.units?0:4,u="um"!=Z.units?Z.units:"m";if(0==n)l=ur,o=Z.Utils.polygonPerimeter(a,i,t,s),captionText=l+o.toString()+"  "+u,e.caption=captionText;else if(n>0&&!i)l=dr,o=Z.Utils.polygonPerimeter(a,i,t,s),captionText=l+o.toString()+"  "+u,e.caption=captionText;else{l=pr,o=Z.Utils.polygonPerimeter(a,i,t,s);var r=Zr;captionText=l+o.toString()+"  "+u,l=cr,o=Z.Utils.polygonArea(a,i,t,s),captionText+="\n"+l+o.toString()+"  "+u+r,e.caption=captionText}vs&&vs.firstChild&&vs.firstChild.value&&(vs.firstChild.value=kr.caption)}function ni(e,t,i,a){("undefined"==typeof a||null===a)&&(a=Sa);var n=a.toString(),l="0"==e||Z.imageSet?"hidden":"visible",o=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTLISTWIDTH"),10),r=parseInt(Z.Utils.getResource("DEFAULT_IMAGESETLISTWIDTH"),10),s=Z.imageSet?r:o,u=ui(e,s,Kn,jn);if("undefined"==typeof ps||null===ps){Z["HotspotList"+n]=new Z.Utils.createSelectElement("HotspotList"+n,t,i,s,u.x,u.y,null,l,Ai,"mousedown"),ps=Z["HotspotList"+n],Ja=ps,$a=Ja.style,"0"!=e&&Z.ViewerDisplay.appendChild(ps),Z.tour&&(br=0);var d=Z.Utils.stringValidate(Z.hotspotListTitle)&&"none"!=Z.hotspotListTitle?1:0;ps.selectedIndex=d}else Z.Utils.arrayClear(i)}function li(e,t){if(null!=ps){var i=Z.Utils.arrayIndexOfObjectValue(fs,"value",t);if(-1!=i){var a="none"!=Z.hotspotListTitle&&"none"!=Z.tourListTitle?1:0;ps.options[i+a]=new Option(e,t.toString()),fs[i]={text:e,value:t}}else ps.options[ps.options.length]=new Option(e,t.toString()),fs[fs.length]={text:e,value:t}}}function oi(e){if(Z.hotspots&&null!=ps){var t=Z.Utils.arrayIndexOfObjectValue(fs,"value",e);if(-1!=t){fs=Z.Utils.arraySplice(fs,t,1),Z.Utils.updateSelectElement(ps,fs);var i=ps.length;0!=i&&(ps.selectedIndex=t>i-1?i-1:t)}}}function ri(){ps.options.length=0}function si(e){var t=document.getElementById("hot"+e);null!==t&&t.parentNode.removeChild(t)}function ui(e,t,i,a){var n,l,o=Z.imageSet?13:25;switch(e){case"0":n=0,l=0;break;case"1":n=o,l=o;break;case"2":n=i-t-o,l=Z.imageSet?32:20;break;case"3":n=i-t-o,l=null!=toolbar?a-2*o:a-1.5*o;break;case"4":n=o,l=null!=toolbar?a-2*o:a-1.5*o;break;default:n=i-t,l=o}return new Z.Utils.Point(n,l)}function di(e){return Z.Utils.stringValidate(e.media)||Z.Utils.stringValidate(e.caption)||null!==Z.tourPath}function pi(e){var t=e.getAttribute("MEDIATYPE"),i=e.getAttribute("MEDIA");if("symbol"==t){switch(i){case"circle":i=Ia+"/circle.png";break;case"square":i=Ia+"/square.png";break;case"triangle":i=Ia+"/triangle.png";break;case"arrowDown":i=Ia+"/arrowDown.png";break;case"arrowDownLeft":i=Ia+"/arrowDownLeft.png";break;case"arrowLeft":i=Ia+"/arrowLeft.png";break;case"arrowUpLeft":i=Ia+"/arrowUpLeft.png";break;case"arrowUp":i=Ia+"/arrowUp.png";break;case"arrowUpRight":i=Ia+"/arrowUpRight.png";break;case"arrowRight":i=Ia+"/arrowRight.png";break;case"arrowDownRight":i=Ia+"/arrowDownRight.png";break;case"lineHorizontal":i=Ia+"/lineHorizontal.png";break;case"lineVertical":i=Ia+"/lineVertical.png";break;default:i=Ia+"/noSubstitutePlaceholder.png"}e.setAttribute("MEDIATYPE","icon"),e.setAttribute("MEDIA",i),Pr=!0}return e}function ci(){var e=Z.Utils.getResource("CONTENT_FIRSTPOINAME");Zi("0",e,"center","center","-1","0"),_r="0"}function Zi(e,t,i,a,n,l){var o=Z.Utils.arrayToArrayOfStrings([e,t,i,a,n,l]),r='<POI ID="'+o[0]+'" NAME="'+o[1]+'" X="'+o[2]+'" Y="'+o[3]+'" ZOOM="'+o[4]+'" INTERNALID="'+o[5]+'" ></POI>',s=Z.Utils.xmlConvertTextToDoc(r),u=s.getElementsByTagName("POI")[0];gi(u,!0)}function gi(e,t){t&&(e=hi(e,"poi"));var i=Z.Utils.arrayIndexOfObjectValue(Us,"value",e.getAttribute("INTERNALID"));-1==i&&(i=Us.length),Us[i]={text:e.getAttribute("NAME"),value:e.getAttribute("INTERNALID"),id:e.getAttribute("ID"),x:e.getAttribute("X"),y:e.getAttribute("Y"),z:e.getAttribute("ZOOM"),user:e.getAttribute("USER"),date:e.getAttribute("DATE")}}function mi(e,t){if(!Z.measureVisible||null!==Z.editMode){var i=Z.Utils.arrayIndexOfObjectValue(Ls,"value",Mr);if(-1!=i){Ls[i]={text:e.name,value:Mr,poiID:t};var a=Z.Utils.arrayIndexOfObjectValue(xs,"value",Mr);-1!=a&&(xs[a]={text:e.name,value:Mr,poiID:t},Zn.getStatus("XMLParsed")&&Z.Utils.updateSelectElement(Es,xs))}else Ls[Ls.length]={text:e.name,value:Mr,poiID:t},xs[xs.length]={text:e.name,value:Mr,poiID:t};if(Zn.getStatus("XMLParsed")&&Es){var n=Ls[Ls.length-1];Oi(n.poiID,n.value)}}}function hi(e,t){var i,a;switch(t){case"hotspot":i=Ti(ps?"hotspot":"label"),a=Z.Utils.stringValidate(Z.labelMode)?Z.labelMode:"",Z.Utils.stringValidate(e.getAttribute("ID"))||e.setAttribute("ID",i);var n=Z.Utils.getResource(ps?"CONTENT_HOTSPOTNAME":"CONTENT_LABELNAME");Z.Utils.stringValidate(e.getAttribute("NAME"))||e.setAttribute("NAME",n+i+": "+a);var l=Z.Utils.getResource(ps?"CONTENT_HOTSPOTCAPTION":"CONTENT_LABELCAPTION");Z.Utils.stringValidate(e.getAttribute("CAPTION"))||"freehand"==Z.editMode||Z.tourPath||Z.Utils.stringValidate(e.getAttribute("MEDIA"))||Z.Utils.stringValidate(e.getAttribute("MEDIA")&&"polygon"==e.getAttribute("MEDIA"))||e.setAttribute("CAPTION",l+i),e.setAttribute("NAME",Z.Utils.xmlUnescapeMinimal(unescape(e.getAttribute("NAME")))),e.setAttribute("CAPTION",Z.Utils.xmlUnescapeMinimal(unescape(e.getAttribute("CAPTION")))),Z.Utils.stringValidate(e.getAttribute("X"))||e.setAttribute("X",Z.imageX.toString()),Z.Utils.stringValidate(e.getAttribute("Y"))||e.setAttribute("Y",Z.imageY.toString()),Z.Utils.stringValidate(e.getAttribute("ZOOM"))||e.setAttribute("ZOOM",(100*Z.imageZ).toString()),!Z.Utils.stringValidate(e.getAttribute("CLICKURL"))&&Z.Utils.stringValidate(e.getAttribute("URL"))&&e.setAttribute("CLICKURL",e.getAttribute("URL")),isNaN(parseInt(e.getAttribute("INTERNALID"),10))&&e.setAttribute("INTERNALID",i);var o=e.getAttribute("MEDIATYPE");Z.Utils.stringValidate(e.getAttribute("TEXTCOLOR"))&&Z.Utils.stringValidate(e.getAttribute("BACKCOLOR"))&&(Z.captionsColorsDefault=!1),(Z.captionBoxes||"measure"==o)&&Z.captionsColorsDefault&&(e.setAttribute("TEXTCOLOR",Z.Utils.getResource("CONTENT_CAPTIONTEXTCOLOR")),e.setAttribute("BACKCOLOR",Z.Utils.getResource("CONTENT_CAPTIONBACKCOLOR")));break;case"poi":i=Ti("poi"),Z.Utils.stringValidate(e.getAttribute("ID"))||e.setAttribute("ID",i),Z.Utils.stringValidate(e.getAttribute("NAME"))||e.setAttribute("NAME",Z.Utils.getResource("CONTENT_POINAME")+i),Z.Utils.stringValidate(e.getAttribute("X"))||e.setAttribute("X",Z.imageX.toString()),Z.Utils.stringValidate(e.getAttribute("Y"))||e.setAttribute("Y",Z.imageY.toString()),Z.Utils.stringValidate(e.getAttribute("ZOOM"))||e.setAttribute("ZOOM",(100*Z.imageZ).toString()),isNaN(parseInt(e.getAttribute("INTERNALID"),10))&&e.setAttribute("INTERNALID",i);break;case"label":i=Ti("label"),a=Z.Utils.stringValidate(Z.labelMode)?Z.labelMode:"",Z.Utils.stringValidate(e.getAttribute("ID"))||e.setAttribute("ID",i),Z.Utils.stringValidate(e.getAttribute("NAME"))||e.setAttribute("NAME",Z.Utils.getResource("CONTENT_LABELNAME")+i+": "+a);var o=e.getAttribute("MEDIATYPE"),r=e.getAttribute("MEDIA");Z.Utils.stringValidate(r)||"text"==o||(e.setAttribute("MEDIA",Ia+"/"+Z.Utils.getResource("DEFAULT_ANNOTATIONMEDIA")),e.setAttribute("MEDIATYPE",Z.Utils.getResource("DEFAULT_ANNOTATIONMEDIATYPE"))),Z.Utils.stringValidate(e.getAttribute("TEXTCOLOR"))&&Z.Utils.stringValidate(e.getAttribute("BACKCOLOR"))&&(Z.captionsColorsDefault=!1),(Z.captionBoxes||"measure"==o)&&Z.captionsColorsDefault&&(e.setAttribute("TEXTCOLOR",Z.Utils.getResource("CONTENT_CAPTIONTEXTCOLOR")),e.setAttribute("BACKCOLOR",Z.Utils.getResource("CONTENT_CAPTIONBACKCOLOR"))),Z.Utils.stringValidate(e.getAttribute("CAPTION"))||e.setAttribute("CAPTION",Z.Utils.getResource("CONTENT_LABELCAPTION")+i),!Z.Utils.stringValidate(e.getAttribute("CLICKURL"))&&Z.Utils.stringValidate(e.getAttribute("URL"))&&e.setAttribute("CLICKURL",e.getAttribute("URL")),Z.Utils.stringValidate(e.getAttribute("X"))||e.setAttribute("X",Z.imageX.toString()),Z.Utils.stringValidate(e.getAttribute("Y"))||e.setAttribute("Y",Z.imageY.toString()),Z.Utils.stringValidate(e.getAttribute("ZOOM"))||e.setAttribute("ZOOM",(100*Z.imageZ).toString()),isNaN(parseInt(e.getAttribute("INTERNALID"),10))&&e.setAttribute("INTERNALID",i),isNaN(parseInt(e.getAttribute("POIID"),10))&&e.setAttribute("POIID",Ts.options[Ts.selectedIndex].value)}return e}function fi(e,t){var i=0,a="",n="";if("none"!=Z.annotationSort){switch(Z.annotationSort){case"id":a=e.value.toLowerCase(),n=t.value.toLowerCase();break;case"name":a=e.text.toLowerCase(),n=t.text.toLowerCase()}n>a?i=-1:a>n&&(i=1)}return i}function Ti(e){var t=0,i=[];switch(e){case"slide":if(wr)for(var a=0,n=wr.length;n>a;a++)i[i.length]=parseInt(wr[a].internalID,10);break;case"hotspot":if(Dr)for(var a=0,n=Dr.length;n>a;a++)i[i.length]=parseInt(Dr[a].internalID,10);break;case"poi":if(Us)for(var a=0,n=Us.length;n>a;a++)i[i.length]=parseInt(Us[a].value,10);break;case"label":if(Ls)for(var a=0,n=Ls.length;n>a;a++)i[i.length]=parseInt(Ls[a].value,10);break;case"labelExternal":if(Dr)for(var a=0,n=Dr.length;n>a;a++)i[i.length]=parseInt(Dr[a].id,10);break;case"note":if(Ss)for(var a=0,n=Ss.length;n>a;a++)i[i.length]=parseInt(Ss[a].value,10)}return i.length>0&&(i=Z.Utils.arraySortNumericAscending(i),t=i[i.length-1]+1),t.toString()}function bi(e){var e=Z.Utils.event(e);if(e){var t=Z.Utils.target(e),i=Z.Utils.relatedTarget(e),a=jt(t);null===a||null===i||"captionTextBox"==i.id&&-1!=t.id.indexOf("hot")&&-1==t.id.indexOf("hotspotDisplay")||"captionTextBox"==t.id&&-1!=i.id.indexOf("hot")&&-1==i.id.indexOf("hotspotDisplay")||Zn.setHotspotVisibility(a,!0)}}function Ei(e){var e=Z.Utils.event(e);e&&(Z.clickZoomAndPanBlock=!0)}function vi(e){var e=Z.Utils.event(e);if(e){var t=Z.Utils.target(e),i=Z.Utils.relatedTarget(e),a=jt(t);null===a||null===i||"captionTextBox"==i.id&&-1!=t.id.indexOf("hot")&&-1==t.id.indexOf("hotspotDisplay")||"captionTextBox"==t.id&&-1!=i.id.indexOf("hot")&&-1==i.id.indexOf("hotspotDisplay")||Zn.setHotspotVisibility(a,!1)}}function Ii(e){var e=Z.Utils.event(e);e&&(Z.clickZoomAndPanBlock=!0)}function yi(e){var e=Z.Utils.event(e);if(e&&!e.altKey){var t=Z.Utils.target(e),i=jt(t),a=i.id.substring(3,i.id.length),n=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",a);if(-1!=n){Dr[n].clickURL}var l=Z.Utils.getResource("ALERT_HOTSPOTCLICKURLDISABLED");Z.Utils.showMessage(l,!0,null,"center",!0)}}function Ui(e){var e=Z.Utils.event(e);if(e&&!e.altKey){var t=Z.Utils.target(e),i=jt(t),a=i.id.substring(3,i.id.length),n=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",a);if(-1!=n){Dr[n].clickURL}var l=Z.Utils.getResource("ALERT_HOTSPOTCLICKURLDISABLED");Z.Utils.showMessage(l,!0,null,"center",!0)}}function Si(){var e=Z.Viewport.getHotspotTarget(this),t=e.id.substring(3,e.id.length),i=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",t);if(-1!=i){var a=unescape(Dr[i].urlTarget),n=new Function(a);window.setTimeout(n,200)}}function Ai(){if(Z.Utils.removeEventListener(ps,"mousedown",Ai),Z.hotspotListTitle&&Z.Utils.stringValidate(Z.hotspotListTitle)&&"none"!=Z.hotspotListTitle)ps.selectedIndex=0;else{var e=Z.Utils.getResource("UI_LISTMOUSEDOWNTEXT");if(ps.options[0].text!=e){var t=document.createElement("option");t.text=e,t.value=null,ps.add(t,0)}ps.selectedIndex=0}Z.Utils.addEventListener(ps,"change",Li)}function Li(e){var e=Z.Utils.event(e);if(e){Z.tourPlaying&&Zn.tourStop();var t=Z.Utils.target(e),i=t.options[t.selectedIndex].value;if(!isNaN(parseInt(i),10)){var a=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",i);if(-1!=a){var n=Dr[a];Z.Utils.playAudio(Er,n.audio),Zn.zoomAndPanToView(n.x,n.y,n.z/100,n.rotation)}}Z.Utils.removeEventListener(ps,"change",Li);{window.setTimeout(function(){Z.Utils.addEventListener(ps,"mousedown",Ai)},10)}}}function xi(e,t){if(Us.sort(fi),Z.Utils.updateSelectElement(Ts,Us,e),"undefined"==typeof e||null===e)0==Ts.options.length&&ci(),e="0";else{var i=Z.Utils.arrayIndexOfObjectValue(Us,"value",e);-1!=i&&(e=Us[i].value)}wi(e),Oi(e,t)}function wi(e){var t=Sa.toString(),i=Z.Utils.arrayIndexOfObjectValue(Us,"value",e),a=document.getElementById("poiNameTextElement"+t);a&&-1!=i&&(a.value=Us[i].text)}function Oi(e,t){Ls.sort(fi),xs="markup"==Z.editMode?Z.Utils.arrayClone("labels",Ls,xs):Pi(Ls,e),Z.Utils.updateSelectElement(Es,xs,t),("undefined"==typeof t||null===t)&&(t=Es.options.length>0?Es.options[0].value:null),Ri(t)}function Ri(e){var t=Sa.toString();Mr=e,Br=null,Gr=null,Xr=!0;var i=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",Mr);if(kr=-1!=i?Dr[i]:null,Is){var a=document.getElementById("commentTextElement"+t);if(a&&(a.value="",null!==kr)){var n=kr.comment;if(null!==n&&Z.Utils.stringValidate(n)){var l=n;a.value=l}}}if(null!==Z.editMode){var o=document.getElementById("labelNameTextElement"+t);o&&(o.value=null!==kr?kr.name:"");var r=document.getElementById("captionTextElement"+t);if(r&&(r.value="",null!==kr)){var s=kr.captionHTML;r.value="undefined"!=typeof s&&Z.Utils.stringValidate(s)?s:kr.caption}if("markup"!=Z.editMode){var u=document.getElementById("labelIconList"+t),d=document.getElementById("tooltipTextElement"+t),p=document.getElementById("clickURLTextElement"+t),c=document.getElementById("labelCaptionPositionList"+t),g=document.getElementById("labelTargetList"+t),m=document.getElementById("checkboxRollover"+t);if(u&&d&&p&&c&&g&&m&&(u.selectedIndex=0,d.value="",p.value="",c.selectedIndex=0,g.selectedIndex=0,m.checked=!1,null!==kr)){if("icon"==kr.mediaType){var h=kr.media,f=h.lastIndexOf("/")+1,T=h.lastIndexOf(".");if(-1!=f&&-1!=T){var b=h.substring(f,T).toLowerCase(),i=Z.Utils.arrayIndexOfObjectValueSubstring(u,"value",b,null,!0);-1!=i&&(u.selectedIndex=i)}}var E=kr.captionPosition;if(Z.Utils.stringValidate(E)){var i=Z.Utils.arrayIndexOfObjectValue(c,"value",E);-1!=i&&(c.selectedIndex=i)}var v=kr.tooltipHTML;d.value="undefined"!=typeof v&&Z.Utils.stringValidate(v)?v:kr.tooltip;var I=kr.clickURL;Z.Utils.stringValidate(I)&&(p.value=I);var y=kr.urlTarget;if(Z.Utils.stringValidate(y)){var i=Z.Utils.arrayIndexOfObjectValue(g,"value",y);-1!=i&&(g.selectedIndex=i)}m.checked=1==kr.rollover}}}Mr!=Hr&&Z.Viewer.getStatus("ready")&&Z.Utils.validateCallback("currentLabelChangedGetID"),Fr?Vi():Xt()}function Pi(e,t){for(var i=[],a=0,n=e.length;n>a;a++)e[a].poiID==t&&(i[i.length]=e[a]);return i}function Di(e,t,i,a,n,l){if(Z.useCanvas&&("polygon"==e.media||a)){if(e.visibility||e.rollover||i){var o=e.internalID;if("undefined"!=typeof e.polygonPts&&null!==e.polygonPts&&e.polygonPts.length>0||a){var r;r=a?cn:"view"!=Z.labelMode&&o===Mr||n?n?sCtx:sn:nn,r.save();var s=l?Z.imageW/2:Z.imageX,u=l?Z.imageH/2:Z.imageY;r.translate((e.x-s)*Z.imageZ,(e.y-u)*Z.imageZ);var d=On/Rn,p=Zn.getZoom(),c=(e.xScale+e.yScale)/2/100,g=e.xScale/100/d*p,m=e.yScale/100/d*p;1!=g&&1!=m&&r.scale(g,m),a?r.lineWidth=1e-6:"freehand"==e.mediaType?r.lineWidth=is/p:(r.lineWidth=e.lineVisible?Kr/p/c:0,r.fillStyle=e.fillColor),r.strokeStyle=e.lineColor;var h=e.x,f=e.y;if(r.beginPath(),e.polygonPts){var T=e.polygonPts.slice(0);"measure"!=Z.labelMode||e.polyClosed||Xr||"undefined"==typeof t||null===t||(T[T.length]={x:t.x,y:t.y});var b=T[0].x-h,E=T[0].y-f;r.moveTo(b,E);for(var v=1,I=T.length;I>v;v++){var y=T[v].x-h,U=T[v].y-f;r.lineTo(y,U)}"freehand"!=e.mediaType&&(e.polyClosed||Z.mouseIsDown&&0==Gr)&&(e.polyClosed&&(r.lineTo(b,E),r.closePath()),a||!e.fillVisible||!e.polyClosed&&o==Mr||(r.globalAlpha=jr,r.fill()),r.globalAlpha=1)}else{var S=e.iW*(100/e.z),A=e.iH*(100/e.z),h=0,f=-1==e.media.indexOf("triangle")?0:.23*e.iH,L=1.2,x=Math.max(S,A)/2*L;r.arc(h,f,x,0,2*Math.PI)}if(r.stroke(),!a&&(null===Z.editMode&&"measure"==Z.labelMode||"addLabel"==Z.editing||"editLabel"==Z.editing)&&("rectangle"==Z.labelMode&&4==T.length||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&e.internalID==Mr&&"undefined"!=typeof e&&null!==e&&"freehand"!=e.mediaType)for(var w=1/p/c,v=0,I=T.length;I>v;v++){var y=T[v].x-h,U=T[v].y-f;Ci(y,U,!Xr&&0==v,w)}r.restore()}if(n){var O=new Kt;drawCaptionOnCanvas(e,O,t,null,null,!0,l)}else!Z.mouseIsDown||a&&"polygon"!=e.media||null===o||"undefined"==typeof t||Fr||Bi(o,t,n,l)}n&&validateDrawLabelCount()}else zr||(Z.Utils.showMessage(Z.Utils.getResource("ALERT_POLYGONSREQUIRECANVAS")),zr=!0)}function Ci(e,t,i,a){var n=ts*a;sn.lineWidth=Qr*a,sn.strokeStyle=Jr,sn.fillStyle=i?$r:es,sn.beginPath(),sn.arc(e,t,n,0,2*Math.PI,!1),sn.closePath(),sn.globalAlpha=.5,sn.fill(),sn.globalAlpha=1,sn.stroke()}function Ni(e,t,i){Z.Utils.clearDisplay(on);var a=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",Mr);if(-1!=a){var n=Dr[a];Di(n);var l=Zn.getZoom(),o=n.polygonPts;if(o){var r=o[o.length-1],s=(r.x-Z.imageX)*l,u=(r.y-Z.imageY)*l;n.polyClosed||(sn.lineWidth=Kr,sn.strokeStyle=lineStrokeColor,sn.beginPath(),sn.moveTo(s,u),sn.lineTo(e,t),sn.closePath(),sn.stroke())}"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||null===Mr||Bi(Mr,i)}}function Vi(e){if(tn&&Z.Utils.clearDisplay(tn),on&&Z.Utils.clearDisplay(on),"inline-block"==Qa.display)for(var t=new Kt,i=0,a=Dr.length;a>i;i++){var n=Dr[i];if("polygon"==n.media&&n.visibility&&(e||"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||"undefined"==typeof Mr||null===Mr||Mr!==i)){var l=n.x,o=n.y;(!Z.hotspotsDrawOnlyInView||l+qr>t.box.l&&l-qr<t.box.r&&o+qr>t.box.t&&o-qr<t.box.b)&&Di(n,null,e)}}}function ki(e,t,i){Wr=!0,Z.Utils.clearDisplay(on);var a=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",e);if(-1!=a){var n=Dr[a];n.polygonPts[t]=i,Di(n,i)}}function Mi(e,t,i){var e=Z.Utils.event(e),a=e?Z.Utils.isRightMouseButton(e):null,n=e?e.altKey:null;if("undefined"==typeof Mr||null===Mr)Fi(null,!0,t);else{var l=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",Mr);if(-1!=l){var o=Dr[l];Br=o.polygonPts;var r=o.polyClosed;null===Br?(Fi(Mr,!0,t),Bi(Mr,t)):(Gr=_i(e,t),r?null===Gr&&Fi(null,!0,t):null===Gr?n||a||i?(Fi(Mr,!1,t),Hi(Mr,!1)):Fi(Mr,!1,t):0==Gr&&Br.length>2&&!Xr&&Hi(Mr,!0))}}(!n||"measure"==Z.labelMode&&null!==Mr)&&Bi(Mr,t)}function Fi(e,t,i){var a,n=!1,l=!1;if("undefined"!=typeof e&&null!==e&&(null!==Z.editing&&"addLabel"!=Z.editing||!Xr||"polygon"!=Z.labelMode&&"measure"!=Z.labelMode)){var o=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",e);if(-1!=o){var a=Dr[o],r=a.polygonPts?a.polygonPts:[];r[r.length]={x:i.x,y:i.y},a.polyClosed=!1,a.polygonPts=r,a.saved=!1}}else{null===Z.editMode&&"measure"==Z.labelMode&&Dr.length>0&&Zn.deleteAllMeasureHotspots();var s="freehand"==Z.labelMode||"rectangle"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode?Z.labelMode:null,u="8",d=[];d[0]={x:i.x,y:i.y};var p="undefined"!=typeof Ts&&Ts.options.length>0?p=Ts.options[Ts.selectedIndex].value:1,c=(100*Zn.getZoom()).toString();Zn.createHotspotFromParameters(null,null,s,"polygon",null,i.x.toString(),i.y.toString(),c,null,null,null,null,null,null,null,as,null,lineStrokeColor,null,null,null,null,null,u,"0",null,p,null,null,"0",d);var a=Dr[Dr.length-1];Mr=a.internalID,mi(a,a.poiID),l=!0,n=!0}if(("rectangle"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&"undefined"!=typeof a&&null!==a&&"freehand"!=a.mediaType){var g=Zn.getZoom(),m=(i.x-Z.imageX)*g,h=(i.y-Z.imageY)*g;Ci(m,h,n,1)}"rectangle"!=Z.labelMode&&"freehand"!=Z.labelMode&&(Xr=!1),l?Xt():t&&Vi()}function _i(e,t){for(var i=null,a=(ts+1)/Z.imageZ,n=0,l=Dr.length;l>n;n++)if("polygon"==Dr[n].media&&Dr[n].internalID==Mr){var o=Dr[n].polygonPts;if("undefined"!=typeof o&&null!==o)for(var r=0,s=o.length;s>r;r++)Z.Utils.calculatePointsDistance(t.x,t.y,o[r].x,o[r].y)<a&&(i=r)}return i}function Hi(e,t){Z.Utils.clearDisplay(on);var i=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",e);if(Dr[i].polyClosed=t,Xr=!0,-1!=i){var a=Dr[i],n=Z.Utils.polygonCenter(a.polygonPts,a.polyClosed);if(a.x=n.x,a.y=n.y,"freehand"!=Z.labelMode&&""==a.caption&&"undefined"==typeof a.captionHTML){var l=Z.Utils.getResource("CONTENT_POLYGONCAPTION");a.caption=l+e.toString()}var o=new Kt;Wt(a,o)}}function Bi(e,t){var i=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",e);if(-1!=i){var a=Dr[i];if("measure"==Z.labelMode&&"measure"==a.mediaType)ai(a,t);else if("freehand"!=Z.labelMode&&"freehand"!=a.mediaType&&""==a.caption&&"undefined"==typeof a.captionHTML){var n=Z.Utils.getResource("CONTENT_POLYGONCAPTION");a.caption=n+e.toString()}var l=a.polyClosed,o=a.polygonPts?a.polygonPts.slice(0):[],r=Z.Utils.polygonCenter(o,l,t),s=Z.Utils.polygonDimensions(o,t);a.x=r.x,a.y=r.y,a.iW=s.x,a.iH=s.y;var u=new Kt;Yt(a,u,t,!0)}}function zi(e){var t;this.id=e.getAttribute("ID"),this.name=e.getAttribute("NAME"),this.internalID=e.getAttribute("INTERNALID"),isNaN(parseInt(this.internalID,10))&&(this.internalID=Ti("slide")),this.media=e.getAttribute("MEDIA"),this.audio=e.getAttribute("AUDIO"),Z.Utils.stringValidate(this.audio)&&(Z.audioContent=!0),this.initialX=e.getAttribute("INITIALX"),this.initialY=e.getAttribute("INITIALY"),this.initialZoom=e.getAttribute("INITIALZOOM"),this.minZoom=e.getAttribute("MINZOOM"),this.maxZoom=e.getAttribute("MAXZOOM"),t=parseFloat(e.getAttribute("SHOWFOR")),this.showFor=isNaN(t)?0:t,this.transition=e.getAttribute("TRANSITION"),t=parseFloat(e.getAttribute("CHANGEFOR")),this.changeFor=isNaN(t)?0:t}function Xi(e,t,i){var a="0"==e?"hidden":"visible",n=parseInt(Z.Utils.getResource("DEFAULT_SLIDELISTWIDTH"),10),l=Gi(e,n,Kn,jn);if("undefined"==typeof Ur||null===Ur){Ur=new Z.Utils.createSelectElement("slideList",t,i,n,l.x,l.y,null,a,Wi,"change"),Z.ViewerDisplay.appendChild(Ur),yr=0;var o=Z.Utils.stringValidate(Z.slideListTitle)&&"none"!=Z.slideListTitle?1:0;Ur.selectedIndex=o}else Z.Utils.arrayClear(i)}function Gi(e,t,i,a){var n,l,o=25;switch(e){case"0":n=0,l=0;break;case"1":n=o,l=o;break;case"2":n=i-t-o,l=20;break;case"3":n=i-t-o,l=null!=toolbar?a-2*o:a-1.5*o;break;case"4":n=o,l=null!=toolbar?a-2*o:a-1.5*o;break;default:n=i-t,l=o}return new Z.Utils.Point(n,l)}function Wi(e){var e=Z.Utils.event(e);if(e){Z.slideshowPlaying&&Zn.slideshowStop();var t=Z.Utils.target(e);if("null"!=t.options[t.selectedIndex].value){var i=Z.Utils.stringValidate(Z.slideListTitle)&&"none"!=Z.slideListTitle?1:0;Zn.goToSlide(t.selectedIndex-i,null,!0)}}}function Yi(e){if("undefined"!=typeof Ur&&null!==Ur&&Ur.length>0){var t=Z.slideshowPlaying?wr[yr].showFor:0;Z.Utils.stringValidate(wr[yr].audio)&&(t+=500);var i=ji(yr,e,wr.length-1);null!==i?Z.Utils.functionCallWithDelay(function(){Zn.goToSlide(i,null,null,!0)},t):Zn.slideshowStop()}}function Ki(e){temp=e.initialX;var t=Z.Utils.stringValidate(temp)?"center"==temp?"zInitialX="+(Z.imageW/2).toString():isNaN(parseFloat(temp))?null:"zInitialX="+temp:null;temp=e.initialY;var i=Z.Utils.stringValidate(temp)?"center"==temp?"zInitialY="+(Z.imageH/2).toString():isNaN(parseFloat(temp))?null:"zInitialY="+temp:null;temp=e.initialZoom;var a=Z.Utils.stringValidate(temp)?isNaN(parseFloat(temp))?null:"zInitialZoom="+temp:null;
temp=e.minZoom;var n=Z.Utils.stringValidate(temp)?isNaN(parseFloat(temp))?null:"zMinZoom="+temp:null;temp=e.maxZoom;var l=Z.Utils.stringValidate(temp)?isNaN(parseFloat(temp))?null:"zMaxZoom="+temp:null,o=null!==t?t:null;return o=null!==i?null!==o?o+"&"+i:i:null,o=null!==a?null!==o?o+"&"+a:a:null,o=null!==n?null!==o?o+"&"+n:n:null,o=null!==l?null!==o?o+"&"+l:l:null}function ji(e,t,i){for(var a=Ir||xr,n="Skip";"Skip"==n;)"next"==t?(e+=1,e>i&&(e=a?0:null)):(e-=1,0>e&&(e=a?i:null)),n=Dr?null!==e?Dr[e].transition:null:wr&&null!==e?wr[e].transition:null;return e}function qi(e){Z.preventDupCall||(Z.priorX=Z.imageX,Z.priorY=Z.imageY,Z.priorZ=Z.imageZ,Z.priorR=Math.round(Z.imageR)),Z.preventDupCall="undefined"!=typeof e&&null!==e}function Qi(e,t,i,a,n,l){l||Zn.zoomAndPanAllStop(),Z.maskingSelection&&Z.maskClearOnUserAction&&Zn.clearMask(),("undefined"==typeof e||null===e)&&(e=Z.imageW/2),("undefined"==typeof t||null===t)&&(t=Z.imageH/2),"undefined"==typeof i||null===i?i=Z.fitZ:i>1&&(i/=100),("undefined"==typeof a||null===a)&&(a=Z.imageR),i=Zt(i),a=gt(a);var o=ct(e,t,i,a,"image");Z.imageX=ya=o.x,Z.imageY=Ua=o.y,Z.imageZ=i,a!=Z.imageR&&Z.Utils.rotateElement(Da,a),Z.imageR=a,Zn.updateView(!0),"function"==typeof n&&n()}function Ji(){Ho&&(0!=Eo||0!=vo||0!=_o)&&($i(Eo,vo,_o),Ho=window.setTimeout(Ji,zo))}function $i(e,t,i){var a=!1,n=!1,l=!1,o=Zn.getZoom();if(0!=i){var r=On*(1+i),s=dt(Nn,r);o=Zt(s),o!=Z.imageZ&&(n=l=aa(o))}if(0!=e||0!=t){var u=parseFloat(Da.left)+e,d=parseFloat(Da.top)+t,p=ct(u,d,o,Z.imageR,"container");Da.left=Math.round(p.x)+"px",Da.top=Math.round(p.y)+"px",a=!0,l=!0;var c=p.x-il,g=p.y-nl;xa&&kn&&(Z.mobileDevice||Math.abs(c)>Kn/2||Math.abs(g)>jn/2)&&O(xa,Mn,Zl,"simple",!1,"Updating backfill oversize display")}var m=Dr&&Dr.length>30;m?Bo%2==0&&Zn.syncViewportRelated():Zn.syncViewportRelated(),Bo++}function ea(e,t,i,a,n,l,o){jo++;var r=n/l,s=jo*r,u=Z.Utils.easing(Z.imageX,e,s,n),d=Z.Utils.easing(Z.imageY,t,s,n),p=Z.Utils.easing(Z.imageZ,i,s,n),c=Z.Utils.easing(Z.imageR,a,s,n),g=ut(u,d,p),m=g.x,h=g.y,f=!1,T=syncOversize=!1;if((parseFloat(Da.left)!=m||parseFloat(Da.top)!=h)&&(Da.left=m+"px",Da.top=h+"px",T=!0,xa&&kn&&(syncOversize=!0)),p!=Z.imageZ&&(aa(p,!1),f=T=!0,xa&&kn&&(Oa.restore(),Oa.save(),Oa.scale(Dn,Dn),syncOversize=!0)),c!=Z.imageR){if(Z.Utils.rotateElement(Da,c),xa&&kn){var b=c-Z.imageR;Oa.rotate(b*Math.PI/180),syncOversize=!0}Z.imageR=c,T=!0}syncOversize&&O(xa,Mn,Zl,"simple",!1,"Updating backfill oversize display");var E=Dr&&Dr.length<40;Zn.syncViewportRelated(!1,E,!1,!1,!1),jo%2==0&&Zn.syncViewportRelated(!1,!1,f,T,f);var v=Z.tour&&Z.tourStop&&0==Math.round(Z.imageR%90);l+1>jo&&!v?Ko=window.setTimeout(function(){ea(e,t,i,a,n,l,o)},r):(v&&(Z.tourPlaying=!1),Z.interactivityOff=!1,ia(),Zn.updateView(),Zn.toggleWatermarks(!0),Dr&&Dr.length>39&&Zn.setHotspotsVisibility(!0),"function"==typeof o&&o())}function ta(){Eo=0,vo=0,_o=0,Bo=0,Ho&&(window.clearTimeout(Ho),Ho=null)}function ia(){Ko&&(window.clearTimeout(Ko),Ko=null)}function aa(e,t){var i=!1,a=pt(Nn,e);if(a!=On){On=a;var n=a/Rn,l=Jn*n,o=$n*n,r=(Jn-l)/2,s=($n-o)/2;if(Rn>a){var u=ct(parseFloat(Da.left),parseFloat(Da.top),e,Z.imageR,"container");Da.left=u.x+"px",Da.top=u.y+"px"}if(Z.useCanvas){_a.width=l+"px",_a.height=o+"px",_a.left=r+"px",_a.top=s+"px",dn&&(pn.width=l+"px",pn.height=o+"px",pn.left=r+"px",pn.top=s+"px"),tn&&(an.width=l+"px",an.height=o+"px",an.left=r+"px",an.top=s+"px"),on&&(rn.width=l+"px",rn.height=o+"px",rn.left=r+"px",rn.top=s+"px"),Dn=pt(Mn,Zn.getZoom());var d=Dn>8;if(kn||d){(null!==Oa&&"undefined"==typeof t||null===t||t&&xa&&("in"!=Z.zooming||l>Z.scaleThreshold||o>Z.scaleThreshold))&&(Oa.restore(),Oa.save(),Oa.scale(Dn,Dn),Oa.rotate(Z.imageR*Math.PI/180),O(xa,Mn,Zl,"simple",!1,"Updating backfill oversize display"));var p=pt(Vn,e);Pn=p;var c=p/tierBackfillScalePrior,g=ol*c,m=rl*c,h=dl+(ol-g)/2,f=pl+(rl-m)/2;Va.width=g+"px",Va.height=m+"px",Va.left=h+"px",Va.top=f+"px"}else xa&&Z.Utils.clearDisplay(xa),l=ol*n,o=rl*n,r=dl+Z.imageX*(1-n)*Z.imageZ,s=pl+Z.imageY*(1-n)*Z.imageZ,Va.width=l+"px",Va.height=o+"px",Va.left=r+"px",Va.top=s+"px"}else{if(O(Fa,Nn,Nl,"centerOut",!1,"Scaling: non-canvas zoom"),kn){var T=ro;ol=Jn*T,rl=$n*T,dl=-(Jn/T),pl=-($n/T),sl=el*T,ul=tl*T,Na.width=ol,Na.height=rl,Va.width=Na.width+"px",Va.height=Na.height+"px",Va.left=dl+"px",Va.top=pl+"px"}else{var b=_n[Vn],E=Hn[Vn];Na.width=b,Na.height=E;var v=Z.imageX*e,I=Z.imageY*e;dl=el-v,pl=tl-I,Va.left=dl+"px",Va.top=pl+"px"}O(Na,Vn,Zl,"simple",!1,"Scaling: non-canvas zoom - backfill")}i=!0}return i}function na(e){var t=document.getElementById("buttonFullView"),i=document.getElementById("buttonFullViewExit");t&&i&&(t.style.display=e?"none":"inline-block",i.style.display=e?"inline-block":"none")}function la(e){e?(nr||oa(),nr.elmt.style.display="inline-block"):nr&&(nr.elmt.style.display="none")}function oa(){var e=Z.Utils.getResource("UI_FVCANCELBUTTONTEXT"),t=34,i=34,a=20,n=parseFloat(Z.viewerW)-(t+a),l=parseFloat(Z.viewerH)-(i+a),o=Z.Utils.getResource("DEFAULT_FULLVIEWEXITEXTERNALBUTTONCOLOR");nr=new Z.Utils.Button("buttonFullViewExitExternal",e,null,null,null,null,t+"px",i+"px",n+"px",l+"px","mousedown",ra,"TIP_TOGGLEFULLVIEWEXITEXTERNAL","solid","1px",o,"0px","0px"),Z.ViewerDisplay.appendChild(nr.elmt)}function ra(){Zn.toggleFullViewMode(!1)}function sa(){Z.Utils.addEventListener(Pa,"mousedown",ua),Z.Utils.addEventListener(Pa,"mousemove",Z.Utils.preventDefault),Z.Utils.addEventListener(Pa,"touchstart",ua),Z.Utils.addEventListener(Pa,"touchmove",ua),Z.Utils.addEventListener(Pa,"touchend",ua),Z.Utils.addEventListener(Pa,"touchcancel",ua),Z.Utils.addEventListener(Pa,"gesturestart",ua),Z.Utils.addEventListener(Pa,"gesturechange",ua),Z.Utils.addEventListener(Pa,"gestureend",ua),Z.Utils.addEventListener(Na,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(Fa,"contextmenu",Z.Utils.preventDefault),Ya&&Z.Utils.addEventListener(Ya,"contextmenu",Z.Utils.preventDefault),qa&&Z.Utils.addEventListener(qa,"contextmenu",Z.Utils.preventDefault)}function ua(e){var e=Z.Utils.event(e),t=e.type;if(e&&t){var i=!Xr&&("polygon"==Z.labelMode||"measure"==Z.labelMode),a=Z.Utils.isRightMouseButton(e),n=e.altKey,l=a&&!i;if("mouseover"!=t&&"mouseout"!=t&&Z.interactivityOff||"mousedown"==t&&(Z.interactivityOff||Z.coordinatesVisible&&n)||l)return void(Z.tourStop=!0);if(("mousedown"==t||"touchstart"==t||Z.tourPlaying&&Z.tourStop)&&(Zn.zoomAndPanAllStop(),Zn.tourStop(),Z.tourStop=!0,Z.interactivityOff=!1),Z.touchSupport&&!Z.clickZoomAndPanBlock&&"touchmove"!=t&&"gesturechange"!=t&&e.preventDefault(),"mousedown"==t){{window.setTimeout(function(){Zn.zoomAndPanAllStop(!1,!0)},1)}Z.maskingSelection&&Z.maskClearOnUserAction&&Zn.clearMask()}else if("touchstart"==t||"gesturestart"==t){var o=!1;if(touch=Z.Utils.getFirstTouch(e),"undefined"!=typeof touch){target=touch.target;var r=jt(target);if(null===r)o=!0;else{var s=r.id.substring(3,r.id.length),u=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",s);if(-1!=u){var d=Dr[u];null!==d&&"function"==d.clickURL&&(o=!0)}}}o&&e.preventDefault(),Zn.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&Zn.clearMask()}switch(t){case"mouseover":Z.fullView||"TEXTAREA"==document.activeElement.tagName||Z.Viewer.initializeViewerKeyDefaultListeners(!0);break;case"mousedown":!Z.fullView&&document.activeElement&&document.activeElement.blur(),Z.Viewer.initializeViewerKeyEventListeners(!0),Z.Utils.addEventListener(document,"mousemove",ua),Z.Utils.addEventListener(document,"mouseup",ua);break;case"mouseup":Z.Utils.removeEventListener(document,"mousemove",ua),Z.Utils.removeEventListener(document,"mouseup",ua)}if(da(e),"mousedown"==t||"mousemove"==t)return!1}}function da(e){var e=(Sa.toString(),Z.Utils.event(e)),t=e.type;if(e&&t){var i,a,n,l;if("touchstart"==t||"touchmove"==t||"touchend"==t||"touchcancel"==t)i=Z.Utils.getFirstTouch(e),"undefined"!=typeof i&&(a=i.target,l=new Z.Utils.Point(i.pageX,i.pageY));else{a=Z.Utils.target(e),n=Z.Utils.relatedTarget(e);var o=Z.Utils.isRightMouseButton(e),r=e.altKey;"resize"!=t&&(l=Z.Utils.getMousePosition(e)),Z.smoothPan&&(Vo=l)}"DOMMouseScroll"==t&&(t="mousewheel");{var s,u=Zn.getZoom();(100*u).toString()}switch("undefined"!=typeof l&&null!==l&&(s=Zn.getClickCoordsInImage(e,u,l)),t){case"mousedown":if(Z.mouseIsDown=!0,co=new Z.Utils.Point(l.x,l.y),Pa.mouseXPrior=l.x,Pa.mouseYPrior=l.y,(("rectangle"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&null!==Mr||"rectangle"==Z.labelMode&&null===Mr)&&(Gr=_i(e,s)),r||"view"==Z.labelMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing&&(null!==Z.editMode||"measure"!=Z.labelMode))Z.smoothPan&&!r&&Z.mousePan&&pa();else{Z.Utils.hideMessage(),"addLabel"==Z.editing&&("freehand"==Z.labelMode||"rectangle"==Z.labelMode&&null===Gr)&&Zn.saveEditsLabel(!0,!1,!1);var d=!1;d&&!Z.annotationsAddMultiple&&(Z.editing="editLabel")}break;case"mousemove":Zo=new Z.Utils.Point(l.x,l.y);var p=(s.x-Z.imageX)*u,c=(s.y-Z.imageY)*u;if(go&&(clearTimeout(go),go=null,Mi(e,s,D)),r||(null!==Z.editMode||"measure"!=Z.labelMode)&&("view"==Z.labelMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing)){if(!r&&Z.mousePan)if(Do)Vo=l;else if(Z.animation&&Zn.getZoom()==Z.minZ)l.x>Pa.mouseXPrior?Z.Viewer.viewportNext():l.x<Pa.mouseXPrior&&Z.Viewer.viewportPrior(),Pa.mouseXPrior=l.x,Pa.mouseYPrior=l.y;else{var g=l.x-Pa.mouseXPrior,m=l.y-Pa.mouseYPrior;if(!isNaN(g)&&!isNaN(m)){var h=parseFloat(Da.left)+g,f=parseFloat(Da.top)+m,T=ct(h,f,Z.imageZ,Z.imageR,"container");Da.left=T.x+"px",Da.top=T.y+"px",Pa.mouseXPrior=l.x,Pa.mouseYPrior=l.y;var g=T.x-il,m=T.y-nl;if(xa&&kn&&(Z.mobileDevice||Math.abs(g)>Kn/2||Math.abs(m)>jn/2)&&O(xa,Mn,Zl,"simple",!1,"Updating backfill oversize display"),Z.Navigator){var b=Zn.calculateCurrentCenterCoordinates(T,Z.imageZ,Z.imageR);Z.Navigator.syncNavigatorRectangleToViewport(b)}}}}else{var E=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",Mr),v=-1!=E?Dr[E].polyClosed:!1;"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||null===Gr||!Z.mouseIsDown?"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||v||Z.mouseIsDown&&(!Z.mouseIsDown||null===Gr)||Ni(p,c,s):ki(Mr,Gr,s)}break;case"mouseup":Z.mouseIsDown=!1,document.mousemove=null,document.mouseup=null;var I;Z.mouseOutDownPoint?(I=Z.mouseOutDownPoint,s=Zn.getClickCoordsInImage(e,u,Z.mouseOutDownPoint)):I=new Z.Utils.Point(l.x,l.y);var y=Z.Utils.calculatePointsDistance(co.x,co.y,I.x,I.y);if(4>y||!r&&("freehand"==Z.labelMode||"rectangle"==Z.labelMode))if(Fr||(null!==Z.editMode||"measure"!=Z.labelMode)&&("view"==Z.labelMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing)){if((null===Z.editing||"view"==Z.labelMode)&&!Fr){var U=null;if(Z.labelClickSelect&&(U=jt(a)),null!==U){var S=U.id.substring(3,U.id.length),A=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",S);if(-1!=A){var L=Dr[A];xi(L.poiID,L.internalID),Zn.zoomAndPanToView(L.x,L.y,L.z/100,L.rotation)}ps&&(Z.hotspotListTitle||Z.tourListTitle)&&(ps.selectedIndex=0)}else{if(Z.clickZoom||Z.clickPan)var x=go&&Z.doubleClickZoom?!0:!1,w=Zn.getClickZoomCoords3D(e,co,Nn,On,x);if(Z.clickZoom)if(Z.doubleClickZoom)go?(clearTimeout(go),go=null,Zn.zoomAndPanToView(w.x,w.y,w.z)):go=setTimeout(function(){go=null,Zn.zoomAndPanToView(w.x,w.y,w.z)},Z.doubleClickDelay);else{window.setTimeout(function(){Zn.zoomAndPanToView(w.x,w.y,w.z)},1)}else Z.clickPan&&Zn.zoomAndPanToView(w.x,w.y,Z.imageZ)}}}else if("addLabel"!=Z.editing||r||!Xr||"text"!=Z.labelMode&&"icon"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||Zn.saveEditsLabel(!0,!1,!1),r&&Xr&&!o||"freehand"!=Z.labelMode&&"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode){if(!r){var R="undefined"!=typeof Ts&&Ts.options.length>0?R=Ts.options[Ts.selectedIndex].value:0,d=!1;if(d){var P=Ls[Ls.length-1];Oi(P.poiID,P.value),Z.annotationsAddMultiple||(Z.editing="editLabel")}}}else if(r||o)Mi(e,s),Xr||Z.Utils.addEventListener(document,"mousemove",ua);else{Z.Utils.addEventListener(document,"mousemove",ua);var D=!1;go?(D=!0,clearTimeout(go),go=null,Mi(e,s,D),Z.Utils.removeEventListener(document,"mousemove",ua)):(go=setTimeout(function(e){go=null,Mi(e,s,D)},Z.doubleClickDelay),"polygon"!=Z.labelMode&&"measure"!=Z.labelMode&&Z.Utils.removeEventListener(document,"mousemove",ua))}else{if(("rectangle"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&(Wr||null===Gr&&!Xr)){Gr=null,Wr=!1;var E=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",Mr);if(-1!=E){var L=Dr[E],C=Z.Utils.polygonCenter(L.polygonPts,L.polyClosed);L.x=C.x,L.y=C.y,Z.Utils.clearDisplay(on);var N=new Kt;Wt(L,N),Xr||Z.Utils.addEventListener(document,"mousemove",ua)}}Zo=null,Z.mousePan&&!Z.smoothPan&&Zn.updateView()}Z.mouseOutDownPoint&&(Z.ToolbarDisplay&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),Z.NavigatorDisplay&&Z.navigatorVisible>1&&Z.Navigator.setVisibility(!1),Z.Toolbar&&Z.annotations&&(2==Z.annotationPanelVisible||3==Z.annotationPanelVisible)&&Z.Toolbar.setVisibilityAnnotationPanel(!1));break;case"touchstart":i&&!mo&&(Z.mouseIsDown=!0,fo=!1,co=new Z.Utils.Point(l.x,l.y),Pa.mouseXPrior=l.x,Pa.mouseYPrior=l.y,(("rectangle"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&null!==Mr||"rectangle"==Z.labelMode&&null===Mr)&&(Gr=_i(e,s)),r||"view"==Z.labelMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing&&(null!==Z.editMode||"measure"!=Z.labelMode)||Z.Utils.hideMessage());break;case"touchmove":if(i&&!mo&&!fo){Zo=new Z.Utils.Point(l.x,l.y);var p=(s.x-Z.imageX)*u,c=(s.y-Z.imageY)*u;if(go&&(clearTimeout(go),go=null,Mi(e,s,D)),r||(null!==Z.editMode||"measure"!=Z.labelMode)&&("view"==Z.labelMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing)){if(!r&&Z.mousePan)if(Do)Vo=l;else{var g=l.x-Pa.mouseXPrior,m=l.y-Pa.mouseYPrior;if(!isNaN(g)&&!isNaN(m)){var h=parseFloat(Da.left)+g,f=parseFloat(Da.top)+m,T=ct(h,f,Z.imageZ,Z.imageR,"container");Da.left=T.x+"px",Da.top=T.y+"px",Pa.mouseXPrior=l.x,Pa.mouseYPrior=l.y;var g=T.x-il,m=T.y-nl;if(xa&&kn&&(Z.mobileDevice||Math.abs(g)>Kn/2||Math.abs(m)>jn/2)&&O(xa,Mn,Zl,"simple",!1,"Updating backfill oversize display"),Z.Navigator){var b=Zn.calculateCurrentCenterCoordinates(T,Z.imageZ,Z.imageR);Z.Navigator.syncNavigatorRectangleToViewport(b)}}}}else{var E=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",Mr),v=-1!=E?Dr[E].polyClosed:!1;"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||null===Gr||!Z.mouseIsDown?"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||v||Z.mouseIsDown&&(!Z.mouseIsDown||null===Gr)||Ni(p,c,s):ki(Mr,Gr,s)}}break;case"touchend":if(!mo&&!fo){Z.mouseIsDown=!1,document.mousemove=null,document.mouseup=null;var I;Z.mouseOutDownPoint?(I=Z.mouseOutDownPoint,s=Zn.getClickCoordsInImage(e,u,Z.mouseOutDownPoint)):I="undefined"!=typeof l&&null!==l?new Z.Utils.Point(l.x,l.y):"undefined"!=typeof Zo&&null!==Zo?Zo:co;var y=Z.Utils.calculatePointsDistance(co.x,co.y,I.x,I.y);if(4>y||!r&&("rectangle"==Z.labelMode||"freehand"==Z.labelMode))if(Fr||(null!==Z.editMode||"measure"!=Z.labelMode)&&("view"==Z.labelMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing)){if((null===Z.editing||"view"==Z.labelMode)&&!Fr)if(Z.clickZoom){var x=go&&Z.doubleClickZoom?!0:!1,w=Zn.getClickZoomCoords3D(e,co,Nn,On,x);if(Z.doubleClickZoom)go?(clearTimeout(go),go=null,Zn.zoomAndPanToView(w.x,w.y,w.z)):go=setTimeout(function(){go=null,Zn.zoomAndPanToView(w.x,w.y,w.z)},Z.doubleClickDelay);else{window.setTimeout(function(){Zn.zoomAndPanToView(w.x,w.y,w.z)},1)}}else Z.clickPan&&Zn.zoomAndPanToView(w.x,w.y,Z.imageZ)}else if("addLabel"!=Z.editing||r||!Xr||"text"!=Z.labelMode&&"icon"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||Zn.saveEditsLabel(!0,!1,!1),r&&Xr||"freehand"!=Z.labelMode&&"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode){if(!r){var R="undefined"!=typeof Ts&&Ts.options.length>0?R=Ts.options[Ts.selectedIndex].value:0,d=!1;if(d){var P=Ls[Ls.length-1];Oi(P.poiID,P.value)}}}else if(r||o)Mi(e,s),Xr||Z.Utils.addEventListener(document,"mousemove",viewerEventsHandler);else{Z.Utils.addEventListener(document,"touchmove",ua);var D=!1;go?(D=!0,clearTimeout(go),go=null,Mi(e,s,D),Z.Utils.removeEventListener(document,"touchmove",ua)):(go=setTimeout(function(e){go=null,Mi(e,s,D)},Z.doubleClickDelay),"polygon"!=Z.labelMode&&"measure"!=Z.labelMode&&Z.Utils.removeEventListener(document,"touchmove",ua))}else{if(("rectangle"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&(Wr||null===Gr&&!Xr)){Gr=null,Wr=!1;var E=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",Mr);if(-1!=E){var L=Dr[E],C=Z.Utils.polygonCenter(L.polygonPts,L.polyClosed);L.x=C.x,L.y=C.y,Z.Utils.clearDisplay(on);var N=new Kt;Wt(L,N),Xr||Z.Utils.addEventListener(document,"touchmove",ua)}}Zo=null,Z.mousePan&&!Do&&Zn.updateView()}Z.mouseOutDownPoint&&(Z.ToolbarDisplay&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),Z.NavigatorDisplay&&Z.navigatorVisible>1&&Z.Navigator.setVisibility(!1),Z.Toolbar&&Z.annotations&&(2==Z.annotationPanelVisible||3==Z.annotationPanelVisible)&&Z.Toolbar.setVisibilityAnnotationPanel(!1))}break;case"touchcancel":if(!mo&&!fo){Z.mouseIsDown=!1,document.mousemove=null,document.mouseup=null;var I;Z.mouseOutDownPoint?(I=Z.mouseOutDownPoint,s=Zn.getClickCoordsInImage(e,u,Z.mouseOutDownPoint)):I="undefined"!=typeof l&&null!==l?new Z.Utils.Point(l.x,l.y):"undefined"!=typeof Zo&&null!==Zo?Zo:co;var y=Z.Utils.calculatePointsDistance(co.x,co.y,I.x,I.y);if(4>y||!r&&("rectangle"==Z.labelMode||"freehand"==Z.labelMode))if(Fr||(null!==Z.editMode||"measure"!=Z.labelMode)&&("view"==Z.labelMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing)){if((null===Z.editing||"view"==Z.labelMode)&&!Fr)if(Z.clickZoom){var x=go&&Z.doubleClickZoom?!0:!1,w=Zn.getClickZoomCoords3D(e,co,Nn,On,x);if(Z.doubleClickZoom)go?(clearTimeout(go),go=null,Zn.zoomAndPanToView(w.x,w.y,w.z)):go=setTimeout(function(){go=null,Zn.zoomAndPanToView(w.x,w.y,w.z)},Z.doubleClickDelay);else{window.setTimeout(function(){Zn.zoomAndPanToView(w.x,w.y,w.z)},1)}}else Z.clickPan&&Zn.zoomAndPanToView(w.x,w.y,Z.imageZ)}else if("addLabel"!=Z.editing||r||!Xr||"text"!=Z.labelMode&&"icon"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||Zn.saveEditsLabel(!0,!1,!1),r&&Xr||"freehand"!=Z.labelMode&&"rectangle"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode){if(!r){var R="undefined"!=typeof Ts&&Ts.options.length>0?R=Ts.options[Ts.selectedIndex].value:0,d=!1;if(d){var P=Ls[Ls.length-1];Oi(P.poiID,P.value)}}}else if(r||o)Mi(e,s),Xr||Z.Utils.addEventListener(document,"mousemove",viewerEventsHandler);else{Z.Utils.addEventListener(document,"touchmove",ua);var D=!1;go?(D=!0,clearTimeout(go),go=null,Mi(e,s,D),Z.Utils.removeEventListener(document,"touchmove",ua)):(go=setTimeout(function(e){go=null,Mi(e,s,D)},Z.doubleClickDelay),"polygon"!=Z.labelMode&&"measure"!=Z.labelMode&&Z.Utils.removeEventListener(document,"touchmove",ua))}else{if(("rectangle"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&(Wr||null===Gr&&!Xr)){Gr=null,Wr=!1;var E=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",Mr);if(-1!=E){var L=Dr[E],C=Z.Utils.polygonCenter(L.polygonPts,L.polyClosed);L.x=C.x,L.y=C.y,Z.Utils.clearDisplay(on);var N=new Kt;Wt(L,N),Xr||Z.Utils.addEventListener(document,"touchmove",ua)}}Zo=null,Z.mousePan&&!Do&&Zn.updateView()}Z.mouseOutDownPoint&&(Z.ToolbarDisplay&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),Z.NavigatorDisplay&&Z.navigatorVisible>1&&Z.Navigator.setVisibility(!1),Z.Toolbar&&Z.annotations&&(2==Z.annotationPanelVisible||3==Z.annotationPanelVisible)&&Z.Toolbar.setVisibilityAnnotationPanel(!1))}break;case"gesturestart":ha(e),mo||(mo=window.setInterval(fa,To));break;case"gesturechange":ho=Math.round(100*e.scale)/100;break;case"gestureend":mo&&(window.clearInterval(mo),fo=!0,mo=null),Z.mousePan&&Zn.updateView()}}}function pa(e){Z.smoothPanEasing>1&&(ca(e),Co=co,null===No&&(No=new Z.Utils.Point(parseFloat(Da.left),parseFloat(Da.top))),(null===Do||e)&&(Do=window.setInterval(Za,50)))}function ca(e){null!==Do&&e&&(window.clearInterval(Do),Do=null),Oo=null,No=Ro=Po=null,Ao=Lo=xo=wo=0}function Za(e){Z.animation&&Zn.getZoom()==Z.minZ?ma(e):ga(e)}function ga(){var e=parseFloat(Da.left),t=parseFloat(Da.top);if(Z.mouseIsDown||Oo){var i=Oo?Ro:Vo.x,a=Oo?Po:Vo.y,n=i-Co.x,l=a-Co.y,o=e-No.x,r=t-No.y,s=!(isNaN(n)||isNaN(l)||isNaN(o)||isNaN(r)||0==n&&0==l&&0==o&&0==r);if(s){var u=Oo?Z.smoothPanGlide:1,d=Oo?1:100;Ao=Math.round((n-o)/(Z.smoothPanEasing*u)*d/d),Lo=Math.round((l-r)/(Z.smoothPanEasing*u)*d/d),Z.mouseIsDown?(xo=Ao,wo=Lo):(Math.abs(Ao)>Math.abs(xo)&&(Ao=xo),Math.abs(Lo)>Math.abs(wo)&&(Lo=wo));var p=e+Ao,c=t+Lo,g=ct(p,c,Z.imageZ,Z.imageR,"container");Da.left=g.x+"px",Da.top=g.y+"px",Ao-=p-g.x,Lo-=c-g.y;var m=g.x-il,h=g.y-nl;if(xa&&kn&&(Oo||Z.mobileDevice||Math.abs(m)>Kn/2||Math.abs(h)>jn/2)&&O(xa,Mn,Zl,"simple",!1,"Updating backfill oversize display"),Oo&&Math.round(Ao*d)/d==0&&Math.round(Lo*d)/d==0&&(Oo=!1),Z.Navigator){var f=Zn.calculateCurrentCenterCoordinates(g,Z.imageZ,Z.imageR);Z.Navigator.syncNavigatorRectangleToViewport(f)}}}else if(Z.mouseIsDown||null!==Oo||0==Ao||0==Lo)ca(!0),Zn.updateView();else{var T=e+xo,b=t+wo,g=ct(T,b,Z.imageZ,Z.imageR,"container");xo=g.x-e,wo=g.y-t,(0!=xo||0!=wo)&&(Ro=Vo.x+xo,Po=Vo.y+wo,Oo=!0)}}function ma(){Z.animationCount++,null===Io&&(Io=parseFloat(Da.left)),null===yo&&(yo=parseFloat(Da.top));var e=Io,t=yo;if(Z.mouseIsDown||Oo){var i=Oo?Ro:Vo.x,a=Oo?Po:Vo.y,n=i-Co.x,l=a-Co.y,o=e-No.x,r=t-No.y,s=!(isNaN(n)||isNaN(l)||isNaN(o)||isNaN(r)||0==n&&0==l&&0==o&&0==r);if(s){var u=Oo?Z.smoothPanGlide:1,d=Oo?1:100;Ao=Math.round((n-o)/(Z.smoothPanEasing*u)*d/d),Lo=Math.round((l-r)/(Z.smoothPanEasing*u)*d/d),Z.mouseIsDown?(xo=Ao,wo=Lo):(Math.abs(Ao)>Math.abs(xo)&&(Ao=xo),Math.abs(Lo)>Math.abs(wo)&&(Lo=wo));var p=e+Ao,c=t+Lo;Io=p,yo=c;var g,m,h,f;"motion"==Z.animator?(g="horizontal"==Z.animationAxis?Ao:Lo,dimensionAxis="horizontal"==Z.animationAxis?Kn:jn,m=Math.round(Uo/Z.imageSetLength),h=g/40,f=0):"position"==Z.animator&&(g="horizontal"==Z.animationAxis?o:r,dimensionAxis="horizontal"==Z.animationAxis?Kn:jn,m=Math.max(0,Math.round((dimensionAxis/2-Math.abs(g))/So)),h=0,f="horizontal"==Z.animationAxis?Kn/10:jn/10),0==m&&m++,Z.animationCount%m==0&&(-f>g?Z.Viewer.viewportPrior(h):g>f&&Z.Viewer.viewportNext(h)),Oo&&Math.round(Ao*d)/d==0&&Math.round(Lo*d)/d==0&&(Oo=!1)}}else Z.mouseIsDown||null!==Oo||0==Ao||0==Lo?(ca(!0),Io=null,yo=null):(0!=xo||0!=wo)&&(Ro=Vo.x+xo,Po=Vo.y+wo,Oo=!0)}function ha(e){var e=Z.Utils.event(e);e.preventDefault(),ho=Math.round(100*e.scale)/100}function fa(){var e=!1;if(Z.mousePan){var t=Ta(Nn,Rn,ho),i=Zt(t);t!=Z.imageZ&&(e=Zn.scaleTierToZoom(i))}}function Ta(e,t,i){var a=t*i,n=dt(e,a);return n}function ba(e){var e=Z.Utils.event(e);e&&(coordsString=tt(e),"mousemove"==e.type?Z.Utils.showCoordinates(coordsString):"mousedown"==e.type&&e.altKey&&Z.Utils.saveCoordinates(coordsString))}var Ea,va,Ia,ya=null,Ua=null,Sa=0;"undefined"!=typeof e&&null!==e&&(Sa=e);var Aa;Aa="undefined"!=typeof t&&null!==t?t:Z.imagePath,"undefined"==typeof a||null===a?(Ea=Z.hotspotPath,va=Z.hotspotPath):(Ea=a,va=Ea,".xml"==va.toLowerCase().substring(va.length-4,va.length)&&(va=va.substring(0,va.lastIndexOf("/")))),Ea&&(Z.hotspots=!0,Z.annotationPathProvided=!0,Z.imageSet&&(Z.hotspotPath="multiple"));var La,xa,wa,Oa,Ra,Pa,Da,Ca,Na,Va,ka,Ma,Fa,_a,Ha,Ba,za,Xa,Ga,Wa,Ya,Ka,ja,qa,Qa,Ja,$a,en,tn,an,nn,ln,on,rn,sn,un,dn,pn,cn,Zn=this,gn=[],mn=-1,hn=0,fn=0,Tn=parseInt(Z.Utils.getResource("DEFAULT_CHUNKSIZE"),10),bn=8*Tn,En=4*Tn,vn=0,In=256,yn=parseInt(Z.Utils.getResource("DEFAULT_TILEW"),10),Un=parseInt(Z.Utils.getResource("DEFAULT_TILEH"),10),Sn=parseFloat(Z.Utils.getResource("DEFAULT_TIERSMAXSCALEUP")),An=Sn/2,Ln=parseInt(Z.Utils.getResource("DEFAULT_TILESMAXCACHE"),10),xn=1==Z.toolbarVisible?Z.toolbarH:0;c(Sa);var wn,On,Rn,Pn,Dn,Cn=1,Nn=0,Vn=0,kn=!1,Mn=0,Fn=!1,_n=[],Hn=[],Bn=[],zn=[],Xn=[],Gn=[];tierTileOffsetsCount=[],tierTileOffsetChunks=[],tierTileOffsetLast=[];var Wn=[];tierTileByteCountsCount=[],tierTileByteCountChunks=[],tierTileByteCountLast=[];var Yn,Kn,jn,qn,Qn,Jn,$n,el,tl,il,al,nl,ll,ol,rl,sl,ul,dl,pl,cl=[],Zl=[],gl=[],ml=[],hl=[],fl=0,Tl=0,bl=0,El=0,vl=0,Il=0,yl=0,Ul=0,Sl=0,Al=0,Ll=0,xl=0,wl=0,Ol=0,Rl=0,Pl=0,Dl=[],Cl=[],Nl=[],Vl=[],kl=[],Ml=[],Fl=null,_l=0,Hl=parseInt(Z.Utils.getResource("DEFAULT_VALIDATEVIEWRETRYLIMIT"),10),Bl=parseInt(Z.Utils.getResource("DEFAULT_VALIDATEVIEWRETRYDELAY"),10),zl=[],Xl=[],Gl=[],Wl=[],Yl=new Z.NetConnector,Kl=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLTHRESHOLD3"),10),jl=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLDYNAMICADJUST"),10),ql=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLTHRESHOLD2"),10),Ql=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLCHOICE2"),10),Mn=Ql,Jl=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLTHRESHOLD1"),10),$l=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLCHOICE1"),10),eo=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLCHOICE0"),10),to=null,io=null,ao=null,no=parseFloat(Z.Utils.getResource("DEFAULT_PANBUFFERUNCONVERTED"),10),lo=null!==Z.panBuffer?Z.panBuffer:parseFloat(Z.Utils.getResource("DEFAULT_PANBUFFER"),10),oo="unconverted"!=Z.tileSource?lo:no,ro=parseFloat(Z.Utils.getResource("DEFAULT_BACKFILLBUFFER"),10),so=parseFloat(Z.Utils.getResource("DEFAULT_PAN_BUFFERSIZEMAXBROWSER"),10),uo=parseFloat(Z.Utils.getResource("DEFAULT_PAN_BUFFERSIZEMAXFIREFOX"),10),po=parseFloat(Z.Utils.getResource("DEFAULT_PAN_BUFFERSIZEMAXIMAGESET"),10);Kn=Z.viewerW,jn=Z.viewerH,qn=Qn=0,jn-=xn,0==Z.toolbarPosition&&(Qn+=xn);var co,Zo,go=null,mo=null,ho=null,fo=!1,To=parseInt(Z.Utils.getResource("DEFAULT_GESTURETESTDURATION"),10),bo=Math.round(parseFloat(Z.Utils.getResource("DEFAULT_PANSTEPDISTANCE"))*Z.panSpeed),Eo=0,vo=0,Io=null,yo=null,Uo=parseInt(Z.Utils.getResource("DEFAULT_ANIMATIONOPTIMALMOTIONIMAGES"),10),So=parseInt(Z.Utils.getResource("DEFAULT_ANIMATIONOPTIMALPOSITIONDELTA"),10),Ao=0,Lo=0,xo=0,wo=0,Oo=null,Ro=null,Po=null,Do=null,Co=null,No=null,Vo=null,ko=parseFloat(Z.Utils.getResource("DEFAULT_ZOOMSTEPDISTANCE"))*Z.zoomSpeed;Z.mobileDevice&&(ko/=2);var Mo,Fo,_o=0,Ho=null,Bo=0,zo=parseInt(Z.Utils.getResource("DEFAULT_ZAPSTEPDURATION"),10),Xo=parseFloat(Z.Utils.getResource("DEFAULT_FADEINSTEP"))*Z.fadeInSpeed,Go=null,Wo=parseFloat(Z.Utils.getResource("DEFAULT_ZAPTVDURATION")),Yo=parseFloat(Z.Utils.getResource("DEFAULT_ZAPTVSTEPS"));Z.mobileDevice&&(Yo/=2);var Ko=null,jo=0;if(!Z.fullScreenVisible&&!Z.fullPageVisible)var qo,Qo,Jo,$o,er,tr,ir,ar,nr,lr;if(Z.virtualPointerVisible)var or,rr,sr=Z.Utils.getResource("DEFAULT_VIRTUALPOINTERPATH");if(Z.crosshairsVisible&&Z.Utils.drawCrosshairs(Z.ViewerDisplay,Kn,jn),Z.measureVisible||null!==Z.editMode){var ur=Z.Utils.getResource("UI_MEASURELENGTH"),dr=Z.Utils.getResource("UI_MEASURELENGTHTOTAL"),pr=Z.Utils.getResource("UI_MEASUREPERIMETER"),cr=Z.Utils.getResource("UI_MEASUREAREA"),Zr=Z.Utils.getResource("UI_MEASURESQUARE"),gr=parseFloat(Z.Utils.getResource("DEFAULT_MEASURECAPTIONBACKOPACITY"));parseInt(Z.Utils.getResource("DEFAULT_MEASURECAPTIONFONTSIZE"),10),parseInt(Z.Utils.getResource("DEFAULT_MEASURECAPTIONWIDTH"),10)}if(Z.Utils.stringValidate(Z.watermarkPath))var mr,hr,fr=[],Tr=[];if(Z.tour)var br,Er,vr,Ir;if(null!==Z.imagePath&&-1!=Z.imagePath.indexOf("zSlidePath")&&(Z.slidePath=Z.imagePath.substring(11,Z.imagePath.length),Z.slideshow=!0),null!==Z.imagePath&&(-1!=Z.imagePath.indexOf("zAnimationPath")?(Z.imageSetPath=Z.imagePath.substring(15,Z.imagePath.length),Z.imageSet=!0,Z.animation=!0):-1!=Z.imagePath.indexOf("zSlidestackPath")&&(Z.imageSetPath=Z.imagePath.substring(16,Z.imagePath.length),Z.imageSet=!0,Z.slidestack=!0)),Z.slideshow){var yr,Ur,Sr,Ar,Lr,xr,wr=[],Or=[],Rr=parseFloat(Z.Utils.getResource("DEFAULT_SLIDETRANSITIONSTEP"))*Z.slideTransitionSpeed;Z.slideTransitionTimeout=null,Z.slideOpacity=0}if(Z.measureVisible||Z.tour||Z.hotspots||Z.annotations){var Pr=!1,Dr=[],Cr=[],Nr=[],Vr=[],kr=null,Mr=null,Fr=null,_r=null,Hr=null,Br=null,zr=!1,Xr=!0,Gr=null,Wr=!1,Yr=new Z.NetConnector,Kr=Z.Utils.getResource("DEFAULT_POLYGONLINEWIDTH"),jr=parseFloat(Z.Utils.getResource("DEFAULT_POLYGONOPACITY")),qr=parseInt(Z.Utils.getResource("DEFAULT_POLYGONVIEWBUFFER"),10),Qr=Z.Utils.getResource("DEFAULT_CONTROLPOINTLINEWIDTH"),Jr=Z.Utils.getResource("DEFAULT_CONTROLPOINTSTROKECOLOR"),$r=Z.Utils.getResource("DEFAULT_FIRSTCONTROLPOINTFILLCOLOR"),es=Z.Utils.getResource("DEFAULT_STANDARDCONTROLPOINTFILLCOLOR"),ts=parseInt(Z.Utils.getResource("DEFAULT_CONTROLPOINTRADIUS"),10),is=Z.Utils.getResource("DEFAULT_POLYGONLINEWIDTHFREEHAND"),as=Z.Utils.getResource("DEFAULT_CAPTIONTEXTCOLOR"),ns=Z.Utils.getResource("DEFAULT_CAPTIONBACKCOLOR"),ls=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONFONTSIZE"),10),os=parseInt(Z.Utils.getResource("DEFAULT_MINHOTSPOTCAPTIONFONTSIZE"),10),rs=parseInt(Z.Utils.getResource("DEFAULT_MAXHOTSPOTCAPTIONFONTSIZE"),10),ss=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONPADDING"),10),us=parseInt(Z.Utils.getResource("DEFAULT_MINHOTSPOTCAPTIONPADDING"),10),ds=parseInt(Z.Utils.getResource("DEFAULT_MAXHOTSPOTCAPTIONPADDING"),10);if(Z.mobileDevice&&(ts*=2),Z.maskVisible){{parseFloat(Z.Utils.getResource("DEFAULT_MASKFADESTEP"))*Z.maskFadeSpeed}Z.setCallback("viewUpdateComplete",function(){Z.maskingSelection&&setMask()})}if(Z.tour||Z.hotspots)var ps,cs,Zs,gs,ms,hs,fs=[];else if(Z.measureVisible||Z.annotations){var Ts,bs,Es,vs,Is,ys,Us=[],Ss=[],As=[],Ls=[],xs=[];labelCaptionPositionListDP=[],labelTargetListDP=[]}}if(null!==Z.imagePath&&"null"!=Z.imagePath){if(1==Z.localUse&&"ZoomifyImageFile"==Z.tileSource)return void Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNSUPPORTEDLOCALVIEWING-FORMAT-ZIF"),!0);if(1==Z.localUse&&(Z.browser==Z.browsers.CHROME||Z.browser==Z.browsers.OPERA||Z.browser==Z.browsers.IE&&11==Z.browserVersion||Z.browser==Z.browsers.SAFARI&&Z.browserVersion>=7)&&Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNSUPPORTEDLOCALVIEWING-BROWSER"),!0),null!==Z.imageW&&null!==Z.imageH&&null!==Z.sourceMagnification)if("undefined"!=typeof Zn.getStatus)l(Z.imageW,Z.imageH,yn,Un,null,null,null,null,Z.sourceMagnification,Z.focal,Z.quality);else{window.setTimeout(function(){l(Z.imageW,Z.imageH,yn,Un,null,null,null,null,Z.sourceMagnification,Z.focal,Z.quality)},100)}else if(null!==Z.imageProperties){var ws=Z.Utils.xmlConvertTextToDoc(Z.imageProperties);T(ws)}else if("unconverted"==Z.tileSource)P(Aa);else if(-1==Z.imagePath.indexOf("zSlidePath")&&-1==Z.imagePath.indexOf("zAnimationPath")){var Os=new Z.NetConnector;h(Aa,Os,Sa)}}if(Z.slideshow){var Os=new Z.NetConnector;n(Os)}this.setSizeAndPosition=function(e,t,i,a){m(e,t,i,a)},this.syncViewportResize=function(e,t,i,a){Zn.setSizeAndPosition(Z.viewerW,Z.viewerH,0,0),Zn.resizeViewport(e,t,i,a)},this.resizeViewport=function(e,t,i,a){Zn.validateXYZDefaults(),Zn.setView(e,t,i,a)},this.loadImageProperties=function(e,t,i){h(e,t,i)},this.parseZIFHeader=function(e){if(u(),73==e[0]&&73==e[1]&&43==e[2]&&0==e[3]&&8==e[4]&&0==e[5]&&0==e[6]&&0==e[7]&&16==e[8]&&0==e[9]&&0==e[10]&&0==e[11]&&0==e[12]&&0==e[13]&&0==e[14]&&0==e[15]){var t=Z.Utils.longValue(e,8),i=Z.Utils.longValue(e,t),a=1,n=null,r=null,s=null,d=null,p=null,c=null,g=null,m=null,h=null,f=null,T=null,b=null,E=null;for(g=1,m=2;0!=t;){for(var v=0;i>v;v++){var I=t+8+20*v,y=Z.Utils.shortValue(e,I);switch(y){case 256:_n[a-1]=Z.Utils.intValue(e,I+12);break;case 257:Hn[a-1]=Z.Utils.intValue(e,I+12);break;case 322:s=Z.Utils.intValue(e,I+12);break;case 323:d=Z.Utils.intValue(e,I+12);break;case 324:var U=tierTileOffsetsCount[a-1]=Z.Utils.longValue(e,I+4);Gn[a-1]=Z.Utils.longValue(e,I+12),p+=U;break;case 325:var U=tierTileByteCountsCount[a-1]=Z.Utils.longValue(e,I+4);Wn[a-1]=1==U?Z.Utils.intValue(e,I+12):2==U?Z.Utils.intValue(e,I+12)+","+Z.Utils.intValue(e,I+16):Z.Utils.longValue(e,I+12),c+=U}}t=Z.Utils.longValue(e,t+20*i+8),i=Z.Utils.longValue(e,t),a++}n=_n[0],r=Hn[0],Cn=a-1,_n.reverse(),Hn.reverse(),tierTileOffsetsCount.reverse(),Gn.reverse(),tierTileByteCountsCount.reverse(),Wn.reverse(),!isNaN(n)&&n>0&&!isNaN(r)&&r>0&&!isNaN(s)&&s>0&&!isNaN(d)&&d>0&&p>0?"undefined"!=typeof Zn.getStatus?l(n,r,s,d,p,m,h,f,T,b,E):o(n,r,s,d,p,m,h,f,T,b,E):Z.Utils.showMessage("ZoomifyImageFolder"==Z.tileSource?Z.Utils.getResource("ERROR_IMAGEPROPERTIESXMLINVALID"):Z.Utils.getResource("ERROR_IMAGEPROPERTIESINVALID"))
}},this.parseZIFOffsetChunk=function(e,t){var i=Z.Utils.arrayIndexOfObjectValue(tierTileOffsetChunks,"chunkID",t);-1!=i&&(tierTileOffsetChunks[i].chunk=e,B(t,"offset"))},this.parseZIFByteCountChunk=function(e,t){var i=Z.Utils.arrayIndexOfObjectValue(tierTileByteCountChunks,"chunkID",t);-1!=i&&(tierTileByteCountChunks[i].chunk=e,B(t,"byteCount"))},this.parseZIFImage=function(e,t,i){var a,n="data:image/jpeg;base64,"+Z.Utils.encodeBase64(e);"image-display"==i?a=W:"image-backfill"==i?a=Y:"navigator"==i&&(a=Z.Navigator.initializeNavigator);var l=Z.Utils.createCallback(null,a,t);Z.Utils.createImageElementFromBytes(n,l)},this.parseImageXML=function(e){T(e)},this.validateXYZDefaults=function(e){e&&Z.Utils.resetParametersXYZ(Z.parameters);var t=parseFloat(Z.Utils.getResource("DEFAULT_INITIALX")),i=parseFloat(Z.Utils.getResource("DEFAULT_INITIALY")),a=parseFloat(Z.Utils.getResource("DEFAULT_INITIALZOOM")),n=parseFloat(Z.Utils.getResource("DEFAULT_INITIALR")),l=parseFloat(Z.Utils.getResource("DEFAULT_MINZOOM")),o=parseFloat(Z.Utils.getResource("DEFAULT_MAXZOOM")),r=isNaN(t)?null:t,s=isNaN(i)?null:i,u=isNaN(a)?null:a,d=isNaN(n)?null:n,p=isNaN(l)?null:l,c=isNaN(o)?null:o;Z.parameters?(Z.parameters.zInitialX||(Z.initialX=r),Z.parameters.zInitialY||(Z.initialY=s),Z.parameters.zInitialZoom||(Z.initialZ=u),Z.parameters.zInitialRotation||(Z.initialR=d),Z.parameters.zMinZoom||(Z.minZ=p),Z.parameters.zMaxZoom||(Z.maxZ=c)):(Z.initialX=r,Z.initialY=s,Z.initialZ=u,Z.initialR=d,Z.minZ=p,Z.maxZ=c),null===Z.initialX&&(Z.initialX=Z.imageW/2),null===Z.initialY&&(Z.initialY=Z.imageH/2),Z.fitZ=Zn.calculateZoomToFit(0),Z.fillZ=Zn.calculateZoomToFill(0);var g=Zn.getStatus("initialized")?Zn.getRotation():Z.initialR,m=Zn.calculateZoomToFit(g),h=Zn.calculateZoomToFill(g);Z.fitZ>1&&(null!==Z.maxZ?Z.fitZ>Z.maxZ&&(Z.fitZ=Z.maxZ):"unconverted"==Z.tileSource&&(Z.fitZ=1)),Z.fillZ>1&&(null!==Z.maxZ?Z.fillZ>Z.maxZ&&(Z.fillZ=Z.maxZ):"unconverted"==Z.tileSource&&(Z.fillZ=1)),null===Z.minZ||-1==Z.minZ?Z.minZ=Z.fitZ:0==Z.minZ&&(Z.minZ=Z.fillZ),(null===Z.maxZ||-1==Z.maxZ)&&(Z.maxZ=1),null===Z.initialZ||-1==Z.initialZ?Z.initialZ=m:0==Z.initialZ&&(Z.initialZ=h),Z.initialZ<Z.minZ&&(Z.initialZ=Z.minZ),Z.initialZ>Z.maxZ&&(Z.initialZ=Z.maxZ)},this.getViewW=function(){return Kn},this.getViewH=function(){return jn},this.getDisplayW=function(){return Jn},this.getDisplayH=function(){return $n},this.getImagePath=function(){return Aa},this.setImagePath=function(e){Aa=e},this.getViewportID=function(){return Sa},this.getTierCount=function(){return Cn},this.getTileW=function(){return yn},this.getTileH=function(){return Un},this.getTierCurrent=function(){return Nn},this.getTierBackfill=function(){return Vn},this.getTierBackfillDynamic=function(){return kn},this.getTierBackfillOversize=function(){return Mn},this.getTierScale=function(){return On},this.getX=function(){var e=parseFloat(Da.left)-il,t=Zn.getZoom(),i=ya-e/t;return i},this.getY=function(){var e=parseFloat(Da.top)-nl,t=Zn.getZoom(),i=Ua-e/t;return i},this.getZoom=function(){var e=dt(Nn,On);return e},this.getRotation=function(){return Z.imageR},this.getTiersScaleUpMax=function(){return Sn},this.getTiersScaleDownMax=function(){return An},this.getTilesCacheMax=function(){return Ln},this.getTierWs=function(){return _n.join(",")},this.getTierHs=function(){return Hn.join(", ")},this.getTierTileCounts=function(){return Xn.join(", ")},this.getTilesToLoad=function(){return fl},this.getTilesLoadingNames=function(){var e=""==Cl.join(", ")?"Current view loading complete":Cl.join(", ");return e},this.getTilesToDraw=function(){return Ol},this.getConstrainPan=function(){return Z.constrainPan},this.setConstrainPan=function(e){Z.constrainPan=0!=e,Z.constrainPanStrict=2==e?!0:!1,Z.constrainPan&&Zn.toggleConstrainPan(!0)},this.getSmoothPan=function(){return Z.smoothPan},this.setSmoothPan=function(e){Z.smoothPan=e},this.getSmoothPanEasing=function(){return Z.smoothPanEasing},this.setSmoothPanEasing=function(e){Z.smoothPanEasing=e},this.getSmoothPanGlide=function(){return Z.smoothPanGlide},this.setSmoothPanGlide=function(e){Z.smoothPanGlide=e},this.setCoordinatesDisplayVisibility=function(e){e?(Z.Utils.addEventListener(document,"mousemove",ba),Z.Utils.addEventListener(document,"mousedown",ba)):(Z.coordinatesVisible=!1,Z.Utils.removeEventListener(document,"mousemove",ba),Z.Utils.removeEventListener(document,"mousedown",ba))},this.setTourPath=function(e,t){Zn.setHotspotPath(e,t)},this.setHotspotPath=function(e,t){"undefined"==typeof e||Z.Utils.stringValidate(e)?(Z.hotspotPath=Z.Utils.stringRemoveTrailingSlashCharacters(e),Z.hotspotFolder=Z.hotspotPath,".xml"==Z.hotspotPath.toLowerCase().substring(Z.hotspotPath.length-4,Z.hotspotPath.length)&&(Z.hotspotFolder=Z.hotspotFolder.substring(0,Z.hotspotFolder.lastIndexOf("/"))),t||(Zn.deleteAllHotspots(),Ft(Sa))):(Z.hotspotPath=null,Z.hotspotFolder=null,Zn.deleteAllHotspots())},this.getHotspots=function(){return Dr},this.setHotspots=function(e){Dr=e.slice(0)},this.setVisibility=function(e){U(e)},this.showLists=function(e){var t=e?"visible":"hidden";Z.hotspots&&Z.Viewer.setVisibilityHotspotChoiceList(e,Sa.toString()),Ur&&(Ur.style.visibility=t),Z.imageSet&&imageSetList&&(imageSetList.style.visibility=t)},this.precacheBackfillTiles=function(t){t||(S(eo,gl),to=!0),(!Z.imageSet||e==Z.imageSetStart||t)&&Cn>Jl&&(S($l,gl),io=!0,Cn>ql&&(S(Ql,gl),ao=!0),Zn.setStatus("backfillPrecached",!0)),gl.sort(),gl=Z.Utils.arrayUnique(gl),cl=gl.slice(0),Zn.traceDebugValues("tilesBackfillToPrecache",null,cl.length),N(gl,Y,"simple","image-backfill")},this.updateView=function(t){("undefined"==typeof e||null===e)&&(e=0);var i=Z.mouseIsDown||Z.buttonIsDown||Z.keyIsDown||Z.mouseWheelIsDown,a=On!=Rn||Zn.getZoom()!=Z.imageZ||Z.imageZ!=Z.priorZ,n=parseFloat(Da.left)!=il||parseFloat(Da.top)!=nl||Zn.getX()!=Z.imageX||Zn.getY()!=Z.imageY,l=Z.fullViewPrior;if(a||n||l||"undefined"!=typeof t&&t&&(!i||Z.animation)){var o=1;if(!Z.imageSet||!Z.Viewer.getStatus("ready")||e>Z.viewportCurrentID-o&&e<Z.viewportCurrentID+o){qi(),A(t);var r=!1;"undefined"!=typeof t&&t||On!=Rn||Zn.getZoom()!=Z.imageZ||!Zn.getStatus("initialized")?(L(),"unconverted"!=Z.tileSource&&(x(),O(Na,Vn,Zl,"simple",!1,"2. Updating view: changing tier - backfill")),!t&&Ln>0&&(r=!0)):Zn.traceDebugValues("updateView-noChange"),"unconverted"!=Z.tileSource&&kn?w(!0):xa&&Z.Utils.clearDisplay(xa)}if(Z.imageSet&&e!=Z.viewportCurrentID)Zn.setStatus("displayLoaded",!0),Zn.setStatus("displayDrawn",!0);else{if("unconverted"!=Z.tileSource)w(),O(Fa,Nn,null,"centerOut",r,"3. Updating view: prior to loading of any new tiles");else if("undefined"!=typeof wn){var s=-Z.imageX,u=-Z.imageY;Z.Utils.clearDisplay(Fa),Ha.drawImage(wn,s,u)}Z.maskingSelection&&setMask(),Cl.length>0&&N(Cl,W,"centerOut","image-display"),Zn.syncViewportRelated()}n&&Z.Utils.validateCallback("viewPanned"),a&&Z.Utils.validateCallback("viewZoomed"),(n||a)&&Z.Utils.validateCallback("viewChanged")}},syncTransitionCanvas=function(){za&&Xa&&Ga&&(za.width=Fa.width,za.height=Fa.height,Xa.width=_a.width,Xa.height=_a.height,Xa.left=_a.left,Xa.top=_a.top,Ga.restore(),Ga.save(),Ga.translate(el,tl),Ga.scale(On,On))},this.loadUnconvertedImage=function(e){P(e)},this.getUnconvertedImage=function(){return wn},this.createUnconvertedImageThumbnail=function(){if(Z.useCanvas){if("undefined"!=typeof wn){var e=null,t=150/Z.imageW,i=Z.imageW*t,a=Z.imageH*t,n=Z.Utils.createContainerElement("canvas","tempCanvas","inline-block","absolute","visible",i+"px",a+"px","0px","0px","none","0px","transparent none","0px","0px","normal"),l=n.getContext("2d");try{l.scale(t,t),l.drawImage(wn,0,0)}catch(o){console.log("In function initializeViewportContinue scaling canvas:  "+o)}return e=new Image,e.src=n.toDataURL("image/jpeg",Z.saveImageCompression),e}{window.setTimeout(function(){createUnconvertedImageThumbnail()},100)}}},this.formatTilePath=function(e,t,i,a){var n;return"ZoomifyImageFile"==Z.tileSource?n=M(e,t,i,a):"ZoomifyImageFolder"==Z.tileSource&&(n=H(e,t,i,a)),n},this.getClickCoordsAtZoom=function(e,t){var i=this.getClickCoordsInImage(e,t),a=i.x,n=i.y,l=a*t,o=n*t,r=new Z.Utils.Point(l,o);return r},this.getClickCoordsInImage=function(e,t,i){var e=Z.Utils.event(e),a=null;if(e){var n=e.type;if(("undefined"==typeof i||null===i)&&("touchstart"==n||"touchend"==n||"touchcancel"==n?(touch=Z.Utils.getFirstTouch(e),"undefined"!=typeof touch&&(target=touch.target,i=new Z.Utils.Point(touch.pageX,touch.pageY))):(target=Z.Utils.target(e),relatedTarget=Z.Utils.relatedTarget(e),i=Z.Utils.getMousePosition(e))),"undefined"!=typeof i&&null!==i){var l=nt(i.x,i.y);a=st(l.x,l.y,t)}}return a},this.getClickZoomCoords3D=function(e,t,i,a,n){var l=parseFloat(Z.Utils.getResource("DEFAULT_CLICKZOOMTIERSKIPTHRESHOLD")),o=nt(t.x,t.y),r=st(o.x,o.y,Z.imageZ),s=dt(i,a),u=e.altKey;if(n)if(u)s=Z.fitZ;else{var d=pt(i,Z.fitZ);l>a-d?s=Z.fitZ:a>1+l?s=dt(i,1):i>0?s=dt(i-1,1):"unconverted"==Z.tileSource&&(s=Z.fitZ)}else u?s=1:1-l>a?s=dt(i,1):Cn-1>i&&(s=dt(i+1,1));return new Z.Utils.Point3D(r.x,r.y,s)},this.calculateCurrentCenterCoordinates=function(e,t,i){if("undefined"==typeof e||null===e)var e=new Z.Utils.Point(parseFloat(Da.left),parseFloat(Da.top));("undefined"==typeof i||null===i)&&(i=Z.imageR),0>i&&(i+=360),("undefined"==typeof t||null===t)&&(t=Zn.getZoom());var a,n,l=e.x-il,o=e.y-nl,r=l/t,s=o/t;switch(i){case 0:a=Z.imageX-r,n=Z.imageY-s;break;case 90:a=Z.imageX-s,n=Z.imageY+r;break;case 180:a=Z.imageX+r,n=Z.imageY+s;break;case 270:a=Z.imageX+s,n=Z.imageY-r}return new Z.Utils.Point(a,n)},this.getViewportDisplayBoundingBoxInTiles=function(e,t){return("undefined"==typeof e||null===e)&&(e=Nn),("undefined"==typeof t||null===t)&&(t=!1),new it(Zn.getViewportDisplayBoundingBoxInPixels(t),e)},this.getViewportDisplayBoundingBoxInPixels=function(e){var t=parseFloat(Da.left)-il,i=parseFloat(Da.top)-nl;if(Z.useCanvas){var a=parseFloat(Da.width)/Pa.width;t/=a,i/=a}var n=Zn.getZoom();0!=t&&(t/=n),0!=i&&(i/=n);var l,o,r,s,u=Z.imageX-t,d=Z.imageY-i;return e?(l=-(Kn/2),o=Kn/2,r=-(jn/2),s=jn/2):(l=-(Jn/2),o=Jn/2,r=-($n/2),s=$n/2),new at(u,d,l,o,r,s,n)},this.calculateZoomToFit=function(e){var t=Z.imageW/Z.imageH>Kn/jn?Kn/Z.imageW:jn/Z.imageH;return(90==e||270==e)&&(t=Z.imageW/Z.imageH>Kn/jn?Kn/Z.imageH:jn/Z.imageW),t},this.calculateZoomToFill=function(e){var t=Z.imageW/Z.imageH>Kn/jn?jn/Z.imageH:Kn/Z.imageW;return(90==e||270==e)&&(t=Z.imageW/Z.imageH>Kn/jn?jn/Z.imageW:Kn/Z.imageH),t},this.calculateZoomForResize=function(e,t,i,a,n){var l=e,o=Z.imageW*e,r=Z.imageH*e,s=a/t,u=n/i;if(a>o&&n>r)l=e;else if(o==a&&n>r)l=-1;else if(a>o&&r==n)l=-1;else if(o>a&&n>=r)l=e*s;else if(a>=o&&r>n)l=e*u;else if(o>a&&r>n){var d=1;s>=1&&u>=1?d=s>u?s:u:1>=s&&1>=u&&(d=u>s?s:u),l=e*d}return l<Z.minZ&&(l=Z.minZ),l>Z.maxZ&&(l=Z.maxZ),l},this.convertTierScaleToZoom=function(e,t){var i=dt(e,t);return i},this.syncViewportToNavigator=function(e){var t=Z.imageR;0>t&&(t+=360);var i=ct(e.x,e.y,Z.imageZ,t,"image"),a=Z.imageX,n=Z.imageY,l=i.x,o=i.y,r=dX=a-l,s=dY=n-o;0!=t&&(90==t?(r=-dY,s=dX):180==t?(r=-dX,s=-dY):270==t&&(r=dY,s=-dX));var u=r*Z.imageZ,d=s*Z.imageZ,p=u+il,c=d+nl;Da.left=p+"px",Da.top=c+"px",xa&&kn&&(Z.mobileDevice||Math.abs(u)>Kn/2||Math.abs(d)>jn/2)&&O(xa,Mn,Zl,"simple",!1,"Updating backfill oversize display")},this.getStatus=function(e){var t=Z.Utils.arrayIndexOfObjectValue(gn,"state",e),i=-1==t?!1:gn[t].status;return i},this.setStatus=function(e,t){var i=!1,a=Z.Utils.arrayIndexOfObjectValue(gn,"state",e);-1==a?(i=t,gn[gn.length]={state:e,status:t}):(!gn[a].status&&t&&(i=!0),gn[a].status=t),i&&(Z.Utils.validateCallback(e+"Viewport"),Z.Viewer.validateViewerStatus(e))},this.traceDebugValues=function(e,t,i,a){var n="undefined"!=typeof i&&null!==i?i:null,l=null!==t?t:"";switch(e){case"tilesToDisplay":Sl=n,Al=0,Ll=0,xl=0,wl=0,Ol=n,Rl=0,tilesTimeStart=(new Date).getTime(),Pl=0,window.clearTimeout(Fl),Fl=null,Fl=window.setTimeout(Et,Bl);break;case"tilesInCache":Al=n;break;case"loadTile-image-display":Ll+=1;break;case"onTileLoad":xl+=1;var o=(new Date).getTime();Rl=(o-n)/1e3,Pl=xl/Rl;break;case"displayTile":var r=Z.Utils.arrayIndexOf(Dl,l);-1!=r&&(Dl.splice(r,1),wl+=1,Ol-=1);break;case"tilesBackfillToPrecache":bl=n;break;case"onTileBackfillPrecache":El+=1;break;case"tilesBackfillToDisplay":vl=n,Yn=n;break;case"onTileBackfillLoad":yl+=1;break;case"displayBackfillTile":var r=Z.Utils.arrayIndexOf(cl,l);-1!=r&&(cl.splice(r,1),Ul+=1,Yn-=1)}if((2==Z.debug||3==Z.debug)&&Z.Utils.traceTileStatus(Sl,Al,Ll,xl,wl,Ol),2==Z.debug){var s="undefined"!=typeof a&&null!==a&&a.length>0?a.join(", "):"none",u=!1,d=!0,p="";switch(e){case"updateView-noChange":p="Updating view: no change of tier.";break;case"tilesToDisplay":p="Tiles to display: "+s;break;case"tilesInCache":p="Tiles in cache: "+s;break;case"tilesToLoad":p="Tiles to load: "+s;break;case"tilesToLoad-backfill":p="Tiles to load-backfill: "+s;break;case"redisplayCachedTiles-viewportDisplay":for(var c=[],g=0,m=a.length;m>g;g++)c[c.length]=a[g].name;p="Tiles from cache-"+l+": "+c.join(", ");break;case"redisplayCachedTiles-backfillDisplay":for(var c=[],g=0,m=a.length;m>g;g++)c[c.length]=a[g].name;p="Tiles from cache-"+l+": "+c.join(", ");break;case"loadNewTiles-image-display":p="Tile requests for display: "+l+s;break;case"loadNewTiles-image-backfill":p="Tile requests for backfill: "+l+s;break;case"imageRequestTimeout":p="Image request for "+l;break;case"loadTile-image-display":p="Tile request-display: "+l,d=!1;break;case"loadTile-image-backfill":p="Tile request-backfill: "+l,d=!1;break;case"loadTileDelayForOffset":p="Tile not yet being loaded - offset chunk loading in progress: "+l;break;case"onTileLoad":p="Tiles received-display: "+l,d=!1;break;case"onTileBackfillLoad":p="Tiles received-backfill: "+l,0==gl.length&&(p+="\n\nTile loading complete for backfill: all requested tiles received."),d=!1;break;case"formatTilePathZIF":p="Tile request recorded for after load offset chunk: "+l;break;case"selectTilesRetryZIF":p="Requesting tiles after offset chunk received: "+s;break;case"formatTilePathPFF":p="Tile request recorded for after load offset chunk: "+l,d=!1;break;case"selectTilesRetryPFF":p="Requesting tiles after offset chunk received: "+s,d=!1;break;case"loadNewTilesRetry":p=l;break;case"displayTile":p="Tile displaying: "+l,d=!1;break;case"blankLine":p=" "}""!=p&&Z.Utils.trace(p,u,d)}},this.updateProgress=function(e,t){Z.updateViewPercent=vt(e,t),Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&Z.Toolbar.updateProgress(e,t)},this.showVirtualPointer=function(){if(rr){var e=rr.width,t=rr.height,i=Z.viewerW/2+100,a=Z.viewerH-200;yt(e,t,i,a)}else It()},this.hideVirtualPointer=function(){or&&(or.style.display="none")},this.parseHotspotsXML=function(t){Z.Utils.arrayClear(fs),Z.Utils.arrayClear(Cr),Pr=!1,Zn.setStatus("XMLParsed",!1),vr=Z.Utils.getResource("DEFAULT_TOURAUTOSTART"),Ir=Z.Utils.getResource("DEFAULT_TOURAUTOLOOP"),Zs=Z.Utils.getResource("DEFAULT_HOTSPOTLISTPOSITION"),cs=Z.Utils.getResource("DEFAULT_HOTSPOTLISTSOURCE"),hotspotListTitle=Z.Utils.getResource(Z.tourPath?"UI_TOURLISTTITLE":"UI_HOTSPOTLISTTITLE"),gs=Z.Utils.getResource("DEFAULT_HOTSPOTSINITIALVISIBILITY"),ms=parseFloat(Z.Utils.getResource("DEFAULT_HOTSPOTSMINSCALE")),hs=parseFloat(Z.Utils.getResource("DEFAULT_HOTSPOTSMAXSCALE"));var i=t.getElementsByTagName("SETUP")[0];if("undefined"==typeof i||!Z.Utils.stringValidate(i)){var i=t.getElementsByTagName("HOTSPOTSETUP")[0];if("undefined"==typeof i||!Z.Utils.stringValidate(i)){var a="<HOTSPOTSETUP />",n=Z.Utils.xmlConvertTextToDoc(a);i=n.getElementsByTagName("HOTSPOTSETUP")[0]}}if(i){var l=i.getAttribute("AUTOSTART");Z.Utils.stringValidate(l)&&(vr="0"!=l&&"false"!=l);var o=i.getAttribute("AUTOLOOP");Z.Utils.stringValidate(o)&&(Ir="0"!=o&&"false"!=o);var r=i.getAttribute("CHOICELIST");Z.Utils.stringValidate(r)&&(Zs=r);var s=i.getAttribute("LISTSOURCE");Z.Utils.stringValidate(s)&&(cs=s);var u=Z.Utils.xmlUnescapeMinimal(unescape(i.getAttribute("LISTTITLE")));Z.Utils.stringValidate(u)&&(hotspotListTitle=u);var d=i.getAttribute("INITIALVISIBILITY");Z.Utils.stringValidate(d)&&(gs="1"==d||"true"==d);var p=parseFloat(i.getAttribute("MINSCALE"));isNaN(p)||(ms=0!=p?p:1e-5);var c=parseFloat(i.getAttribute("MAXSCALE"));isNaN(c)||(hs=0!=c?c:1e4)}Qa.visibility=gs?"visible":"hidden",Z.Utils.stringValidate(Z.hotspotListTitle)?hotspotListTitle=Z.hotspotListTitle:Z.Utils.stringValidate(hotspotListTitle)&&(Z.hotspotListTitle=hotspotListTitle),ni(Zs,hotspotListTitle,fs,e);for(var g=t.getElementsByTagName("HOTSPOT"),m=0,h=g.length;h>m;m++){var f=g[m];f=pi(f),Zn.createHotspotFromXML(f,!0)}2==Z.debug&&Pr&&Z.Utils.trace(Z.Utils.getResource("ERROR_HOTSPOTMEDIAINVALID")),Zn.setStatus("XMLParsed",!0),Xt(),Z.tour?(Zn.initializeAudioMuteButtons(),Z.Utils.validateCallback("tourLoaded"),vr&&!Z.tourStop&&Z.Utils.functionCallWithDelay(function(){Zn.tourStart()},750)):(Z.Utils.validateCallback("hotspotsLoaded"),Zn.setStatus("hotspotsLoaded",!0))},this.createHotspotFromParameters=function(e,t,i,a,n,l,o,r,s,u,d,p,c,g,m,h,f,T,b,E,v,I,y,U,S,A,L,x,w,O,R,P,D,C,N){var V=("undefined"!=typeof L&&null!==L?L.toString():null,Z.Utils.arrayToArrayOfStrings([e,t,i,a,n,l,o,r,s,u,d,p,c,g,m,h,f,T,b,E,v,I,y,U,S,A,L,x,w,O,R,P,D,C,N])),k='<HOTSPOT ID="'+V[0]+'" NAME="'+V[1]+'" MEDIATYPE="'+V[2]+'" MEDIA="'+V[3]+'" AUDIO="'+V[4]+'" X="'+V[5]+'" Y="'+V[6]+'" ZOOM="'+V[7]+'" XSCALE="'+V[8]+'" YSCALE="'+V[9]+'" CLICKURL="'+V[10]+'" URLTARGET="'+V[11]+'" ROLLOVER="'+V[12]+'" CAPTION="'+V[13]+'" TOOLTIP="'+V[14]+'" TEXTCOLOR="'+V[15]+'" BACKCOLOR="'+V[16]+'" LINECOLOR="'+V[17]+'" FILLCOLOR="'+V[18]+'" TEXTVISIBLE="'+V[19]+'" BACKVISIBLE="'+V[20]+'" LINEVISIBLE="'+V[21]+'" FILLVISIBLE="'+V[22]+'" CAPTIONPOSITION="'+V[23]+'" SAVED="'+V[24]+'" INTERNALID="'+V[25]+'" POIID="'+V[26]+'" SHOWFOR="'+V[31]+'" TRANSITION="'+V[32]+'" CHANGEFOR="'+V[33]+'" ROTATION="'+V[34]+'"></HOTSPOT>',M=Z.Utils.xmlConvertTextToDoc(k),F=M.getElementsByTagName("HOTSPOT")[0];null===F.getAttribute("INTERNALID")&&F.setAttribute("INTERNALID",Ti("hotspot"));var _=Z.Utils.xmlConvertTextToDoc("<TEMP></TEMP>");if(Z.Utils.stringValidate(V[27])){var H=Z.Utils.xmlConvertTextToDoc(x).getElementsByTagName("CAPTION")[0].innerHTML,B=_.createElement("CAPTION");B.innerHTML=H,F.appendChild(B)}if(Z.Utils.stringValidate(V[28])){var H=Z.Utils.xmlConvertTextToDoc(w).getElementsByTagName("TOOLTIP")[0].innerHTML,z=_.createElement("TOOLTIP");z.innerHTML=H,F.appendChild(z)}if(Z.Utils.stringValidate(V[30])){var X=_.createElement("POLYGON");X.setAttribute("CLOSED",V[29]);for(var G=0,W=R.length;W>G;G++){var Y=_.createElement("POINT");Y.setAttribute("X",R[G].x),Y.setAttribute("Y",R[G].y),X.appendChild(Y)}F.appendChild(X)}Zn.createHotspotFromXML(F,!0)},this.createHotspotFromXML=function(e,t){t&&(e=hi(e,"hotspot"));var i=new Ht(e);if(di(i)||Z.annotations){Dr[Dr.length]=i;var a="NAME"==cs?i.name:"CAPTION"==cs?i.caption:i.tooltip;ps&&li(a,i.internalID)}var n=new Kt;Z.Utils.stringValidate(i.media)&&"text"!=i.mediaType&&"polygon"!=i.media?_t(i,!0):Wt(i,n),Z.Viewer.getStatus("ready")&&(Z.Utils.validateCallback("labelCreated"),Z.Utils.validateCallback("labelCreatedGetInternalID"))},this.modifyHotspot=function(e,t,i,a,n){var l=-1;if(l=n?Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",e):Z.Utils.arrayIndexOfObjectValue(Dr,"id",e.toString()),-1!=l){var o=Dr[l];if("polygon"==o.media&&("x"==t||"y"==t)){var r="x"==t?i:o.x,s="y"==t?i:o.y,u=new Z.Utils.Point(r,s);qt(o,u)}var d="polygon"==o.media&&("xScale"==t||"yScale"==t);d?Qt(o,t,i/100):o[t]=i,"rollover"==t&&0==i&&(o.visibility=!0),"media"==t&&"icon"==o.mediaType&&_t(o,!1),"undefined"!=typeof a&&null!==a&&a||Xt()}},this.deleteHotspot=function(e,t,i){var a=-1;i?a=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",e):(a=Z.Utils.arrayIndexOfObjectValue(Dr,"id",e.toString()),-1!=a&&(e=Dr[a].internalID)),-1!=a&&(Dr=Z.Utils.arraySplice(Dr,a,1),si(e),t||oi(e))},this.deleteAllHotspots=function(){Dr=[],qa&&(qa.innerHTML=""),ri()},this.deleteAllMeasureHotspots=function(){var e=Dr.length;if(e>0&&qa&&qa.childNodes.length>0){for(var t=0;e>t;t++)"measure"==Dr[t].mediaType&&(Dr=Z.Utils.arraySplice(Dr,t,1));Xt()}},this.redisplayHotspots=function(){Xt()},this.setLabelsVisibilityByFilter=function(e,t,i){Zn.setHotspotsVisibilityByFilter(e,t,i)},this.setLabelVisibilityByID=function(e,t,i){Zn.setHotspotVisibilityByID(e,t,i)},this.setHotspotFilterByDisplayList=function(e,t){qa&&Z.Utils.clearDisplay(qa),tn&&Z.Utils.clearDisplay(tn),on&&Z.Utils.clearDisplay(on),"undefined"!=typeof e&&null!==e&&e.length>0&&(t?Vr=e:Nr=e),"inline-block"==Qa.display&&Gt()},this.clearHotspotFilterByDisplayList=function(){"undefined"!=typeof Nr&&Z.Utils.arrayClear(Nr),"undefined"!=typeof Vr&&Z.Utils.arrayClear(Vr),"inline-block"==Qa.display&&Xt()},this.getHotspotTarget=function(e){return jt(e)},this.getLabelIDsInCurrentView=function(e,t,i){for(var a=[],n=new Kt(t),l=Zn.getZoom(),o=n.box.l,r=n.box.r,s=n.box.t,u=n.box.b,d=0,p=Dr.length;p>d;d++){var c=Dr[d];if(i){var Z=new Mt(c,n,null,!1),g=Z.w/2/l,m=Z.h/2/l;o=n.box.l-g,r=n.box.r+g,s=n.box.t-m,u=n.box.b+m}if(c.x>o&&c.x<r&&c.y>s&&c.y<u){var h=e?c.internalID:c.id;a[a.length]=h}}return a},this.getHotspots=function(){return Dr},this.getHotspotsVisibility=function(){return"inline-block"==Qa.display},this.setHotspotsVisibility=function(e){Qa.display=e?"inline-block":"none",Xt()},this.setHotspotVisibility=function(e,t){var i=e.firstChild;if(i&&i.style){i.style.visibility="visible";var a=t?"visible":"hidden",n=t?"":"#FFFFFF",l=t?1:.01;i.style.backgroundColor=n,Z.Utils.setOpacity(i,l);var o=e.firstChild.childNodes[1];o&&o.style&&(o.style.visibility=a);var r=e.id.substring(3,e.id.length),s=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",r);if(-1!=s){var u=Dr[s];u.visibility=t,"polygon"==u.media&&Vi(!0)}}},this.setHotspotsVisibilityByFilter=function(e,t,i){if(Dr.length>0)if(qa&&qa.childNodes.length>0){for(var a=0,n=Dr.length;n>a;a++)if(Dr[a][e]==t){var l=Dr[a].internalID,o=document.getElementById("hot"+l);null!==o&&Zn.setHotspotVisibility(o,i)}}else{window.setTimeout(function(){setHotspotsVisibilityByFilter(e,t,i)},100)}return i},this.setHotspotVisibilityByID=function(e,t,i){var a=i?"internalID":"id";if(Dr.length>0)if(qa&&qa.childNodes.length>0){var n=Z.Utils.arrayIndexOfObjectValue(Dr,a,e);if(-1!=n){var l=Dr[n].internalID,o=document.getElementById("hot"+l);null!=o&&Zn.setHotspotVisibility(o,t)}}else{window.setTimeout(function(){setHotspotVisibilityByID(e,t)},100)}},this.getCurrentLabel=function(){return kr},this.setCurrentLabel=function(e,t){if(t)var i=Z.Utils.arrayIndexOfObjectValue(Dr,"internalID",e);else var i=Z.Utils.arrayIndexOfObjectValue(Dr,"id",e);-1!=i&&(kr=Dr[i],Mr=kr.internalID,Xt())},this.setEditModeLabel=function(e){var t=Sa.toString(),i=Z.labelMode;Z.labelMode=e,Z.Utils.removeEventListener(document,"mousemove",ua),Z.Utils.removeEventListener(document,"touchmove",ua);var a=parseInt(Z.Utils.getResource("ALERT_HOWTOEDITMESSAGEDURATION"),10);if(("view"!=e||null!==Z.editMode)&&Z.Utils.showMessage(Z.Utils.getResource("ALERT_HOWTOEDITMODE"+e.toUpperCase()),!1,a,"center",!0),Z.overlayMessage&&(Z.overlayMessage.parentNode.style.display="none"),"edit"==Z.editMode&&"editLabel"==Z.editing&&(Zn.modifyHotspot(Mr,"mediaType",e,!0,!0),"measure"==e)){var n=kr&&kr.polygonPts&&kr.polygonPts.length>0;if(n&&"rectangle"!=i&&"polygon"!=i&&"measure"!=i&&Zn.modifyHotspot(Mr,"polygonPts",null,!0,!0),Zn.modifyHotspot(Mr,"image",null,!0,!0),Zn.modifyHotspot(Mr,"media","polygon",!1,!0),n){var l=new Z.Utils.Point(kr.polygonPts[0].x,kr.polygonPts[0].y);Bi(Mr,l)}}if(Z.Toolbar&&0!=Z.annotationPanelVisible&&Z.measureVisible){var o=document.getElementById("buttonMeasure"+t),r=document.getElementById("buttonMeasureExit"+t);o&&r&&(o.style.display="measure"==Z.labelMode?"none":"inline-block",r.style.display="measure"==Z.labelMode?"inline-block":"none")}Gr=null,Br=null,Wr=!1,Xr=!0,Fr?Vi():Xt()},this.setDrawingColor=function(e,t){var i,a=Z.annotationFileShared?"0":Sa.toString();switch(e){case"buttonColor0"+a:i="#FFFFFF";break;case"buttonColor1"+a:i="#FFFF00";break;case"buttonColor2"+a:i="#00FFFF";break;case"buttonColor3"+a:i="#800080";break;case"buttonColor4"+a:i="#008000";break;case"buttonColor5"+a:i="#FF0000";break;case"buttonColor6"+a:i="#0000FF";break;case"buttonColor7"+a:i="#000000"}as=Jr=lineStrokeColor=i;var n="#FFFFFF"==i?"#000000":"#FFFFFF";t||null===Mr||1!=Z.editMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing||(Zn.modifyHotspot(Mr,"textColor",i,!0,!0),Zn.modifyHotspot(Mr,"backColor",n,!0,!0),Zn.modifyHotspot(Mr,"lineColor",i,!1,!0))},this.tourStart=function(){if(Zn.tourStop(),!Z.tourStop){Z.tourPlaying=!0;var e=document.getElementById("buttonTourStop"),t=document.getElementById("buttonTourStart");e&&t&&(e.style.display="inline-block",t.style.display="none"),Z.screensaver?Z.constrainPanStrict||(Z.constrainPanStrict=!0):Z.Utils.playAudio(Er,Dr[br].audio);var i=Z.screensaver?0:ji(br,"next",Dr.length-1);null!==i&&Z.Utils.functionCallWithDelay(function(){Zn.goToDestination(i)},1500)}},this.tourStop=function(){Z.tourPlaying=!1;var e=document.getElementById("buttonTourStop"),t=document.getElementById("buttonTourStart");e&&t&&(e.style.display="none",t.style.display="inline-block")},this.priorDestination=function(e){Z.tourPlaying&&e&&Zn.tourStop(),Z.screensaver?Zn.zoomAndPanToView(Z.priorX,Z.priorY,Z.priorZ,Z.priorR):destinationChange("prior")},this.nextDestination=function(e){Z.tourPlaying&&e&&Zn.tourStop(),destinationChange("next")},destinationChange=function(e){var t;if(Z.screensaver){var i=Z.screensaverSpeed>0?8e3/Z.screensaverSpeed:3e3;Z.Utils.functionCallWithDelay(function(){Zn.goToDestination(0)},i)}else if("undefined"!=typeof ps&&null!==ps&&ps.length>0){Z.Utils.playAudio(Er,Dr[br].audio);var a=Z.tourPlaying?Dr[br].showFor:0;Z.Utils.stringValidate(Dr[br].audio)&&(a+=500),t=ji(br,e,Dr.length-1),null!==t?(Z.screensaver||Z.Utils.loadAudio(Dr[t].audio),Z.Utils.functionCallWithDelay(function(){Zn.goToDestination(t)},a)):Zn.tourStop()}},this.goToDestination=function(e){if(Z.tourStop)Zn.tourStop(),Z.tourStop=!1;else{var t,i,a,n,l=Z.tourPlaying?Zn.nextDestination:null;if(Z.screensaver){t=Z.Utils.getRandomInt(1,Z.imageW),i=Z.Utils.getRandomInt(1,Z.imageH),a=Z.Utils.getRandomInt(100*Z.minZ,100*Z.maxZ)/100,Z.imageX-t<500&&(t+=500,t>Z.imageW&&(t-=1e3)),Z.imageY-i<500&&(i+=500,i>Z.imageH&&(i-=1e3)),Z.imageZ-a<.3&&(a+=.3,a>Z.maxZ&&(a-=.6)),n=0;var o=Z.screensaverSpeed>0?8e3/Z.screensaverSpeed:null;null!==o?Zn.zoomAndPanToView(t,i,a,n,o,null,l):Zn.setView(t,i,a,n,l)}else{br=e;var r=Dr[e];switch(t=r.x,i=r.y,a=r.z/100,n=r.rotation,o=r.changeFor,Dr.transition){case"ZoomAndPanToView":Zn.zoomAndPanToView(t,i,a,n,o,null,l);break;case"SetView":Zn.setView(t,i,a,n,l);break;default:Zn.zoomAndPanToView(t,i,a,n,o,null,l)}var s=Z.Utils.arrayIndexOfObjectValue(ps.options,"value",r.internalID.toString());-1!=s&&(ps.selectedIndex=s)}}},this.parseSlidesXML=function(e){Z.Utils.arrayClear(wr),Z.Utils.arrayClear(Or),Lr=Z.Utils.getResource("DEFAULT_SLIDESHOWAUTOSTART"),xr=Z.Utils.getResource("DEFAULT_SLIDESHOWAUTOLOOP"),Ar=Z.Utils.getResource("DEFAULT_SLIDELISTPOSITION"),Sr=Z.Utils.getResource("DEFAULT_SLIDELISTSOURCE"),Z.slideListTitle=Z.Utils.getResource("UI_SLIDELISTTITLE");var t=e.getElementsByTagName("SETUP")[0];if(t){var i=t.getAttribute("AUTOSTART");Z.Utils.stringValidate(i)&&(Lr="0"!=i&&"false"!=i);var a=t.getAttribute("AUTOLOOP");Z.Utils.stringValidate(a)&&(xr="0"!=a&&"false"!=a);var n=t.getAttribute("CHOICELIST");Z.Utils.stringValidate(n)&&(Ar=n);var l=t.getAttribute("LISTSOURCE");Z.Utils.stringValidate(l)&&(Sr=l);var o=t.getAttribute("LISTTITLE");Z.Utils.stringValidate(o)&&(Z.slideListTitle=o)}for(var r=e.getElementsByTagName("SLIDE"),s=0,u=r.length;u>s;s++){var d=new zi(r[s]);wr[wr.length]=d;var p="NAME"==Sr?d.name:d.media.substring(d.media.lastIndexOf("/")+1,d.media.length);Or[Or.length]={text:p,value:d.internalID}}Xi(Ar,Z.slideListTitle,Or),Zn.initializeAudioMuteButtons(),null===Z.imagePath||"null"==Z.imagePath||-1!=Z.imagePath.indexOf("zSlidePath")?Zn.goToSlide(0,!0):Lr&&Zn.slideshowStart()},this.slideshowStart=function(e){Zn.slideshowStop(),Z.slideshowPlaying=!0;var t=document.getElementById("buttonSlideshowStop"),i=document.getElementById("buttonSlideshowStart");t&&i&&(t.style.display="inline-block",i.style.display="none"),Z.Utils.playAudio(Er,wr[yr].audio);var a=Z.slideshowPlaying?wr[yr].showFor:0,n=e?0:ji(yr,"next",wr.length-1);null!==n&&(Z.Utils.loadAudio(wr[n].audio),Z.Utils.functionCallWithDelay(function(){Zn.goToSlide(n,null,null,!0)},a))},this.slideshowStop=function(){Z.slideshowPlaying=!1;var e=document.getElementById("buttonSlideshowStop"),t=document.getElementById("buttonSlideshowStart");e&&t&&(e.style.display="none",t.style.display="inline-block")},this.priorSlide=function(e){Z.slideshowPlaying&&e&&Zn.slideshowStop(),Yi("prior")},this.nextSlide=function(e){Z.slideshowPlaying&&e&&Zn.slideshowStop(),Yi("next")},this.goToSlide=function(e,t,i,a){if(Z.slideshowPlaying||t||i||a){yr=e;var n=wr[e],l=Z.Utils.parametersToDelimitedString(Z.parameters,"&"),o=Ki(n),r=Z.Utils.stringValidate(o)?"&":"",s=l+r+o;switch(n.transition){case"Fade":Z.Viewer.setImageWithFade(n.media,s,t);break;case"None":Z.Viewer.setImage(n.media,s,t);break;default:Z.Viewer.setImageWithFade(n.media,s,t)}var u=Z.Utils.arrayIndexOfObjectValue(Ur.options,"value",n.internalID.toString());-1!=u&&(Ur.selectedIndex=u)}},this.slideTransitionTimeoutHandler=function(e,t,i,a){a&&(Z.Viewer.setImage(t,i,a),e="in"),window.clearTimeout(Z.slideTransitionTimeout),Z.slideTransitionTimeout=null,"out"==e?Z.slideOpacity>=0?(Z.slideOpacity-=Rr,e="out"):(Z.slideOpacity=0,e="in",Z.setCallback("viewUpdateComplete",function(){Z.slideTransitionTimeout=window.setTimeout(function(){Z.Viewport.slideTransitionTimeoutHandler(e,t,i)},50)}),Z.Viewer.setImage(t,i,null)):(0==Z.slideOpacity&&(Z.Utils.playAudio(Er,wr[yr].audio),Z.clearCallback("viewUpdateComplete",function(){Z.slideTransitionTimeout=window.setTimeout(function(){Z.Viewport.slideTransitionTimeoutHandler(e,t,i)},50)})),Z.slideOpacity<=1?(Z.slideOpacity+=Rr,e="in"):(Z.slideOpacity=1,e=null)),Pa&&Z.Utils.setOpacity(Pa,Z.slideOpacity),Z.NavigatorDisplay&&Z.Utils.setOpacity(Z.NavigatorDisplay,Z.slideOpacity),null!==e&&0!=Z.slideOpacity&&(Z.slideTransitionTimeout=window.setTimeout(function(){Z.Viewport.slideTransitionTimeoutHandler(e,t,i)},50))},this.initializeAudioMuteButtons=function(){if(Z.audioContent){var e=document.getElementById("buttonAudioOn");e&&(e.style.display="inline-block")}},this.audioMute=function(e){Z.audioMuted=e;var t=document.getElementById("buttonAudioMuted"),i=document.getElementById("buttonAudioOn");t&&i&&(e?(t.style.display="inline-block",i.style.display="none"):(t.style.display="none",i.style.display="inline-block"))},this.setView=function(e,t,i,a,n,l){Qi(e,t,i,a,n,l)},this.zoom=function(e){if("stop"!=e||"stop"!=Z.zooming){switch(e){case"out":_o>=0&&(_o-=ko);break;case"in":0>=_o&&(_o+=ko);break;case"stop":_o=0}Z.zooming=0==_o?"stop":_o>0?"in":"out",0!=_o?Ho||((0>_o&&Z.imageZ>Z.minZ||_o>0&&Z.imageZ<Z.maxZ)&&(Zn.toggleWatermarks(!1),Dr&&Dr.length>39&&Zn.setHotspotsVisibility(!1)),Z.useCanvas||Z.Utils.clearDisplay(Ya),Ho=window.setTimeout(Ji,zo)):(ta(),Zn.updateView(),Zn.toggleWatermarks(!0),Dr&&Dr.length>39&&Zn.setHotspotsVisibility(!0))}},this.pan=function(e){if(!("horizontalStop"==e&&"stop"==Z.panningX||"verticalStop"==e&&"stop"==Z.panningY)){switch(e){case"left":0>=Eo&&(Eo+=bo);break;case"up":0>=vo&&(vo+=bo);break;case"down":vo>=0&&(vo-=bo);break;case"right":Eo>=0&&(Eo-=bo);break;case"horizontalStop":Eo=0;break;case"verticalStop":vo=0;break;case"stop":Eo=0,vo=0}Z.panningX=0==Eo?"stop":Eo>0?"left":"right",Z.panningY=0==vo?"stop":vo>0?"up":"down",Mo=Z.imageX*dt(Nn,1),Fo=Z.imageY*dt(Nn,1),0!=Eo||0!=vo?Ho||(Zn.toggleWatermarks(!1),Z.useCanvas||Z.Utils.clearDisplay(Ya),Dr&&Dr.length>39&&Zn.setHotspotsVisibility(!1),Ho=window.setTimeout(Ji,zo)):(ta(),Zn.updateView(),Zn.toggleWatermarks(!0),Dr&&Dr.length>39&&Zn.setHotspotsVisibility(!0))}},this.zoomAndPanToView=function(e,t,i,a,n,l,o){if(Zn.zoomAndPanAllStop(),Z.clickZoomAndPanBlock)return void(Z.clickZoomAndPanBlock=!1);
("undefined"==typeof e||null===e)&&(e=Z.imageX),("undefined"==typeof t||null===t)&&(t=Z.imageY),("undefined"==typeof i||null===i)&&(i=Z.imageZ),("undefined"==typeof a||null===a)&&(a=Z.imageR),("undefined"==typeof n||null===n)&&(n=Wo),("undefined"==typeof l||null===l)&&(l=Yo),("center"==e||isNaN(parseFloat(e)))&&(e=Z.imageCenterX),("center"==t||isNaN(parseFloat(t)))&&(t=Z.imageCenterY),(-1==i||isNaN(parseFloat(i)))&&(t=Z.fitZ),Zn.toggleWatermarks(!1),Z.useCanvas||Z.Utils.clearDisplay(Ya),Dr&&Dr.length>39&&Zn.setHotspotsVisibility(!1),("undefined"==typeof e||null===e)&&(e=Z.initialX),("undefined"==typeof t||null===t)&&(t=Z.initialY),("undefined"==typeof a||null===a)&&(a=Z.imageR),"undefined"==typeof i||null===i?i=Z.initialZ:i>1&&2>i&&i%1!=0?i=1:i>1?i/=100:i>.99&&1>i&&100*i%1!=0&&(i=1);var r=ct(e,t,i,a,"image");e=r.x,t=r.y,i=Zt(i),(Math.round(e)!=Math.round(Z.imageX)||Math.round(t)!=Math.round(Z.imageY)||Math.round(1e5*i)!=Math.round(1e5*Z.imageZ)||Math.round(a)!=Math.round(Z.imageR))&&(Z.interactivityOff=!0,jo=0,ea(e,t,i,a,n,l,o))},this.zoomAndPanAllStop=function(e,t){Z.interactivityOff||(Ko&&ia(),Z.tourPlaying&&t&&(Zn.tourStop(),e=!1),Z.slideshowPlaying&&t&&(Zn.slideshowStop(),e=!1),Z.smoothPan&&null!==Do&&(Z.mouseIsDown||ca(!0),e=!0),e||Zn.updateView())},this.syncViewportRelated=function(e,t,i,a,n,l){("undefined"==typeof e||e)&&Vt(),("undefined"==typeof t||t)&&Xt(),("undefined"==typeof i||i)&&mt(),("undefined"==typeof a||a)&&ht(),("undefined"==typeof n||n)&&ft(),"undefined"!=typeof l&&l&&syncToolbarImageSetSliderToViewport(Z.viewportCurrentID)},this.scaleTierToZoom=function(e,t){var i=aa(e,t);i&&Zn.syncViewportRelated()},this.reset=function(e){Z.maskingSelection&&Z.maskClearOnUserAction&&Zn.clearMask(),e?Zn.zoomAndPanToView(Z.priorX,Z.priorY,Z.priorZ,Z.priorR):Zn.zoomAndPanToView(Z.initialX,Z.initialY,Z.initialZ,Z.initialR),qi(!0)},this.toggleWatermarks=function(e){if(Ka){var t="inline-block"==Ka.display,i="undefined"!=typeof e&&null!==e?e:!t;Ka.display=i?"inline-block":"none"}},this.toggleConstrainPan=function(e){if(Z.constrainPan="undefined"!=typeof e&&null!==e?e:!Z.constrainPan,Z.constrainPan){var t=parseFloat(_a.left),i=parseFloat(_a.top),a=ct(t,i,Z.imageZ,Z.imageR,"container");Da.left=a.x+"px",Da.top=a.y+"px",Zn.updateView()}},this.toggleSmoothPan=function(){ca(),Z.smoothPan=!Z.smoothPan},this.toggleBackfill=function(){var e=document.getElementById("viewportBackfillDisplay"+Sa.toString());if(e){var t=e.style;t.display="none"==t.display?"inline-block":"none"}},this.toggleDisplay=function(){var e=document.getElementById("viewportDisplay"+Sa.toString());e&&(_a=e.style,_a.display="none"==_a.display?"inline-block":"none")},this.toggleFullViewModeExternal=function(){lr=!0,Zn.toggleFullViewMode()},this.toggleFullViewMode=function(e,t){Z.maskingSelection&&Z.maskClearOnUserAction&&Zn.clearMask(),Z.ToolbarDisplay&&Z.Toolbar.show(!1);var i=null,a=null;Z.fullViewPrior=Z.fullView,Z.fullView="undefined"!=typeof e&&null!==e?e:!Z.fullView;var n,l=document.body,o=l.style,r=document.documentElement.style,s=Z.ViewerDisplay.style,u=Z.Utils.getElementStyle(Z.pageContainer);if(Z.fullView?(Qo=o.width,Jo=o.height,$o=o.overflow,er=r.overflow,tr=Z.Utils.stringValidate(u.backgroundColor)&&"transparent"!=u.backgroundColor?u.backgroundColor:Z.Utils.stringValidate(o.backgroundColor)&&"transparent"!=o.backgroundColor?o.backgroundColor:Z.Utils.getResource("DEFAULT_FULLVIEWBACKCOLOR"),ir=s.position,ar=s.zIndex,Z.fullScreenSupported&&!Z.fullPageVisible?(qo=!0,Z.Utils.fullScreenView(Z.ViewerDisplay,!0),n=Z.Utils.getScreenSize()):(n=Z.Utils.getWindowSize(),Z.mobileDevice?(o.width=n.x,o.height=n.y):(o.width="100%",o.height="100%")),i=n.x,a=n.y,o.overflow="hidden",r.overflow="hidden",s.backgroundColor=tr,s.position="fixed",s.zIndex="99999999"):(o.overflow=$o,r.overflow=er,s.backgroundColor=tr,s.position="relative",s.zIndex=ar,Z.fullScreenSupported&&!Z.fullPageVisible&&Z.Utils.fullScreenView(Z.ViewerDisplay,!1,t),o.width=Qo,o.height=Jo,i=parseFloat(u.width),a=parseFloat(u.height),isNaN(i)&&(i=Z.ViewerDisplay.clientWidth),isNaN(a)&&(a=Z.ViewerDisplay.clientHeight),lr=!1),!Z.autoResize){Z.initialFullPage&&Zn.setSizeAndPosition(i,a);var d=Z.viewportCurrent.calculateZoomForResize(Z.viewportCurrent.getZoom(),Z.viewerW,Z.viewerH,i,a);Z.Viewer.resizeViewer(i,a,d)}na(Z.fullView),la(lr),Z.fullViewPrior=!1},this.rotateClockwise=function(){Zn.rotate(90,!0)},this.rotateCounterwise=function(){Zn.rotate(-90,!0)},this.rotate=function(e,t){if(!Z.interactivityOff)if(Z.rotationSupported){qi();var i=Z.imageR+e,a=gt(i);if(Z.interactivityOff=!0,t)Zn.zoomAndPanToView(Z.imageX,Z.imageY,Z.imageZ,i,600,12,function(){Z.imageR=a});else{if(Z.Utils.rotateElement(Da,i),0!=Z.imageR){var n=i-Z.imageR;Oa.rotate(n*Math.PI/180)}Z.imageR=a,Zn.zoomAndPanToView(Z.imageX,Z.imageY,Z.imageZ)}}else Z.Utils.showMessage(Z.Utils.getResource("ALERT_ROTATIONREQUIRESNEWERBROWSER"))},this.toggleEditModeMeasure=function(e){Zn.zoomAndPanAllStop(),Z.maskingSelection&&Z.maskClearOnUserAction&&Zn.clearMask(),"undefined"!=typeof e&&!e||"measure"==Z.labelMode?(null===Z.editMode&&"measure"==Z.labelMode&&Dr.length>0&&(Zn.deleteAllMeasureHotspots(),Mr=null),Zn.setEditModeLabel("view")):Zn.setEditModeLabel("measure")},this.fullScreenEscapeHandler=function(){qo?qo=!1:Zn.toggleFullViewMode(!1,!0)},this.mouseWheelHandler=function(e){if(Z.mouseWheelIsDown=!0,Z.mouseWheelCompleteTimer&&window.clearTimeout(Z.mouseWheelCompleteTimer),Z.mouseWheelCompleteTimer=window.setTimeout(Z.Viewer.mouseWheelCompleteHandler,Z.mouseWheelCompleteDuration),"zoom"==Z.sliderFocus){var t=e>0?ko:-ko,i=On*(1+t),a=Zn.convertTierScaleToZoom(Nn,i);if(constrainedZ=Zt(a),constrainedZ!=Z.imageZ){Z.zooming=e>0?"in":0>e?"out":"stop";{Zn.scaleTierToZoom(constrainedZ)}}}else"imageSet"==Z.sliderFocus&&(e>0?Z.Viewer.viewportNext():0>e&&Z.Viewer.viewportPrior())}},Z.ZoomifyToolbar=function(e){function t(t,i){X=i,Z.ToolbarDisplay=Z.Utils.createContainerElement("div","ToolbarDisplay","inline-block","absolute","visible","1px","1px","0px","1px","none","0px","transparent none","0px","0px","normal"),k=Z.ToolbarDisplay.style;var a=parseInt(Z.Utils.getResource("DEFAULT_UIELEMENTBASEZINDEX"),10);k.zIndex=(a+1).toString();{var n=new Z.Utils.Graphic("toolbarBackground",Z.skinPath,i[0],"1px","1px","0px","0px");parseFloat(Z.Utils.getResource("DEFAULT_BACKGROUNDALPHA")),Z.Utils.getResource("DEFAULT_BACKGROUNDCOLORNOALPHA")}if(Z.ToolbarDisplay.appendChild(n.elmt),W=t,Z.logoVisible){var o;if(Z.Utils.stringValidate(Z.logoCustomPath)){var s=Z.Utils.cacheProofPath(Z.logoCustomPath);o=new Z.Utils.Graphic("toolbarLogo",s,null,"1px","1px","1px","1px")}else o=new Z.Utils.Graphic("toolbarLogo",Z.skinPath,i[7],"1px","1px","1px","1px");if(Z.Utils.stringValidate(Z.logoLinkURL)){var u=document.createElement("a");u.setAttribute("href",Z.logoLinkURL),u.setAttribute("target",Z.Utils.getResource("UI_LOGOLINKTARGET")),u.setAttribute("title",Z.Utils.getResource("TIP_LOGO")),u.setAttribute("outline","none"),u.appendChild(o.elmt),Z.ToolbarDisplay.appendChild(u)}else o.elmt.setAttribute("title",Z.Utils.getResource("UI_LOGOLINKDISPLAY")),Z.ToolbarDisplay.appendChild(o.elmt);if(0==Z.toolbarVisible||1==Z.toolbarVisible){var p=new Z.Utils.Graphic("logoDivider",Z.skinPath,i[8],"1px","1px","1px","1px");Z.ToolbarDisplay.appendChild(p.elmt)}}var c=Z.Utils.createContainerElement("div","buttonContainer","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal","default");Z.ToolbarDisplay.appendChild(c),Z.Utils.addEventListener(c,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(c,"mouseover",P.backgroundEventsHandler),Z.Utils.addEventListener(c,"touchstart",Z.Utils.preventDefault);var g=new Z.Utils.Graphic("buttonBackground",Z.skinPath,i[0],"1px","1px","0px","0px");if(c.appendChild(g.elmt),Z.Utils.setOpacity(g.elmt,"0","#FBFAFA"),(0!=Z.toolbarVisible&&1!=Z.toolbarVisible||Z.mobileDevice)&&Z.minimizeVisible){var m=new Z.Utils.Button("buttonMinimize",null,Z.skinPath,i[9],i[10],i[11],"1px","1px","1px","1px","mouseover",S,"TIP_MINIMIZE");Z.ToolbarDisplay.appendChild(m.elmt);var h=new Z.Utils.Button("buttonExpand",null,Z.skinPath,i[12],i[13],i[14],"1px","1px","1px","1px","mouseover",S,"TIP_EXPAND");Z.ToolbarDisplay.appendChild(h.elmt)}var f=new Z.Utils.Button("buttonZoomOut",null,Z.skinPath,i[1],i[2],i[3],"1px","1px","1px","1px","mouseover",S,"TIP_ZOOMOUT");if(c.appendChild(f.elmt),Z.sliderZoomVisible){var T=new Z.Utils.Graphic("trackSliderZoom",Z.skinPath,i[15],"1px","1px","0px","0px","TIP_SLIDER");c.appendChild(T.elmt),Z.Utils.addEventListener(T.elmt,"mousedown",S),Z.Utils.addEventListener(T.elmt,"touchstart",S),Z.Utils.addEventListener(T.elmt,"mouseover",S);var b=new Z.Utils.Button("buttonSliderZoom",null,Z.skinPath,i[17],i[18],i[19],"1px","1px","1px","1px","mouseover",S,"TIP_SLIDER");c.appendChild(b.elmt)}var E=new Z.Utils.Button("buttonZoomIn",null,Z.skinPath,i[4],i[5],i[6],"1px","1px","1px","1px","mouseover",S,"TIP_ZOOMIN");if(c.appendChild(E.elmt),Z.panButtonsVisible){var v=new Z.Utils.Graphic("panDivider",Z.skinPath,i[20],"1px","1px","1px","1px");c.appendChild(v.elmt);var I=new Z.Utils.Button("buttonPanLeft",null,Z.skinPath,i[21],i[22],i[23],"1px","1px","1px","1px","mouseover",S,"TIP_PANLEFT");c.appendChild(I.elmt);var y=new Z.Utils.Button("buttonPanUp",null,Z.skinPath,i[24],i[25],i[26],"1px","1px","1px","1px","mouseover",S,"TIP_PANUP");c.appendChild(y.elmt);var U=new Z.Utils.Button("buttonPanDown",null,Z.skinPath,i[27],i[28],i[29],"1px","1px","1px","1px","mouseover",S,"TIP_PANDOWN");c.appendChild(U.elmt);var A=new Z.Utils.Button("buttonPanRight",null,Z.skinPath,i[30],i[31],i[32],"1px","1px","1px","1px","mouseover",S,"TIP_PANRIGHT");c.appendChild(A.elmt)}if(Z.resetVisible){var L=new Z.Utils.Button("buttonReset",null,Z.skinPath,i[33],i[34],i[35],"1px","1px","1px","1px","mouseover",S,"TIP_RESET");c.appendChild(L.elmt)}if(Z.fullScreenVisible||Z.fullPageVisible){if(null===Z.editMode){var x=new Z.Utils.Graphic("fullViewDivider",Z.skinPath,i[36],"1px","1px","1px","1px");c.appendChild(x.elmt)}var w=new Z.Utils.Button("buttonFullViewExit",null,Z.skinPath,i[40],i[41],i[42],"1px","1px","1px","1px","mouseover",S,"TIP_TOGGLEFULLVIEWEXIT");c.appendChild(w.elmt);var O=new Z.Utils.Button("buttonFullView",null,Z.skinPath,i[37],i[38],i[39],"1px","1px","1px","1px","mouseover",S,"TIP_TOGGLEFULLVIEW");c.appendChild(O.elmt)}if(Z.measureVisible&&null===Z.editMode){if(!Z.fullScreenVisible&&!Z.fullPageVisible){var R=new Z.Utils.Graphic("measureDivider",Z.skinPath,i[36],"1px","1px","1px","1px");c.appendChild(R.elmt)}if(null===Z.editMode){var D=new Z.Utils.Button("buttonMeasureExit",null,Z.skinPath,i[49],i[50],i[51],"1px","1px","1px","1px","mouseover",S,"TIP_TOGGLEMEASURINGEXIT");c.appendChild(D.elmt)}var N=new Z.Utils.Button("buttonMeasure",null,Z.skinPath,i[46],i[47],i[48],"1px","1px","1px","1px","mouseover",S,"TIP_TOGGLEMEASURING");c.appendChild(N.elmt)}if(Z.rotationVisible){var M=new Z.Utils.Graphic("rotateDivider",Z.skinPath,i[52],"1px","1px","1px","1px");c.appendChild(M.elmt);var F=new Z.Utils.Button("buttonRotateCounterwise",null,Z.skinPath,i[53],i[54],i[55],"1px","1px","1px","1px","mouseover",S,"TIP_ROTATECOUNTERWISE");c.appendChild(F.elmt);var _=new Z.Utils.Button("buttonRotateClockwise",null,Z.skinPath,i[56],i[57],i[58],"1px","1px","1px","1px","mouseover",S,"TIP_ROTATECLOCKWISE");c.appendChild(_.elmt)}if(Z.tour){var H=new Z.Utils.Graphic("tourDivider",Z.skinPath,i[59],"1px","1px","1px","1px");c.appendChild(H.elmt);var B=new Z.Utils.Button("buttonTourPrior",null,Z.skinPath,i[60],i[61],i[62],"1px","1px","1px","1px","mouseover",S,"TIP_TOURPRIOR");c.appendChild(B.elmt);var z=new Z.Utils.Button("buttonTourNext",null,Z.skinPath,i[63],i[64],i[65],"1px","1px","1px","1px","mouseover",S,"TIP_TOURNEXT");c.appendChild(z.elmt);var G=new Z.Utils.Button("buttonTourStart",null,Z.skinPath,i[66],i[67],i[68],"1px","1px","1px","1px","mouseover",S,"TIP_TOURSTART");c.appendChild(G.elmt);var Y=new Z.Utils.Button("buttonTourStop",null,Z.skinPath,i[69],i[70],i[71],"1px","1px","1px","1px","mouseover",S,"TIP_TOURSTOP");c.appendChild(Y.elmt)}if(Z.slideshow){var K=new Z.Utils.Graphic("slideshowDivider",Z.skinPath,i[59],"1px","1px","1px","1px");c.appendChild(K.elmt);var j=new Z.Utils.Button("buttonSlideshowPrior",null,Z.skinPath,i[60],i[61],i[62],"1px","1px","1px","1px","mouseover",S,"TIP_SLIDEPRIOR");c.appendChild(j.elmt);var q=new Z.Utils.Button("buttonSlideshowNext",null,Z.skinPath,i[63],i[64],i[65],"1px","1px","1px","1px","mouseover",S,"TIP_SLIDENEXT");c.appendChild(q.elmt);var Q=new Z.Utils.Button("buttonSlideshowStart",null,Z.skinPath,i[66],i[67],i[68],"1px","1px","1px","1px","mouseover",S,"TIP_SLIDESHOWSTART");c.appendChild(Q.elmt);var $=new Z.Utils.Button("buttonSlideshowStop",null,Z.skinPath,i[69],i[70],i[71],"1px","1px","1px","1px","mouseover",S,"TIP_SLIDESHOWSTOP");c.appendChild($.elmt)}if(Z.tour||Z.slideshow){var et=new Z.Utils.Button("buttonAudioOn",null,Z.skinPath,i[72],i[73],i[74],"1px","1px","1px","1px","mouseover",S,"TIP_AUDIOMUTE");c.appendChild(et.elmt);var tt=new Z.Utils.Button("buttonAudioMuted",null,Z.skinPath,i[75],i[76],i[77],"1px","1px","1px","1px","mouseover",S,"TIP_AUDIOON");c.appendChild(tt.elmt)}if(Z.imageSet){var it=new Z.Utils.Graphic("imageSetDivider",Z.skinPath,i[59],"1px","1px","1px","1px");c.appendChild(it.elmt);var at=new Z.Utils.Button("buttonImageSetPrior",null,Z.skinPath,i[60],i[61],i[62],"1px","1px","1px","1px","mouseover",S,"TIP_IMAGESETPRIOR");if(c.appendChild(at.elmt),Z.sliderImageSetVisible){var nt=new Z.Utils.Graphic("trackSliderImageSet",Z.skinPath,i[15],"1px","1px","0px","0px","TIP_SLIDER");c.appendChild(nt.elmt),Z.Utils.addEventListener(nt.elmt,"mousedown",S),Z.Utils.addEventListener(nt.elmt,"touchstart",S),Z.Utils.addEventListener(nt.elmt,"mouseover",S);var lt=new Z.Utils.Button("buttonSliderImageSet",null,Z.skinPath,i[17],i[18],i[19],"1px","1px","1px","1px","mouseover",S,"TIP_IMAGESETSLIDER");c.appendChild(lt.elmt)}var ot=new Z.Utils.Button("buttonImageSetNext",null,Z.skinPath,i[63],i[64],i[65],"1px","1px","1px","1px","mouseover",S,"TIP_IMAGESETNEXT");c.appendChild(ot.elmt)}if(1==Z.helpVisible||3==Z.helpVisible){var rt=new Z.Utils.Button("buttonHelp",null,Z.skinPath,i[43],i[44],i[45],"1px","1px","1px","1px","mouseover",S,"TIP_HELP");c.appendChild(rt.elmt)}if(Z.progressVisible){var st=Z.Utils.createContainerElement("div","progressTextBox","inline-block","absolute","hidden","1px","1px","1px","1px","none","0px","transparent none","0px","0px","normal",null,!0),ut=W[16];c.appendChild(st);var dt=document.createTextNode(Z.Utils.getResource("DEFAULT_PROGRESSTEXT"));st.appendChild(Z.Utils.createCenteredElement(dt,"progressTextBoxCenteredDiv")),null===J&&(J=Z.Utils.getResource("DEFAULT_PROGRESSTEXTCOLOR")),Z.Utils.setTextNodeStyle(dt,J,"verdana",ut+"px","none","normal","normal","normal","normal","1em","left","none"),Z.Utils.disableTextInteraction(dt)}Z.ViewerDisplay.appendChild(Z.ToolbarDisplay),Z.toolbarW=W[0],Z.toolbarCurrentW=-1==Z.toolbarW?Z.viewerW:Z.toolbarW,Z.toolbarH=V=W[1];var pt=1==Z.toolbarPosition?Z.viewerH-V:0;if(P.setSizeAndPosition(Z.toolbarCurrentW,Z.toolbarH,0,pt),e&&e.getStatus("initialized")){1==Z.toolbarVisible&&(e.setSizeAndPosition(Z.viewerW,Z.viewerH-Z.toolbarH,0,0),e.validateXYZDefaults(!0),e.setView(Z.initialX,Z.initialY,Z.initialZ));var ct=e.getZoom();d(ct),e.setDrawingColor("buttonColor0"+C,!0)}r(1==Z.toolbarVisible||2==Z.toolbarVisible||4==Z.toolbarVisible||7==Z.toolbarVisible),Z.Utils.addEventListener(Z.ToolbarDisplay,"mouseover",Z.Utils.stopPropagation),l(!0)}function i(t,i){("undefined"==typeof i||null===i)&&(i=Z.annotationFileShared?"0":e.getViewportID().toString());var a=document.getElementById("AnnotationPanelDisplay"+i);a&&(!t||Z.measureVisible&&null===Z.editMode?(a.style.display="none",Z.annotationPanelVisibleState=!1):(a.style.display="inline-block",Z.annotationPanelVisibleState=!0))}function a(){window.clearInterval(Q),Q=null;var e=document.getElementById("progressTextBoxCenteredDiv");if(e){var t=e.firstChild;t&&(t.nodeValue="")}}function n(){return D}function l(e){!D&&e&&(D=!0,Z.Utils.validateCallback("toolbarInitialized"),Z.Viewer.validateViewerReady("toolbarInitialized"))}function o(t,i){var a=t,n=i,l=W[2],o=W[3],r=W[4],s=W[5],u=W[6],d=W[7],p=W[8],c=W[9],g=W[10],m=W[11],h=W[12],f=W[13],T=W[14],b=W[15],E=0,v=(n-o)/2+1,I=(n-s)/2,y=(n-d)/2,U=1.3*y,S=y+4,A=y+2,L=1==Z.logoVisible?0:p/2,x=1==Z.logoVisible?0:p/2,w=p-(u-r),O=20,R=2,P=0;Z.panButtonsVisible&&(R+=4,P+=1),Z.resetVisible&&(R+=1),(Z.fullScreenVisible||Z.fullPageVisible)&&(R+=1,P+=1),Z.helpVisible&&(R+=1,Z.fullScreenVisible||Z.fullPageVisible||(P+=1)),Z.measureVisible&&(Z.fullScreenVisible||Z.fullPageVisible||(P+=1),R+=1),Z.rotationVisible&&(R+=2,P+=1),(Z.tour||Z.slideshow)&&(R+=3,P+=1,Z.audioContent&&(R+=1));var D=R*p+P*w;if(Z.sliderZoomVisible&&(D+=f),Z.imageSet&&Z.sliderImageSetVisible){var C=f,N=m,V=h;D+=C,z=!1}M=F=_=H=!1;var k=1==Z.logoVisible?l+2:0,X=0!=Z.toolbarVisible&&1!=Z.toolbarVisible&&0!=Z.minimizeVisible?p:0,G=k+X,Y=1==Z.panButtonsVisible?4*p+w:0,K=1==Z.resetVisible?p:0,j=G+O+D+O+T;j>a&&(M=!0,j-f>a&&(F=!0,j-f-T>a&&(_=!0,j-f-T-G>a&&(B=!0,j-f-T-G-K>a&&(H=!0,D-=Y),D-=K),G=0),T=0),D-=f);var q=(a-D)/2-O+3,Q=document.getElementById("toolbarBackground");Q&&(Q.style.width=a+"px",Q.style.height=n+"px",Q.firstChild.style.width=a+"px",Q.firstChild.style.height=n+"px");var J=document.getElementById("buttonContainer");J&&(J.style.width=D+2*O+"px",J.style.height=n+"px",J.style.left=q+"px");var $=document.getElementById("buttonBackground");$&&($.style.width=a+"px",Z.Utils.graphicSize($,parseFloat(J.style.width),parseFloat(J.style.height)),$.style.left="0px");var et=document.getElementById("toolbarLogo");if(et){var tt=et.style;if(tt)if(_)tt.display="none";else{tt.display="inline-block",Z.Utils.graphicSize(et,l,o),tt.left=E+"px",tt.top=v+"px",E+=l+2;var it=document.getElementById("logoDivider");if(it){Z.Utils.graphicSize(it,r,s);var at=it.style;at.left=E+"px",at.top=I+"px"}}}if(0!=Z.toolbarVisible&&1!=Z.toolbarVisible){var nt=document.getElementById("buttonMinimize"),lt=document.getElementById("buttonExpand");if(nt&&lt){var ot=nt.style,rt=lt.style;ot&&rt&&(_?(ot.display="none",rt.display="none"):(ot.display="inline-block",rt.display="inline-block",Z.Utils.buttonSize(nt,u,d),Z.Utils.buttonSize(lt,u,d),ot.left=E+L+"px",ot.top=U+"px",rt.left=E+x+"px",rt.top=U+"px"))}}E=O;var st=document.getElementById("buttonZoomOut");if(st){Z.Utils.buttonSize(st,u,d);var ut=st.style;ut.left=E+"px",ut.top=y+"px",E+=p}trsZ=document.getElementById("trackSliderZoom"),btsZ=document.getElementById("buttonSliderZoom"),trsZ&&btsZ&&(trszS=trsZ.style,btszS=btsZ.style,trszS&&btszS&&(M?(trszS.display="none",btszS.display="none"):(trszS.display="inline-block",btszS.display="inline-block",Z.Utils.graphicSize(trsZ,m,h),trszS.left=E-2+"px",trszS.top=S+"px",Z.Utils.buttonSize(btsZ,c,g),btszS.left=parseFloat(trszS.left)+"px",btszS.top=A+"px",E+=f)));var dt=document.getElementById("buttonZoomIn");if(dt){Z.Utils.buttonSize(dt,u,d);var pt=dt.style;pt.left=E+"px",pt.top=y+"px",E+=p+1}if(!H){var ct=document.getElementById("panDivider");if(ct){Z.Utils.graphicSize(ct,r,s);var Zt=ct.style;Zt.left=E+"px",Zt.top=I+"px",E+=w;var gt=document.getElementById("buttonPanLeft");if(gt){Z.Utils.buttonSize(gt,u,d);var mt=gt.style;mt.left=E+"px",mt.top=y+"px",E+=p}var ht=document.getElementById("buttonPanUp");if(ht){Z.Utils.buttonSize(ht,u,d);var ft=ht.style;ft.left=E+"px",ft.top=y+"px",E+=p}var Tt=document.getElementById("buttonPanDown");if(Tt){Z.Utils.buttonSize(Tt,u,d);var bt=Tt.style;bt.left=E+"px",bt.top=y+"px",E+=p}var Et=document.getElementById("buttonPanRight");if(Et){Z.Utils.buttonSize(Et,u,d);var vt=Et.style;vt.left=E+"px",vt.top=y+"px",E+=p}}}if(!B){var It=document.getElementById("buttonReset");if(It){Z.Utils.buttonSize(It,u,d);var yt=It.style;yt.left=E+"px",yt.top=y+"px",E+=p+1}}var Ut=document.getElementById("fullViewDivider");if(Ut){Z.Utils.graphicSize(Ut,r,s);var St=Ut.style;St.left=E+"px",St.top=I+"px",E+=w}var At=document.getElementById("buttonFullViewExit");if(At){Z.Utils.buttonSize(At,u,d);var Lt=At.style;Lt.left=E+"px",Lt.top=y+"px",Lt.display=Z.fullView?"inline-block":"none"}var xt=document.getElementById("buttonFullView");if(xt){Z.Utils.buttonSize(xt,u,d);var wt=xt.style;wt.left=E+"px",wt.top=y+"px",E+=p+1,wt.display=Z.fullView?"none":"inline-block"}var Ot=document.getElementById("measureDivider");if(Ot){Z.Utils.graphicSize(Ot,r,s);var Rt=Ot.style;Rt.left=E+"px",Rt.top=I+"px",E+=w}if(null===Z.editMode){var Pt=document.getElementById("buttonMeasureExit");if(Pt){Z.Utils.buttonSize(Pt,u,d);var Dt=Pt.style;Dt.left=E+"px",Dt.top=y+"px",Dt.display="measure"==Z.labelMode?"inline-block":"none"}}var nt=document.getElementById("buttonMeasure");if(nt){Z.Utils.buttonSize(nt,u,d);var ot=nt.style;ot.left=E+"px",ot.top=y+"px",E+=p+1,ot.display="measure"==Z.labelMode?"none":"inline-block"}var Ct=document.getElementById("rotateDivider");if(Ct){Z.Utils.graphicSize(Ct,r,s);var Nt=Ct.style;Nt.left=E+"px",Nt.top=I+"px",E+=w;var Vt=document.getElementById("buttonRotateCounterwise");if(Vt){Z.Utils.buttonSize(Vt,u,d);var kt=Vt.style;kt.left=E+"px",kt.top=y+"px",E+=p}var Mt=document.getElementById("buttonRotateClockwise");if(Mt){Z.Utils.buttonSize(Mt,u,d);var Ft=Mt.style;Ft.left=E+"px",Ft.top=y+"px",E+=p+1}}if(Z.tour){var _t=document.getElementById("tourDivider");if(_t){Z.Utils.graphicSize(_t,r,s);var Ht=_t.style;Ht.left=E+"px",Ht.top=I+"px",E+=w;var Bt=document.getElementById("buttonTourPrior");if(Bt){Z.Utils.buttonSize(Bt,u,d);var zt=Bt.style;zt.left=E+"px",zt.top=y+"px",E+=p+1}var Xt=document.getElementById("buttonTourNext");if(Xt){Z.Utils.buttonSize(Xt,u,d);var Gt=Xt.style;Gt.left=E+"px",Gt.top=y+"px",E+=p+1}var Wt=document.getElementById("buttonTourStop");if(Wt){Z.Utils.buttonSize(Wt,u,d);var Yt=Wt.style;Yt.left=E+"px",Yt.top=y+"px",Yt.display=Z.tourPlaying?"inline-block":"none"}var Kt=document.getElementById("buttonTourStart");if(Kt){Z.Utils.buttonSize(Kt,u,d);var jt=Kt.style;jt.left=E+"px",jt.top=y+"px",E+=p+1,jt.display=Z.tourPlaying?"none":"inline-block"}}}else if(Z.slideshow){var qt=document.getElementById("slideshowDivider");if(qt){Z.Utils.graphicSize(qt,r,s);var Qt=qt.style;Qt.left=E+"px",Qt.top=I+"px",E+=w;var Jt=document.getElementById("buttonSlideshowPrior");if(Jt){Z.Utils.buttonSize(Jt,u,d);var $t=Jt.style;$t.left=E+"px",$t.top=y+"px",E+=p+1}var ei=document.getElementById("buttonSlideshowNext");if(ei){Z.Utils.buttonSize(ei,u,d);var ti=ei.style;ti.left=E+"px",ti.top=y+"px",E+=p+1}var ii=document.getElementById("buttonSlideshowStop");if(ii){Z.Utils.buttonSize(ii,u,d);var ai=ii.style;ai.left=E+"px",ai.top=y+"px",ai.display=Z.slideshowPlaying?"inline-block":"none"}var ni=document.getElementById("buttonSlideshowStart");if(ni){Z.Utils.buttonSize(ni,u,d);var li=ni.style;li.left=E+"px",li.top=y+"px",E+=p+1,li.display=Z.slideshowPlaying?"none":"inline-block"}}}else if(null!==Z.imageSetPath){var oi=document.getElementById("imageSetDivider");if(oi){Z.Utils.graphicSize(oi,r,s);var ri=oi.style;ri.left=E+"px",ri.top=I+"px",E+=w;var si=document.getElementById("buttonImageSetPrior");if(si){Z.Utils.buttonSize(si,u,d);var ui=si.style;ui.left=E+"px",ui.top=y+"px",E+=p+1}trsiS=document.getElementById("trackSliderImageSet"),btsiS=document.getElementById("buttonSliderImageSet"),trsiS&&btsiS&&(trsisS=trsiS.style,btsisS=btsiS.style,trsisS&&btsisS&&(z?(trsisS.display="none",btsisS.display="none"):(trsisS.display="inline-block",btsisS.display="inline-block",Z.Utils.graphicSize(trsiS,N,V),trsisS.left=E-2+"px",trsisS.top=S+"px",Z.Utils.buttonSize(btsiS,c,g),btsisS.left=parseFloat(trsisS.left)+"px",btsisS.top=A+"px",E+=C)));var di=document.getElementById("buttonImageSetNext");if(di){Z.Utils.buttonSize(di,u,d);var pi=di.style;pi.left=E+"px",pi.top=y+"px",E+=p+1}}}if(Z.tour||Z.slideshow){var ci=document.getElementById("buttonAudioMuted");if(ci){Z.Utils.buttonSize(ci,u,d);var Zi=ci.style;Zi.left=E+"px",Zi.top=y+"px",Zi.display="none"}var gi=document.getElementById("buttonAudioOn");if(gi){Z.Utils.buttonSize(gi,u,d);var mi=gi.style;mi.left=E+"px",mi.top=y+"px",E+=p+1,mi.display="none"}e.initializeAudioMuteButtons()}if(1==Z.helpVisible||3==Z.helpVisible){var hi=document.getElementById("buttonHelp");if(hi){Z.Utils.buttonSize(hi,u,d);var fi=hi.style;fi.left=E+"px",fi.top=y+"px"}}var Ti=document.getElementById("progressTextBox");if(Ti){var bi=Ti.style;bi&&(F?bi.display="none":(bi.display="inline-block",bi.width=T+"px",bi.height=b+"px",bi.left=a-parseFloat(J.style.left)-parseFloat(bi.width)+"px",bi.top=(n-parseFloat(bi.height))/2+"px"))}}function r(e){Z.toolbarVisible<4&&!Z.mobileDevice||8==Z.toolbarVisible?s(e):u(!e)}function s(e){k&&(k.display=e?"inline-block":"none")}function u(e){if(Z.ToolbarMinimized=e,k){var t=document.getElementById("buttonContainer"),i=document.getElementById("toolbarBackground"),a=document.getElementById("buttonMinimize"),n=document.getElementById("buttonExpand"),l=document.getElementById("logoDivider"),o=0;n&&!_&&(o=parseFloat(n.style.left)+parseFloat(n.style.width)+4);var r=Z.toolbarCurrentW;e?(t&&(t.style.display="none"),a&&n&&!_&&(l&&(l.style.display="none"),a.style.display="none",n.style.display="inline-block"),k.width=o+"px",i&&(i.style.width=o+"px")):(t&&(t.style.display="inline-block"),a&&n&&!_&&(l&&(l.style.display="inline-block"),a.style.display="inline-block",n.style.display="none"),k.width=r+"px",i&&(i.style.width=r+"px"))}}function d(e){if("undefined"!=typeof trszS&&"undefined"!=typeof btszS){var t=Z.maxZ-Z.minZ,i=(e-Z.minZ)/t,a=parseFloat(trszS.left),n=parseFloat(trszS.left)+parseFloat(trszS.width)-parseFloat(btszS.width),l=n-a,o=i*l+a;btszS.left=o+"px"}}function p(t){if("undefined"!=typeof trsZ&&"undefined"!=typeof trszS){var i,a=Z.Utils.getElementPosition(trsZ);i=Z.Utils.getMousePosition(t).x-a.x;var n=h(i,0,parseFloat(trszS.width));n<Z.minZ+.1&&(n=Z.minZ),n>Z.maxZ-.1&&(n=Z.maxZ);var l=n-e.getZoom();Z.zooming=l>0?"in":0>l?"out":"stop",e.scaleTierToZoom(n),Z.zooming="stop",e.updateView()}}function c(e){if("undefined"!=typeof btsZ){K=!0;var t=Z.Utils.getMousePosition(e);btsZ.mouseXPrior=t.x,btsZ.mouseYPrior=t.y}}function g(){if("undefined"!=typeof trszS&&"undefined"!=typeof btsZ&&"undefined"!=typeof btszS){var t=parseFloat(trszS.left),i=parseFloat(trszS.left)+parseFloat(trszS.width)-parseFloat(btszS.width),a=parseFloat(btszS.left)+(q.x-btsZ.mouseXPrior);t>a?a=t:a>i?a=i:btsZ.mouseXPrior=q.x,btszS.left=a+"px";var n=h(a,t,i),l=n-e.getZoom();Z.zooming=l>0?"in":0>l?"out":"stop",e.scaleTierToZoom(n)}}function m(){K=!1,Z.zooming="stop",e.updateView()}function h(e,t,i){var a=i-t,n=(e-t)/a,l=Z.maxZ-Z.minZ,o=Z.minZ+l*n;return o}function f(){if(trsisS&&btsisS){var e=Z.imageSetLength-1,t=Z.viewportCurrentID/e,i=parseFloat(trsisS.left),a=parseFloat(trsisS.left)+parseFloat(trsisS.width)-parseFloat(btsisS.width),n=a-i,l=t*n+i;btsisS.left=l+"px"}}function T(e){if(trsiS&&trsisS){var t,i=Z.Utils.getElementPosition(trsiS);t=Z.Utils.getMousePosition(e).x-i.x;var a=I(t,0,parseFloat(trsisS.width));0>a&&(a=0),a>Z.imageSetLength-1&&(a=Z.imageSetLength-1);var n=a!=Z.viewportCurrentID;n&&Z.Viewer.viewportSelect(a,!0),f(a)}}function b(e){if(btsiS){et=!0;var t=Z.Utils.getMousePosition(e);btsiS.mouseXPrior=t.x,btsiS.mouseYPrior=t.y}}function E(){if(trsiS&&btsiS&&btsiS){var e=parseFloat(trsisS.left),t=parseFloat(trsisS.left)+parseFloat(trsisS.width)-parseFloat(btsisS.width),i=parseFloat(btsisS.left)+(it.x-btsiS.mouseXPrior);e>i?i=e:i>t?i=t:btsiS.mouseXPrior=it.x,btsisS.left=i+"px";var a=I(i,e,t),n=a!=Z.viewportCurrentID;n&&Z.Viewer.viewportSelect(a,!0)}}function v(){et=!1,Z.Viewer.viewportSelect(Z.viewportCurrentID,!0)}function I(e,t,i){var a=i-t,n=(e-t)/a,l=Z.imageSetLength-1,o=Math.round(l*n);return o}function y(e){it=new Z.Utils.Point(e.clientX,e.clientY)}function U(e){var t=Z.Utils.getFirstTouch(e);if(t){{t.target}it=new Z.Utils.Point(t.pageX,t.pageY)}}function S(t){var t=Z.Utils.event(t);if(t){var i=t.type,a=Z.Utils.target(t);if(a){var n=a.parentNode;if(n){var l=n;tbID=n.id}}var o=Z.Utils.relatedTarget(t)}if("mousedown"==i&&e&&"buttonAudioOn"!=tbID&&"buttonAudioMuted"!=tbID&&(e.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&e.clearMask()),(!Z.interactivityOff||"mousedown"!=i&&"mouseup"!=i||"buttonRotateClockwise"==tbID||"buttonRotateCounterwise"==tbID)&&(!o||"[object HTMLSelectElement]"!=o&&"[object HTMLOptionElement]"!=o)&&!Z.Utils.isRightMouseButton(t)&&(Z.touchSupport&&t.preventDefault(),(tbID&&-1!=tbID.indexOf("viewportContainer")||K||et)&&(K?n=document.getElementById("buttonSliderZoom"):et&&(n=document.getElementById("buttonSliderImageSet")),n&&(tbID=n.id)),O(n,i),tbID&&"buttonBackground"!=tbID&&i))switch(i){case"mouseover":"trackSliderZoom"!=tbID&&"trackSliderImageSet"!=tbID?(Z.Utils.removeEventListener(n.childNodes[0],"mouseover",S),Z.Utils.addEventListener(n.childNodes[1],"mousedown",S),Z.Utils.addEventListener(n.childNodes[1],"mouseout",S),K&&l&&Z.Utils.addEventListener(l.childNodes[0],"mouseup",S),et&&l&&Z.Utils.addEventListener(l.childNodes[0],"mouseup",S),"buttonZoomIn"==tbID||"buttonSliderZoom"==tbID||"buttonZoomOut"==tbID?Z.sliderFocus="zoom":("buttonImageSetPrior"==tbID||"buttonSliderImageSet"==tbID||"buttonImageSetNext"==tbID)&&(Z.sliderFocus="imageSet")):(Z.Utils.addEventListener(n.childNodes[0],"mouseout",S),Z.sliderFocus="trackSliderImageSet"==tbID?"imageSet":"zoom");break;case"mousedown":Z.buttonIsDown=!0,!Z.fullView&&document.activeElement&&document.activeElement.blur(),"trackSliderZoom"!=tbID&&"trackSliderImageSet"!=tbID?(Z.Utils.removeEventListener(n.childNodes[1],"mousedown",S),Z.Utils.removeEventListener(n.childNodes[1],"mouseout",S),Z.Utils.addEventListener(n.childNodes[2],"mouseup",S),Z.Utils.addEventListener(n.childNodes[2],"mouseout",S),"buttonSliderZoom"==tbID&&(c(t),x(t),Z.Utils.addEventListener(document,"mousemove",x),j||(j=window.setInterval(g,Y)),Z.Utils.addEventListener(document,"mouseup",S)),"buttonSliderImageSet"==tbID&&(b(t),y(t),Z.Utils.addEventListener(document,"mousemove",y),tt||(tt=window.setInterval(E,$)),Z.Utils.addEventListener(document,"mouseup",S))):Z.slidestack&&"trackSliderImageSet"==tbID&&Z.Utils.addEventListener(n,"mouseup",S),e&&A(t,tbID);break;case"mouseup":Z.buttonIsDown=!1,Z.Utils.removeEventListener(n.childNodes[2],"mouseup",S),Z.Utils.removeEventListener(n.childNodes[2],"mouseout",S),Z.Utils.addEventListener(n.childNodes[1],"mousedown",S),Z.Utils.addEventListener(n.childNodes[1],"mouseout",S),K&&l&&Z.Utils.removeEventListener(l.childNodes[0],"mouseup",S),et&&l&&Z.Utils.removeEventListener(l.childNodes[0],"mouseup",S),e&&A(t,tbID);break;case"mouseout":"trackSliderZoom"!=tbID&&"trackSliderImageSet"!=tbID?(Z.Utils.removeEventListener(n.childNodes[1],"mousedown",S),Z.Utils.removeEventListener(n.childNodes[1],"mouseout",S),Z.Utils.addEventListener(n.childNodes[0],"mouseover",S),e&&A(t,tbID),("buttonImageSetPrior"==tbID||"buttonSliderImageSet"==tbID||"trackSliderImageSet"==tbID||"buttonImageSetNext"==tbID||"buttonZoomIn"==tbID||"buttonSliderZoom"==tbID||"buttonZoomOut"==tbID)&&(Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom")):(Z.Utils.removeEventListener(n.childNodes[0],"mouseout",S),Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom");break;case"touchstart":"buttonSliderZoom"==tbID&&(c(t),w(t),Z.Utils.addEventListener(document,"touchmove",w),j||(j=window.setInterval(g,Y))),"buttonSliderImageSet"==tbID&&(b(t),U(t),Z.Utils.addEventListener(document,"touchmove",U),tt||(tt=window.setInterval(E,$))),Z.Utils.addEventListener(n,"touchend",S),Z.Utils.addEventListener(n,"touchcancel",S),e&&A(t,tbID);break;case"touchend":Z.Utils.addEventListener(n,"touchstart",S),e&&A(t,tbID);break;case"touchcancel":Z.Utils.addEventListener(n,"touchstart",S),e&&A(t,tbID);break;case"MSPointerDown":"buttonSliderZoom"==tbID&&(c(t),w(t),Z.Utils.addEventListener(document,"MSPointerMove",w),j||(j=window.setInterval(g,Y))),"buttonSliderImageSet"==tbID&&(b(t),U(t),Z.Utils.addEventListener(document,"MSPointerMove",U),tt||(tt=window.setInterval(E,$))),Z.Utils.addEventListener(n,"MSPointerUp",S),e&&A(t,tbID);
break;case"MSPointerUp":Z.Utils.addEventListener(n,"MSPointerDown",S),e&&A(t,tbID)}}function A(t,i){var a=t.type,n=Z.annotationFileShared?"0":C,l=t.altKey;if("mousedown"==a||"touchstart"==a)switch(R(),i){case"buttonMinimize":l?e.setHotspotsVisibility(!e.getHotspotsVisibility()):(P.minimize(!0),Z.Navigator&&Z.Navigator.setVisibility(!1));break;case"buttonExpand":l?e.setHotspotsVisibility(!e.getHotspotsVisibility()):(P.minimize(!1),Z.Navigator&&Z.Navigator.setVisibility(!0));break;case"buttonZoomOut":l||e.zoom("out");break;case"buttonSliderZoom":break;case"trackSliderZoom":p(t);break;case"buttonZoomIn":l||e.zoom("in");break;case"buttonPanLeft":e.pan("left");break;case"buttonPanUp":e.pan("up");break;case"buttonPanDown":e.pan("down");break;case"buttonPanRight":e.pan("right");break;case"buttonReset":e.reset(l);break;case"buttonFullView":break;case"buttonFullViewExit":break;case"buttonMeasure":e.toggleEditModeMeasure(!0);break;case"buttonMeasureExit":e.toggleEditModeMeasure(!1);break;case"buttonHelp":Z.Utils.showHelp(Z.annotations&&null===Z.editMode?Z.Utils.getResource("CONTENT_HELPTOOLBAR")+Z.Utils.getResource("CONTENT_HELPCONCATENATOR")+Z.Utils.getResource("CONTENT_HELPANNOTATIONVIEWING"):Z.Utils.getResource("CONTENT_HELPTOOLBAR"));break;case"buttonHelpMarkup"+n:Z.Utils.showHelp(Z.Utils.getResource("CONTENT_HELPMARKUP"));break;case"buttonHelpAnnotation"+n:Z.Utils.showHelp(Z.Utils.getResource("CONTENT_HELPANNOTATIONEDITING"));break;case"buttonRotateClockwise":e.rotateClockwise();break;case"buttonRotateCounterwise":e.rotateCounterwise();break;case"buttonTourPrior":e.priorDestination(!0);break;case"buttonTourNext":e.nextDestination(!0);break;case"buttonTourStart":e.tourStart();break;case"buttonTourStop":e.tourStop();break;case"buttonSlideshowPrior":e.priorSlide(!0);break;case"buttonSlideshowNext":e.nextSlide(!0);break;case"buttonSlideshowStart":e.slideshowStart();break;case"buttonSlideshowStop":e.slideshowStop();break;case"buttonAudioOn":e.audioMute(!0);break;case"buttonAudioMuted":e.audioMute(!1);break;case"buttonImageSetPrior":Z.animation&&Z.Viewer.viewportChange("backward");break;case"buttonSliderImageSet":break;case"trackSliderImageSet":Z.animation&&T(t);break;case"buttonImageSetNext":Z.animation&&Z.Viewer.viewportChange("forward");break;default:"buttonColor"==i.substr(0,11)&&e.setDrawingColor(i)}else"mouseup"==a||"touchend"==a||"touchcancel"==a?"buttonSliderZoom"==i||K?(j&&(window.clearInterval(j),j=null),L(),m()):"buttonSliderImageSet"==i||et?(tt&&(window.clearInterval(tt),tt=null),L(),v()):"buttonZoomOut"==i||"buttonZoomIn"==i?(e.zoom("stop"),0==Z.debug&&"buttonZoomOut"==i&&l&&Z.Utils.showGlobals()):"buttonPanLeft"==i||"buttonPanRight"==i?(e.pan("horizontalStop"),"buttonPanLeft"==i&&l&&e.toggleSmoothPan()):"buttonPanUp"==i||"buttonPanDown"==i?e.pan("verticalStop"):"buttonFullView"==i?e.toggleFullViewMode(!0):"buttonFullViewExit"==i?e.toggleFullViewMode(!1):"trackSliderImageSet"==i?Z.slidestack&&T(t):("buttonImageSetPrior"==i||"buttonImageSetNext"==i)&&(Z.animation?Z.Viewer.viewportChange("stop"):Z.slidestack&&("buttonImageSetPrior"==i?Z.Viewer.viewportChange("backward"):"buttonImageSetNext"==i&&Z.Viewer.viewportChange("forward"))):"mouseout"==a&&("buttonZoomOut"==i||"buttonZoomIn"==i?e.zoom("stop"):"buttonPanLeft"==i||"buttonPanRight"==i?e.pan("horizontalStop"):"buttonPanUp"==i||"buttonPanDown"==i?e.pan("verticalStop"):("buttonImageSetPrior"==i||"buttonImageSetNext"==i)&&Z.Viewer.viewportChange("stop"))}function L(){K&&(Z.Utils.removeEventListener(document,"mousemove",x),Z.Utils.removeEventListener(document,"mouseup",S),Z.Utils.removeEventListener(document,"touchmove",w)),et&&(Z.Utils.removeEventListener(document,"mousemove",y),Z.Utils.removeEventListener(document,"mouseup",S),Z.Utils.removeEventListener(document,"touchmove",U));for(var e=Z.ToolbarDisplay.childNodes,t=0,i=e.length;i>t;t++){var a=e[t],n=a.id;if(n&&-1!=n.indexOf("button"))if("buttonContainer"!=n&&"buttonContainerImageFilter"!=n)Z.Utils.setButtonDefaults(a);else for(var l=a.childNodes,o=0,r=l.length;r>o;o++){var s=l[o],u=s.id;u&&-1!=u.indexOf("button")&&Z.Utils.setButtonDefaults(s)}}}function x(e){q=new Z.Utils.Point(e.clientX,e.clientY)}function w(e){var t=Z.Utils.getFirstTouch(e);if(t){{t.target}q=new Z.Utils.Point(t.pageX,t.pageY)}}function O(e,t){if(-1!=e.id.indexOf("button")&&-1==e.id.indexOf("buttonContainer")){var i=e.firstChild,a=e.childNodes[1],n=e.childNodes[2];if(i&&a&&n){var l=i.style,o=a.style,r=n.style;l.visibility=o.visibility=r.visibility="hidden","mouseover"==t&&"buttonSliderZoom"==e.id&&K?r.visibility="visible":"mouseover"==t&&"buttonSliderImageSet"==e.id&&et?r.visibility="visible":"mouseover"==t||"mouseup"==t?o.visibility="visible":"mousedown"==t||"mousemove"==t||"touchstart"==t||"MSPointerDown"==t?r.visibility="visible":("mouseout"==t||"touchend"==t||"touchcancel"==t||"MSPointerUp"==t)&&(l.visibility="visible")}}}function R(){var e=document.activeElement.id;if(Z.Utils.stringValidate(e)&&(e=="poiNameTextElement"+C||e=="labelNameTextElement"+C||"captionTextElement"==e||"commentTextElement"==e||"tooltipTextElement"==e||"clickURLTextElement"==e||e=="noteNameTextElement"+C||e=="noteTextElement"+C)){var t=document.getElementById(e);t.blur()}}var P=this,D=!1,C=e.getViewportID().toString();Z.skinPath=Z.Utils.stringRemoveTrailingSlashCharacters(Z.skinPath);var N=new Z.NetConnector;N.loadXML(Z.skinPath+"/"+Z.Utils.getResource("DEFAULT_SKINXMLFILE"));var V,k,M,F,_,H,B,z,X=[],G=[],W=[],Y=parseInt(Z.Utils.getResource("DEFAULT_SLIDERTESTDURATIONZOOM"),10),K=!1,j=null,q=null,Q=null,J=null,$=parseInt(Z.Utils.getResource("DEFAULT_SLIDERTESTDURATIONIMAGESET"),10),et=!1,tt=null,it=null;this.getInitialized=function(){return n()},this.getSkinArray=function(){return X},this.getSkinSizes=function(){return W},this.show=function(e){r(e)},this.setVisibility=function(e){s(e)},this.minimize=function(e){u(e)},this.setVisibilityAnnotationPanel=function(e,t){i(e,t)},this.showProgress=function(){var e=document.getElementById("progressTextBox");if(e){var t=e.style;t&&(t.display="inline-block")}},this.hideProgress=function(){var e=document.getElementById("progressTextBox");if(e){var t=e.style;t&&(t.display="none")}},this.updateProgress=function(e,t){if(Z.progressVisible){Q&&window.clearInterval(Q);var i,n=document.getElementById("progressTextBoxCenteredDiv");if(n){var l=n.firstChild;if(l)if(0==e||0==t)l.nodeValue="llllllllll",Q=window.setInterval(a,parseInt(Z.Utils.getResource("DEFAULT_PROGRESSDURATION")),10);else{i=Math.round(100-t/e*100);var o=Math.round(i/10);l.nodeValue=Z.Utils.stringMultiply("l",o)}}}},this.setViewport=function(t){e=t,C=e.getViewportID().toString()},this.parseSkinXML=function(e){Z.skinMode=e.getElementsByTagName("SETUP")[0].attributes.getNamedItem("SKINMODE").nodeValue;var i,a;1==Z.skinMode||0==Z.skinMode&&!Z.mobileDevice?(i=e.getElementsByTagName("SETUP")[0].attributes.getNamedItem("FOLDERSTANDARD").nodeValue,a="SIZESSTANDARD"):(i=e.getElementsByTagName("SETUP")[0].attributes.getNamedItem("FOLDERLARGE").nodeValue,a="SIZESLARGE");var n=e.getElementsByTagName("SETUP")[0].attributes.getNamedItem("PROGRESSCOLOR");"undefined"!=typeof n&&null!==n&&(J=e.getElementsByTagName("SETUP")[0].attributes.getNamedItem("PROGRESSCOLOR").nodeValue);var l=[];l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("TOOLBARW").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("TOOLBARH").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("LOGOW").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("LOGOH").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("DIVIDERW").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("DIVIDERH").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("BUTTONW").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("BUTTONH").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("BUTTONSPAN").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("SLIDERBUTTONW").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("SLIDERBUTTONH").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("SLIDERTRACKW").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("SLIDERTRACKH").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("SLIDERSPAN").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("PROGRESSW").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("PROGRESSH").nodeValue),l[l.length]=parseFloat(e.getElementsByTagName(a)[0].attributes.getNamedItem("PROGRESSFONTSIZE").nodeValue);var o,r,s,u,d;if(o="edit"==Z.editMode?161:"markup"==Z.editMode?152:Z.imageFiltersVisible?100:Z.screensaver||Z.tourPath||Z.slidePath||Z.imageSetPath?77:Z.rotationVisible?58:Z.measureVisible?51:Z.helpVisible>0?45:Z.fullScreenVisible||Z.fullPageVisible?45:Z.resetVisible?35:Z.panButtonsVisible?32:Z.sliderZoomVisible?19:Z.minimizeVisible?14:Z.logoVisible?8:6,r=e.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN0"),null!==r&&(s=r.nodeValue),u=e.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN"+o.toString()),null!==u&&(d=u.nodeValue),"undefined"!=typeof s&&Z.Utils.stringValidate(s)&&"undefined"!=typeof d&&Z.Utils.stringValidate(d)){for(var p=!1,c=0,g=o+1;g>c;c++){var m=e.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN"+c).nodeValue;Z.Utils.stringValidate(m)?G[c]=i+"/"+m:(G[c]="null",p=!0)}p&&Z.Utils.showMessage(Z.Utils.getResource("ERROR_SKINXMLMISSINGNAMES")),t(l,G)}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_SKINXMLINVALID"))},this.setSizeAndPosition=function(e,t,i,a){"undefined"==typeof e||null===e?e=Z.toolbarVisible>0?Z.toolbarCurrentW:0:Z.toolbarCurrentW=e,("undefined"==typeof t||null===t)&&(t=Z.toolbarVisible>0?V:0),("undefined"==typeof i||null===i)&&(i=0),("undefined"==typeof a||null===a)&&(a=1==Z.toolbarPosition?Z.viewerH-V:0),k=Z.ToolbarDisplay.style,k.width=e+"px",k.height=t+"px",k.left=i+"px",k.top=a+"px",o(e,t)},this.syncSliderToViewportZoom=function(e){d(e)},this.syncSliderToViewportImageSet=function(e){f(e)},this.buttonEventsHandler=function(e){S(e)},this.backgroundEventsHandler=function(e){var e=Z.Utils.event(e),t=Z.Utils.relatedTarget(e);if(t){var i=t.parentNode;if(i){var a=i.id;a&&(K||et||-1==a.indexOf("button")||-1!=a.indexOf("buttonContainer")||Z.Utils.setButtonDefaults(t.parentNode))}}}},Z.ZoomifyNavigator=function(e){function t(i,a){var n="undefined"!=typeof a&&null!==a?!1:!0,l=n?e:a;if("unconverted"!=Z.tileSource)if("ZoomifyImageFile"==Z.tileSource?M=l.formatTilePath(0,0,0):"ZoomifyImageFolder"==Z.tileSource&&(M=Z.Utils.cacheProofPath(l.getImagePath()+"/TileGroup0/0-0-0."+Z.tileType)),k=null,k=new Image,k.onload=i,k.onerror=b,"offsetLoading"!=M)if(n||(B[B.length]={id:a.getViewportID().toString(),image:k}),"ZoomifyImageFile"==Z.tileSource){var o=new Z.NetConnector;o.loadImage(M,Z.Utils.createCallback(null,i),"navigator",null)}else k.src=M;else{window.setTimeout(function(){t(i)},100)}else if("undefined"!=typeof unconvertedImage&&null!==unconvertedImage)k=l.createUnconvertedImageThumbnail(unconvertedImage),n&&"function"==typeof i?i():B[B.length]="undefined"!=typeof a?{id:a.getViewportID().toString(),image:k}:{id:null,image:null};else{window.setTimeout(function(){t(i,a)},100)}}function i(e){for(var i=0,a=Z.imageSetLength;a>i;i++)t(null,Z["Viewport"+i.toString()]);e()}function a(e,t){"ZoomifyImageFile"==Z.tileSource&&(k=t);var i=Z.Utils.createContainerElement("div","testImageContainer","inline-block","absolute","hidden",X+"px",G+"px","0px","0px","none","0px","transparent none","0px","0px","normal",null,!0);i.appendChild(k),i.removeChild(k),i=null;var n=k.width,l=k.height;if(0!=n&&0!=l){Z.NavigatorDisplay=Z.Utils.createContainerElement("div","NavigatorDisplay","inline-block","absolute","hidden",X+"px",G+"px",W+"px",Y+"px","solid","1px","transparent none","0px","0px","normal",null,!0),x=Z.NavigatorDisplay,w=x.style,Z.slideshow&&Z.Utils.setOpacity(x,0);var o=parseInt(Z.Utils.getResource("DEFAULT_UIELEMENTBASEZINDEX"),10);w.zIndex=(o+2).toString();var s=parseFloat(Z.Utils.getResource("DEFAULT_BACKGROUNDALPHA")),d=Z.Utils.getResource("DEFAULT_BACKGROUNDCOLOR"),p=Z.Utils.getResource("DEFAULT_BACKGROUNDCOLORNOALPHA"),m=Z.Utils.createContainerElement("div","navigatorBackground","inline-block","absolute","hidden",X+"px",G+"px","0px","0px","none","0px",d,"0px","0px","normal",null,!0);Z.Utils.setOpacity(m,s,p),Z.NavigatorDisplay.appendChild(m),O=m,R=O.style;var h=Z.Utils.createContainerElement("div","navigatorImageContainer","inline-block","absolute","hidden",X+"px",G+"px","0px","0px","none","0px","transparent none","0px","0px","normal",null,!0);h.appendChild(k),k.alt=Z.Utils.getResource("UI_NAVIGATORACCESSIBILITYALTATTRIBUTE"),Z.NavigatorDisplay.appendChild(h),P=h,D=P.style,C=k;var f=C.width,T=C.height,b=Z.Utils.createContainerElement("div","navigatorRectangle","inline-block","absolute","hidden",X+1+"px",G+1+"px",W+"px",Y+"px","solid","1px","transparent none","0px","0px","normal",null,!0);b.style.borderColor=Z.Utils.stringValidateColorValue(Z.navigatorRectangleColor),Z.NavigatorDisplay.appendChild(b),N=b,V=N.style,Z.ViewerDisplay.appendChild(Z.NavigatorDisplay),u(X,G,W,Y,K,f,T),c(1==Z.navigatorVisible||2==Z.navigatorVisible),Z.Utils.addEventListener(x,"mouseover",Z.Utils.stopPropagation),Z.Utils.addEventListener(x,"mousedown",E),Z.Utils.addEventListener(x,"touchstart",y),Z.Utils.addEventListener(x,"touchmove",U),Z.Utils.addEventListener(x,"touchend",S),Z.Utils.addEventListener(x,"touchcancel",A),r(!0),g()}else{window.setTimeout(function(){a(e,t)},100)}}function n(){if(B&&B.length>0&&null!==B[0]&&B[0].image.width>0){var e=Z.Utils.arrayIndexOfObjectValue(B,"id","0");if(-1!=e){var t=B[e].image;if(k=t.cloneNode(!1),t=null,"undefined"==typeof i)var i=null;a(i,k)}else{window.setTimeout(function(){n()},100)}}else{window.setTimeout(function(){n()},100)}}function l(e){if(Z.NavigatorDisplay)if(Z.slideshow&&Z.Utils.setOpacity(Z.NavigatorDisplay,0),"ZoomifyImageFile"==Z.tileSource&&(k=e),P&&k&&k.width>0&&k.height>0){var t=k.width,i=k.height;P.appendChild(k),C=Z.NavigatorDisplay.childNodes[1].firstChild,u(X,G,W,Y,K,t,i);var a=Z.ToolbarDisplay&&"inline-block"==Z.ToolbarDisplay.style.display&&!Z.ToolbarMinimized||"undefined"!=typeof slideList&&null!==slideList&&"visible"==slideList.style.visibility;c((1==Z.navigatorVisible||2==Z.navigatorVisible)&&a);var n=parseInt(Z.Utils.getResource("DEFAULT_UIELEMENTBASEZINDEX"),10);Z.NavigatorDisplay.style.zIndex=(n+2).toString(),g()}else{window.setTimeout(function(){l()},100)}}function o(){return _}function r(e){!_&&e&&(_=!0,Z.Utils.validateCallback("navigatorInitialized"),Z.Viewer.validateViewerReady("navigatorInitialized"))}function s(){o()&&(L&&(window.clearInterval(L),L=null),x&&w&&O&&R&&P&&D&&C&&N&&V||(x=Z.NavigatorDisplay,w=x.style,O=Z.NavigatorDisplay.firstChild,R=O.style,P=Z.NavigatorDisplay.childNodes[1],D=P.style,C=Z.NavigatorDisplay.childNodes[1].firstChild,N=Z.NavigatorDisplay.childNodes[2],V=N.style))}function u(e,t,i,a,n,l,o){if(n||(n=K),("undefined"==typeof e||null===e)&&(e=Z.navigatorW),("undefined"==typeof t||null===t)&&(t=Z.navigatorH),("undefined"==typeof i||null===i)&&(i=0),("undefined"==typeof a||null===a)&&(a=0),x||(x=Z.NavigatorDisplay),w||(w=x.style),C=x.childNodes[1].firstChild,0==C.width&&"undefined"!==l&&null!==l&&(C.width=l),0==C.height&&"undefined"!==o&&null!==o&&(C.height=o),x&&w&&C){if(n){var r=1,s=1;s=0==n?Z.viewerW/Z.viewerH:C.width/C.height,r>1?(t=e,t/=s):(e=t,e*=s)}w.width=e+"px",w.height=t+"px",w.left=i+"px",w.top=a+"px",d(e,t)}}function d(e,t){if(C||(C=Z.NavigatorDisplay.childNodes[1].firstChild),C&&0!=C.width&&0!=C.height)R||(R=Z.NavigatorDisplay.firstChild.style),D||(D=Z.NavigatorDisplay.childNodes[1].style),R&&D&&(R.width=e+"px",R.height=t+"px",p(e,t),D.width=C.width+"px",D.height=C.height+"px",D.left=(e-C.width)/2+"px",D.top=(t-C.height)/2+"px",g());else{window.setTimeout(function(){d(e,t)},100)}}function p(e,t){if(C||(C=Z.NavigatorDisplay.childNodes[1].firstChild),C){var i=C.width,a=C.height,n=i/a,l=e/i,o=t/a;o>=l?(i=e,a=e/n,navImageT=(t-a*(e/i))/2):l>o&&(a=t,i=t*n,navImageL=(e-i*(t/a))/2),C.width=i,C.height=a}}function c(e){w||(w=Z.NavigatorDisplay.style),w&&(w.display=e?"inline-block":"none")}function g(){if(e&&e.getStatus("initialized")){h(),m();var t=e.calculateCurrentCenterCoordinates();f(t)}}function m(){if(C&&V){var t=C.width/Z.imageW,i=C.height/Z.imageH,a=e.getZoom(),n=Z.viewerW*t/a,l=Z.viewerH*i/a;V.width=n+"px",V.height=l+"px"}}function h(){if(D||(D=Z.NavigatorDisplay.childNodes[1].style),D){var t=e.getRotation();Z.Utils.rotateElement(D,t,!0)}}function f(e){if(C&&V&&D){if("undefined"==typeof e||null===e||0==e.x&&0==e.y)var e=new Z.Utils.Point(Z.imageX,Z.imageY);("undefined"==typeof z||null===z)&&(z=Z.imageZ);var t=Z.imageR;0>t&&(t+=360);var i=parseFloat(C.width),a=parseFloat(C.height),n=i/Z.imageW,l=a/Z.imageH,o=e.x*n,r=e.y*l,s=o-i/2,u=r-a/2,d=Z.Utils.rotatePoint(s,u,-t),p=d.x-parseFloat(V.width)/2,c=d.y-parseFloat(V.height)/2,g=parseFloat(w.width)/2,m=parseFloat(w.height)/2,h=g+p,f=m+c-1;V.left=h+"px",V.top=f+"px"}}function T(){if(C&&V&&D){("undefined"==typeof z||null===z)&&(z=Z.imageZ);var t=Z.imageR;0>t&&(t+=360);var i=parseFloat(V.left),a=parseFloat(V.top),n=parseFloat(w.width)/2,l=parseFloat(w.height)/2,o=i-n,r=a-l,s=o+parseFloat(V.width)/2,u=r+parseFloat(V.height)/2,d=Z.Utils.rotatePoint(s,u,t),p=parseFloat(C.width),c=parseFloat(C.height),g=d.x+p/2,m=d.y+c/2,h=p/Z.imageW,f=(c/Z.imageH,g/h),T=m/h,b=new Z.Utils.Point(f,T);e.syncViewportToNavigator(b)}}function b(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_NAVIGATORIMAGEPATHINVALID"))}function E(t){if(!Z.interactivityOff&&(e.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&e.clearMask(),x&&N&&V)){var t=Z.Utils.event(t);N.mouseXPrior=t.clientX,N.mouseYPrior=t.clientY,dragPtStart=new Z.Utils.Point(t.clientX,t.clientY),Z.Utils.addEventListener(x,"mousemove",v),Z.Utils.addEventListener(x,"mouseup",I),Z.Utils.addEventListener(document,"mouseup",I)}}function v(e){if(!Z.interactivityOff&&N&&V){var t=parseFloat(V.left),i=parseFloat(V.top);return V.left=t+(e.clientX-N.mouseXPrior)+"px",V.top=i+(e.clientY-N.mouseYPrior)+"px",N.mouseXPrior=e.clientX,N.mouseYPrior=e.clientY,T(),!1}}function I(t){if(!Z.interactivityOff&&x&&N&&V){document.mousemove=null,document.mouseup=null,Z.Utils.removeEventListener(x,"mousemove",v),Z.Utils.removeEventListener(x,"mouseup",I),Z.Utils.removeEventListener(document,"mouseup",I);var t=Z.Utils.event(t),i=new Z.Utils.Point(t.clientX,t.clientY),a=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,i.x,i.y);if(4>a){var n=Z.Utils.getElementPosition(Z.NavigatorDisplay);V.left=t.clientX-n.x-parseFloat(V.width)/2+"px",V.top=t.clientY-n.y-parseFloat(V.height)/2+"px"}T(),e.updateView()}}function y(e){if(!Z.interactivityOff&&(e.preventDefault(),x&&N&&V)){var t=Z.Utils.getFirstTouch(e);if(t){var i=(t.target,new Z.Utils.Point(t.pageX,t.pageY));dragPtStart=new Z.Utils.Point(i.x,i.y),N.mouseXPrior=i.x,N.mouseYPrior=i.y}}}function U(e){if(!Z.interactivityOff&&(e.preventDefault(),Z.mousePan)){if(N&&V){var t=Z.Utils.getFirstTouch(e);if(t){var i=(t.target,new Z.Utils.Point(t.pageX,t.pageY)),a=parseFloat(V.left),n=parseFloat(V.top);return V.left=a+(i.x-N.mouseXPrior)+"px",V.top=n+(i.y-N.mouseYPrior)+"px",N.mouseXPrior=i.x,N.mouseYPrior=i.y,T(),!1}}return!1}}function S(t){if(!Z.interactivityOff&&x&&N&&V){var i=Z.Utils.getFirstTouch(t);if(i){var a=(i.target,new Z.Utils.Point(i.pageX,i.pageY)),n=new Z.Utils.Point(a.x,a.y),l=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,n.x,n.y),o=Z.mobileDevice?6:3;if(o>l){var r=Z.Utils.getElementPosition(Z.NavigatorDisplay);V.left=a.x-r.x-parseFloat(V.width)/2+"px",V.top=a.y-r.y-parseFloat(V.height)/2+"px"}}T(),e.updateView()}}function A(t){if(!Z.interactivityOff&&x&&N&&V){var i=Z.Utils.getFirstTouch(t);if(i){var a=(i.target,new Z.Utils.Point(i.pageX,i.pageY)),n=new Z.Utils.Point(a.x,a.y),l=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,n.x,n.y),o=Z.mobileDevice?6:3;if(o>l){var r=Z.Utils.getElementPosition(Z.NavigatorDisplay);V.left=a.x-r.x-parseFloat(V.width)/2+"px",V.top=a.y-r.y-parseFloat(V.height)/2+"px"}}T(),e.updateView()}}var L,x,w,O,R,P,D,C,N,V,k,M,F=this,_=!1,H=e.getViewportID().toString(),B=[],X=Z.navigatorW,G=Z.navigatorH,W=Z.navigatorL,Y=Z.navigatorT,K=Z.navigatorFit;"multiple"!=Z.imagePath?t(a):i(n),this.initializeNavigator=function(e,t){a(e,t)},this.setImage=function(){if(P&&k&&P.childNodes.length>0&&(P.innerHTML=""),"undefined"==typeof B||null===B||0==B.length)t(l);else{var e=Z.Utils.arrayIndexOfObjectValue(B,"id",H);-1!=e&&(k=B[e].image,l(k))}},this.getInitialized=function(){return o()},this.setVisibility=function(e){c(e)},this.syncToViewport=function(){g()},this.syncNavigatorRectangleDimensions=function(){m()},this.syncNavigatorRotation=function(){h()},this.syncNavigatorRectangleToViewport=function(e){f(e)},this.setViewport=function(t){e=t,H=e.getViewportID().toString(),F.setImage(e.getImagePath())},this.validateNavigatorGlobals=function(){o()?s():L=window.setInterval(s,300)},this.setSizeAndPosition=function(e,t,i,a,n,l,o){u(e,t,i,a,n,l,o)}},Z.ZoomifyRuler=function(e){function t(){Z.RulerDisplay=Z.Utils.createContainerElement("div","RulerDisplay","inline-block","absolute","hidden","1px","1px","0px","0px","solid","1px","transparent none","0px","0px","normal"),h=Z.RulerDisplay,f=h.style;var e=parseFloat(Z.Utils.getResource("DEFAULT_BACKGROUNDALPHA")),t=Z.Utils.getResource("DEFAULT_BACKGROUNDCOLOR"),o=Z.Utils.getResource("DEFAULT_BACKGROUNDCOLORNOALPHA"),s=Z.Utils.createContainerElement("div","rulerBackground","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",t,"0px","0px","normal",null,!0);Z.Utils.setOpacity(s,e,o),Z.RulerDisplay.appendChild(s),T=s,b=T.style;var p=Z.Utils.getResource("DEFAULT_SCALEBARCOLOR"),c=Z.Utils.createContainerElement("div","rulerScaleBar","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",p,"0px","0px","normal",null,!0);Z.RulerDisplay.appendChild(c),E=c,v=E.style;var g=parseInt(Z.Utils.getResource("DEFAULT_UIELEMENTBASEZINDEX"),10);v.zIndex=(g+3).toString();var P=Z.Utils.createContainerElement("div","rulerScaleBarNotchL","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",p,"0px","0px","normal",null,!0);Z.RulerDisplay.appendChild(P),rSBNL=P,rsbnlS=rSBNL.style;var D=Z.Utils.createContainerElement("div","rulerScaleBarNotchR","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",p,"0px","0px","normal",null,!0);Z.RulerDisplay.appendChild(D),rSBNR=D,rsbnrS=rSBNR.style;var C=parseInt(Z.Utils.getResource("DEFAULT_RULERTEXTFONTSIZE"),10),N=Z.Utils.createContainerElement("div","errorTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent none","0px","0px","nowrap",null,!0),V=document.createTextNode("");N.appendChild(V),Z.Utils.setTextNodeStyle(V,"black","verdana",C+"px","none","normal","normal","normal","normal","1em","center","none"),Z.RulerDisplay.appendChild(N),I=N,y=I.style;var k=Z.Utils.createContainerElement("div","scaleTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent none","0px","0px","nowrap",null,!0),M=document.createTextNode("");k.appendChild(M),Z.Utils.setTextNodeStyle(M,"black","verdana",C+"px","none","normal","normal","normal","normal","1em","right","none"),Z.RulerDisplay.appendChild(k),U=k,S=U.style;var F=Z.Utils.createContainerElement("div","unitTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent none","0px","0px","nowrap",null,!0),_=document.createTextNode("");F.appendChild(_),Z.Utils.setTextNodeStyle(_,"black","verdana",C+"px","none","normal","normal","normal","normal","1em","left","none"),Z.RulerDisplay.appendChild(F),A=F,L=A.style,0!=Z.rulerListType&&(a(),O=new Z.Utils.createSelectElement("magnificationList","",R,1,1,1,null,!0,m,"change"),Z.RulerDisplay.appendChild(O),x=O,w=x.style,n()),i(),l(),Z.ViewerDisplay.appendChild(Z.RulerDisplay),u(Z.rulerVisible),Z.Utils.addEventListener(h,"mouseover",Z.Utils.stopPropagation),r(!0),d(!0)}function i(){F=[{magnitude:Math.pow(10,24),symbol:"Ym"},{magnitude:Math.pow(10,21),symbol:"Zm"},{magnitude:Math.pow(10,18),symbol:"Em"},{magnitude:Math.pow(10,15),symbol:"Pm"},{magnitude:Math.pow(10,12),symbol:"Tm"},{magnitude:Math.pow(10,9),symbol:"Gm"},{magnitude:Math.pow(10,6),symbol:"Mm"},{magnitude:Math.pow(10,3),symbol:"km"},{magnitude:Math.pow(10,2),symbol:"hm"},{magnitude:Math.pow(10,1),symbol:"dam"},{magnitude:Math.pow(10,0),symbol:"m"},{magnitude:Math.pow(10,-1),symbol:"dm"},{magnitude:Math.pow(10,-2),symbol:"cm"},{magnitude:Math.pow(10,-3),symbol:"mm"},{magnitude:Math.pow(10,-6),symbol:"um"},{magnitude:Math.pow(10,-9),symbol:"nm"},{magnitude:Math.pow(10,-12),symbol:"pm"},{magnitude:Math.pow(10,-15),symbol:"fm"},{magnitude:Math.pow(10,-18),symbol:"am"},{magnitude:Math.pow(10,-21),symbol:"zm"},{magnitude:Math.pow(10,-24),symbol:"ym"},{magnitude:Math.pow(10,-24),symbol:"pixels"}]}function a(){R=1==Z.rulerListType&&0!=N?[{text:"2.5x",value:2.5},{text:"5x",value:5},{text:"10x",value:10},{text:"20x",value:20},{text:"40x",value:40},{text:"60x",value:60},{text:"100x",value:100}]:[{text:"10%",value:10},{text:"20%",value:20},{text:"30%",value:30},{text:"40%",value:40},{text:"50%",value:50},{text:"60%",value:60},{text:"70%",value:70},{text:"80%",value:80},{text:"90%",value:90},{text:"100%",value:100}]}function n(){var t,i=100*Z.minZ,a=100*Z.maxZ,n=Math.round(i),l=Math.round(a),o="%";for(-1==i&&(i=Math.round(100*e.calcZoomDecimalToFitDisplay())),1==Z.rulerListType&&0!=N&&(i=g(i,N),n=Math.round(i),o="x");R[0].value<=n;)R=Z.Utils.arraySplice(R,0,1);for(-1==a&&(a=Math.round(100*e.calcZoomDecimalToFitDisplay())),1==Z.rulerListType&&0!=N&&(a=g(a,N),l=Math.round(a),o="x");R[R.length-1].value>=l;)R=Z.Utils.arraySplice(R,R.length-1,1);t=n==i?"":"~",R=Z.Utils.arraySplice(R,0,0,{text:n.toString()+o+t+D,value:n}),t=l==a?"":"~",R[R.length]={text:l.toString()+o+t+C,value:a},Z.Utils.updateSelectElement(x,R),x.selectedIndex=0}function l(){var e=Z.rulerW,t=Z.rulerH,i=-1==Z.rulerL&&Z.Navigator?Z.navigatorL:Z.rulerL,a=-1==Z.rulerT&&Z.Navigator?Z.navigatorT+Z.navigatorH+1:Z.rulerT,n=53,l=20,o=0!=Z.rulerListType;H=o?e-n-16:e-10;var r=1,u=6,d=5,p=(t-r+5)/2,c=H/2-5,g=15,m=d+10,h=p-10,f="pixels"==Z.units?7:0;b&&v&&rsbnlS&&rsbnrS&&I&&y&&U&&S&&A&&L&&(s(e,t,i,a),b.width=e+"px",b.height=t+"px",b.left="0px",b.top="0px",w&&(w.width=n+"px",w.left=e-n-3+"px",w.top=(t-l)/2+"px",w.visibility="visible"),v.width=H+"px",v.height=r+"px",v.left=d+"px",v.top=p+3+"px",rsbnlS.width="1px",rsbnlS.height=u+"px",rsbnlS.left=d+"px",rsbnlS.top=p+"px",rsbnrS.width="1px",rsbnrS.height=u+"px",rsbnrS.left=d+H+"px",rsbnrS.top=p+"px",y.width=H+"px",y.height=g+"px",y.left=m-3+"px",y.top=h+"px",S.width=c+"px",S.height=g+"px",S.left=m-f+"px",S.top=h+"px",L.width=c+"px",L.height=g+"px",L.left=H/2+15-f+"px",L.top=h+"px")}function o(){return P}function r(e){!P&&e&&(P=!0,Z.Utils.validateCallback("rulerInitialized"),Z.Viewer.validateViewerReady("rulerInitialized"))}function s(e,t,i,a){if("undefined"==typeof e||null===e)var e=Z.rulerW;if("undefined"==typeof t||null!==t)var t=Z.rulerH;("undefined"==typeof i||null!==i)&&(i=-1==Z.rulerL&&Z.Navigator?Z.navigatorL:Z.rulerL),("undefined"==typeof a||null!==a)&&(a=-1==Z.rulerT&&Z.Navigator?Z.navigatorT+Z.navigatorH+1:Z.rulerT),f.width=e+"px",f.height=t+"px",f.left=i+"px",f.top=a+"px"}function u(e){f||(f=Z.RulerDisplay.style),f&&(f.display=e?"inline-block":"none")}function d(t){e&&e.getStatus("initialized")&&(p(),c(t))}function p(){var t=e.getZoom(),i="pixels"==Z.units?0:4;if(w){w.visibility="visible";var a;a=0!=N?N*t:100*t,a=1>a?Math.round(100*a)/100:Math.round(a)}for(var n=0,l=F.length;l>n;n++)F[n].symbol==Z.units&&(_=n);M=null!==k&&0!=k?k:null!==V&&0!=V?Z.imageW/V:1;var o=H,r=o/M,s=r/t,u=Z.Utils.roundToFixed(s,i);U.firstChild.nodeValue=u.toString(),L.visibility="visible",A.firstChild.nodeValue="um"!=F[_].symbol?F[_].symbol:"m"}function c(t){if(w){var i=Math.round(100*e.getZoom()),a=Math.round(i),n="%",l=Math.round(100*e.getZoom())==Math.round(1e3*e.getZoom())/1e3*100?"":"~";1==Z.rulerListType&&0!=N&&(i=g(100*e.getZoom(),N),a=Math.round(i),n="x");var o=a.toString()+n+l;if(t){for(var r=insertIndex=0;a>R[r].value;)r++,insertIndex=r;if(a==R[insertIndex].value)Z.Utils.updateSelectElement(x,R);else{var s=Z.Utils.arrayClone("magnifications",R,s);s=Z.Utils.arraySplice(s,insertIndex,0,{text:o,value:a.toString()}),Z.Utils.updateSelectElement(x,s)}x.selectedIndex=insertIndex}else x.options[0]=new Option(o,a.toString()),x.selectedIndex=0}}function g(e,t){var i=e*t/100;return i}function m(t){var i=0,t=Z.Utils.event(t);if(t){var a=Z.Utils.target(t);if(i=parseInt(a.options[a.selectedIndex].value,10),!isNaN(i)){var n;n=1==Z.rulerListType?100*i/N:i,e.zoomAndPanToView(e.viewX,e.viewY,n/100)}}}var h,f,T,b,E,v,I,y,U,S,A,L,x,w,O,R,P=!1,D=(Z.Utils.getResource("UI_RULERNOPARAMS"),Z.Utils.getResource("UI_RULERMIN")),C=Z.Utils.getResource("UI_RULERMAX"),N=Z.sourceMagnification,V=(Z.units,Z.unitsPerImage),k=Z.pixelsPerUnit,M=1,F=[],_=-1,H=1;t(),this.getInitialized=function(){return o()},this.setVisibility=function(e){u(e)},this.setSizeAndPosition=function(e,t,i,a,n){s(e,t,i,a,n)},this.syncToViewport=function(e){d(e)}},Z.NetConnector=function(){function e(e,i,a){var l=e.substring(0,e.indexOf("?")),o=parseFloat(e.substring(e.indexOf("?")+1,e.indexOf(","))),r=parseFloat(e.substring(e.indexOf(",")+1,e.length)),s=o+r,u=new Z.Utils.Range(o,s);t(l,n,u,i,a)}function t(e,t,n,l,o,r){var s=i();if(s){var u="function"==typeof t;if(u){var d=t,t=function(){window.setTimeout(Z.Utils.createCallback(null,d,s),1)};s.onreadystatechange=function(){4==s.readyState&&(s.onreadystatechange=new Function,t())}}try{"undefined"==typeof n||null===n?(s.open("GET",e,u),s.send(null)):"undefined"!=typeof l&&null!==l&&"ZoomifyImageFile"==Z.tileSource&&("tile"!=l&&(e=Z.Utils.cacheProofPath(e)),s.open("GET",e,!0),s.responseType="arraybuffer",Z.Utils.defineObjectProperty(s,"zType",{value:l,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.defineObjectProperty(s,"zTile",{value:o,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.defineObjectProperty(s,"zChunkNumber",{value:r,writable:!1,enumerable:!1,configurable:!1}),Z.browser==Z.browsers.SAFARI&&s.setRequestHeader("If-Modified-Since","Thu, 01 Dec 1994 16:00:00 GMT"),s.setRequestHeader("Range","bytes="+n.start.toString()+"-"+n.end.toString()),s.send(null))}catch(p){a(p,e,l),s=null,console.log(p)}}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLHTTPREQUESTUNSUPPORTED"))}function i(){var e=null;switch(Z.xmlHttpRequestSupport){case"XMLHttpRequest":e=new XMLHttpRequest;break;case"Msxml2.XMLHTTP.6.0":e=new ActiveXObject("Msxml2.XMLHTTP.6.0");break;case"Msxml2.XMLHTTP.3.0":e=new ActiveXObject("Msxml2.XMLHTTP.3.0");break;case"Microsoft.XMLHTTP":e=new ActiveXObject("Microsoft.XMLHTTP")}return e}function a(e,t,i){1==Z.localUse&&(Z.browser==Z.browsers.CHROME||Z.browser==Z.browsers.OPERA||Z.browser==Z.browsers.IE&&11==Z.browserVersion||Z.browser==Z.browsers.SAFARI&&Z.browserVersion>=7)?Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNSUPPORTEDLOCALVIEWING-BROWSER"),!0):1==Z.localUse&&"ZoomifyImageFile"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNSUPPORTEDLOCALVIEWING-FORMAT-ZIF"),!0):-1!=t.toLowerCase().indexOf(".zif")?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-ZIFBYTERANGE")+i+".",!1,g,"center"):-1!=t.indexOf("ImageProperties.xml")?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-IMAGEXML"),!0,null,"left"):-1!=t.toLowerCase().indexOf("reply_data")?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-IMAGEOFFSET"),!1,g,"center"):-1!=t.indexOf(Z.Utils.getResource("DEFAULT_SKINXMLFILE"))?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-TOOLBARSKINSXML"),!0,null,"left"):-1!=t.indexOf(Z.Utils.getResource("DEFAULT_SLIDESXMLFILE"))?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-SLIDESXML"),!1,c,"center"):-1!=t.indexOf(Z.Utils.getResource("DEFAULT_HOTSPOTSXMLFILE"))?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-HOTSPOTSXML"),!1,c,"center"):Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST"),!1,c,"center")
}function n(e,t){if(e)if(200!==e.status&&0!==e.status&&206!==e.status){var i=e.status,a=404==i?"Not Found":e.statusText;Z.Toolbar&&!Z.Toolbar.getInitialized()?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-TOOLBARSKINSXML"),!0,null,"left"):"ZoomifyImageFile"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("ERROR_NETWORKSTATUSRANGEREQUESTS")+i+" - "+a,!0,null,"left"):Z.Utils.showMessage(Z.Utils.getResource("ERROR_NETWORKSTATUS")+i+" - "+a,!1,c,"center")}else{var n=null,r=null!==Z.annotationPath&&".json"==Z.annotationPath.toLowerCase().substring(Z.annotationPath.length-5,Z.annotationPath.length);if(e.response&&e.zType&&"ZoomifyImageFile"==Z.tileSource)l(e,t);else if(e.responseXML&&e.responseXML.documentElement&&!r)n=e.responseXML,o(n,t);else if(e.responseText){var s=e.responseText;"ZoomifyImageFolder"==Z.tileSource?(n=Z.Utils.xmlConvertTextToDoc(s),o(n,t)):"ZoomifyImageFile"==Z.tileSource&&(n=Z.Utils.xmlConvertTextToDoc(s),o(n,t))}}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_NETWORKSECURITY"),!1,c,"center")}function l(e,t){if(Z.Viewport){var i=new Z.Utils.createUint8Array(e.response,0);if("header"==e.zType)if("undefined"==typeof t||null===t)Z.Viewport.parseZIFHeader(i);else for(var a=0,n=Z.imageSetLength;n>a;a++)t==a&&Z["Viewport"+a.toString()].parseZIFHeader(i);else if("offset"==e.zType)if("undefined"==typeof t||null===t)Z.Viewport.parseZIFOffsetChunk(i,e.zChunkNumber);else for(var a=0,n=Z.imageSetLength;n>a;a++)t==a&&Z["Viewport"+a.toString()].parseZIFOffsetChunk(i,e.zChunkNumber);else if("byteCount"==e.zType)if("undefined"==typeof t||null===t)Z.Viewport.parseZIFByteCountChunk(i,e.zChunkNumber);else for(var a=0,n=Z.imageSetLength;n>a;a++)t==a&&Z["Viewport"+a.toString()].parseZIFByteCountChunk(i,e.zChunkNumber);else if("image"==e.zType.substring(0,5))m--,Z.Viewport.parseZIFImage(i,e.zTile,e.zType);else if("navigator"==e.zType)if("undefined"==typeof t||null===t)Z.viewportCurrent.parseZIFImage(i,e.zTile,e.zType);else for(var a=0,n=Z.imageSetLength;n>a;a++)t==a&&Z["Viewport"+a.toString()].parseZIFImage(i,e.zTile,e.zType);else Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-ZIFBYTES"),!1,g,"center")}}function o(e,t){if(e&&e.documentElement){var i=e.documentElement.tagName;if("COPYRIGHT"==i){var a=e.documentElement.getAttribute("STATEMENTTEXT"),n=e.documentElement.getAttribute("DECLINEDTEXT");Z.Utils.stringValidate(a)?Z.Utils.showCopyright(a,n):Z.Utils.showMessage(Z.Utils.getResource("ERROR_IMAGEXMLINVALID"),!0)}else if("IMAGE_PROPERTIES"==i||"ZIFHEADER"==i){if("ZoomifyImageFile"==Z.tileSource||"ZoomifyImageFolder"==Z.tileSource)if("multiple"!=Z.imagePath)Z.Viewport&&Z.Viewport.parseImageXML(e);else for(var l=0,o=Z.imageSetLength;o>l;l++)t==l&&Z["Viewport"+l.toString()].parseImageXML(e)}else if("SKINDATA"==i)Z.Toolbar&&Z.Toolbar.parseSkinXML(e);else if("SLIDEDATA"==i)Z.Viewport&&Z.Viewport.parseSlidesXML(e);else if("HOTSPOTDATA"==i)if("undefined"==typeof t||null===t)Z.Viewport&&Z.Viewport.parseHotspotsXML(e);else for(var l=0,o=Z.imageSetLength;o>l;l++)t==l&&Z["Viewport"+l.toString()].parseHotspotsXML(e);else"ANIMATIONDATA"==i&&Z.Viewer&&Z.Viewer.parseImageSetXML(e,"animation")}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLDOCINVALID"),!0)}function r(t,i,a,n){if(h>m){if(m++,"ZoomifyImageFile"==Z.tileSource&&("undefined"!=typeof n&&null!==n||"navigator"==a))e(t,a,n);else{var l=Z.Utils.createCallback(null,u,i),o=new d(t,l,a);o.start()}return!0}var r=Z.Utils.arrayIndexOfObjectValue(b,"sc",t);return-1==r&&(b[b.length]={sc:t,cb:i,ct:a,t:n},p||(p=window.setInterval(function(){s()},T))),!1}function s(){var e=b[0],t=r(e.sc,e.cb,e.ct,e.t);t&&(b=Z.Utils.arraySplice(b,0,1)),0==b.length&&p&&(window.clearInterval(p),p=null)}function u(e,t,i){if(m--,"function"==typeof e)try{e(i)}catch(a){Z.Utils.showMessage(a.name+Z.Utils.getResource("ERROR_EXECUTINGCALLBACK")+t+" "+a.message,!0)}}function d(e,t,i){function a(i){n.onload=null,n.onabort=null,n.onerror=null,l&&window.clearTimeout(l),window.setTimeout(function(){t(e,i?n:null)},1)}var n=null,l=null;this.start=function(){n=new Image;var t=function(){a(!0)},o=function(){a(!1)},r=function(){console.log(Z.Utils.getResource("ERROR_IMAGEREQUESTTIMEDOUT")),a(!1),Z.Viewport.traceDebugValues("imageRequestTimeout",i+" timeout: "+e)};n.onload=t,n.onabort=o,n.onerror=o,l=window.setTimeout(r,f),n.src=e}}var p,c=parseInt(Z.Utils.getResource("ERROR_MESSAGEDURATION"),10),g=parseInt(Z.Utils.getResource("ERROR_MESSAGEDURATIONMEDIUM"),10),m=0,h=parseInt(Z.Utils.getResource("DEFAULT_IMAGESLOADINGMAX"),10),f=parseFloat(Z.Utils.getResource("DEFAULT_IMAGELOADTIMEOUT")),T=Z.Utils.getResource("DEFAULT_IMAGELOADQUEUEDELAY"),b=[];this.loadXML=function(e,i){"undefined"==typeof i||null===i?t(e,n,null):t(e,function(e){n(e,i)},null)},this.loadByteRange=function(e,i,a,l,o,r){var s=new Z.Utils.Range(i,a);t(e,n,s,l,o,r)},this.loadImage=function(e,t,i,a){r(e,t,i,a)}},Z.Utils={addCrossBrowserMethods:function(){document.addEventListener?(this.disableTextInteraction=function(e){if(e){var t=e.parentNode.style;t&&(e.parentNode.unselectable="on",t.userSelect="none",t.MozUserSelect="none",t.webkitUserSelect="none",t.webkitTouchCallout="none",t.webkitTapHighlightColor="transparent")}},this.renderQuality=function(e,t){if(t){var i="high"==t?"optimizeQuality":"optimizeSpeed";e.style.setProperty("image-rendering",i,null)}},this.setOpacity=function(e,t,i){Z.alphaSupported?e.style.opacity=t:i&&(e.style.backgroundColor=i)}):document.attachEvent&&(this.disableTextInteraction=function(e){e&&(e.parentNode.unselectable="on",e.parentNode.onselectstart=function(){return!1})},this.renderQuality=function(e,t){if(t){var i="high"==t?"bicubic":"nearest-neighbor";e.style.msInterpolationMode=i}},this.setOpacity=function(e,t,i){Z.alphaSupported?(t*=100,e.style.zoom=1,e.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+t+")",e.style.filter="alpha(opacity="+t+")",100==t&&(e.style.filter="")):i&&(e.style.backgroundColor=i)})},addCrossBrowserEvents:function(){document.addEventListener?(this.addEventListener=function(e,t,i){e&&("mousewheel"==t&&e.addEventListener("DOMMouseScroll",i,!1),e.addEventListener(t,i,!1))},this.removeEventListener=function(e,t,i){e&&("mousewheel"==t&&e.removeEventListener("DOMMouseScroll",i,!1),e.removeEventListener(t,i,!1))},this.event=function(e){return e},this.target=function(e){return e.target},this.relatedTarget=function(e){return e.relatedTarget},this.isRightMouseButton=function(e){var t=!1;return(2==e.which||3==e.which)&&(t=!0),t},this.preventDefault=function(e){e.preventDefault()},this.stopPropagation=function(e){e.stopPropagation()}):document.attachEvent&&(this.addEventListener=function(e,t,i){if(-1==this._findListener(e,t,i)){var a=function(){var t=window.event;Function.prototype.call?i.call(e,t):(e._currentListener=i,e._currentListener(t),e._currentListener=null)};e.attachEvent("on"+t,a);var n={target:e,eventName:t,handler:i,handler2:a},l=e.document||e,o=l.parentWindow,r="l"+this._listenerCounter++;o._allListeners||(o._allListeners={}),o._allListeners[r]=n,e._listeners||(e._listeners=[]),e._listeners[e._listeners.length]=r,o._unloadListenerAdded||(o._unloadListenerAdded=!0,o.attachEvent("onunload",this._removeAllListeners))}},this.removeEventListener=function(e,t,i){if(e){var a=this._findListener(e,t,i);if(-1==a)return;var n=e.document||e,l=n.parentWindow,o=e._listeners[a],r=l._allListeners[o];e.detachEvent("on"+t,r.handler2),e._listeners=Z.Utils.arraySplice(e._listeners,a,1),delete l._allListeners[o]}},this.event=function(){return window.event},this.target=function(e){return e.srcElement},this.relatedTarget=function(e){var t=null;return"mouseover"==e.type?t=e.fromElement:"mouseout"==e.type&&(t=e.toElement),t},this.isRightMouseButton=function(e){var t=!1;return 2==e.button&&(t=!0),t},this.preventDefault=function(e){e&&(e.returnValue=!1)},this.stopPropagation=function(e){e.cancelBubble=!0},this._findListener=function(e,t,i){var a=e._listeners;if(!a)return-1;for(var n=e.document||e,l=n.parentWindow,o=a.length-1;o>=0;o--){var r=a[o],s=l._allListeners[r];if(s&&s.eventName==t&&s.handler==i)return o}return-1},this._removeAllListeners=function(){var e=this;for(id in e._allListeners){var t=e._allListeners[id];t.target.detachEvent("on"+t.eventName,t.handler2),delete e._allListeners[id]}},this._listenerCounter=0)},declareGlobals:function(){Z.pageContainerID=null,Z.imagePath=null,Z.skinPath=null,Z.skinMode=null,Z.parameters=null,Z.cacheProofCounter=0,Z.timerCounter=0,Z.browsers=null,Z.browser=null,Z.browserVersion=null,Z.scaleThreshold=null,Z.canvasSupported=null,Z.cssTransformsSupported=null,Z.cssTransformProperty=null,Z.cssTransformNoUnits=null,Z.alphaSupported=null,Z.renderQuality=null,Z.rotationSupported=null,Z.fullScreenSupported=null,Z.arrayMapSupported=null,Z.arraySpliceSupported=null,Z.float32ArraySupported=null,Z.uInt8ArraySupported=null,Z.xmlHttpRequestSupport=null,Z.definePropertySupported=null,Z.responseArraySupported=null,Z.responseArrayPrototyped=!1,Z.touchSupport=null,Z.mobileDevice=null,Z.localUse=null,Z.zifSupported=null,Z.onReady=null,Z.onAnnotationReady=null,Z.initialX=null,Z.initialY=null,Z.initialZ=null,Z.initialZoom=null,Z.minZ=null,Z.minZoom=null,Z.maxZ=null,Z.maxZoom=null,Z.zoomSpeed=null,Z.panSpeed=null,Z.smoothPan=null,Z.smoothPanEasing=null,Z.smoothPanGlide=null,Z.autoResize=null,Z.fadeInSpeed=null,Z.toolbarVisible=null,Z.toolbarAutoShowHide=null,Z.toolbarW=null,Z.toolbarH=null,Z.toolbarPosition=null,Z.navigatorVisible=null,Z.navigatorW=null,Z.navigatorWidth=null,Z.navigatorH=null,Z.navigatorHeight=null,Z.navigatorL=null,Z.navigatorLeft=null,Z.navigatorT=null,Z.navigatorTop=null,Z.navigatorFit=null,Z.navigatorRectangleColor=null,Z.clickZoom=null,Z.doubleClickZoom=null,Z.doubleClickDelay=null,Z.clickPan=null,Z.clickZoomAndPanBlock=!1,Z.mousePan=null,Z.keys=null,Z.constrainPan=null,Z.panBuffer=null,Z.constrainPanStrict=null,Z.tooltipsVisible=null,Z.helpVisible=0,Z.watermarkPath=null,Z.copyrightPath=null,Z.hotspots=!1,Z.hotspotPath=null,Z.hotspotFolder=null,Z.hotspotListTitle=null,Z.hotspotsDrawOnlyInView=!0,Z.captionBoxes=!1,Z.captionsColorsDefault=!0,Z.screensaver=!1,Z.screensaverSpeed=null,Z.tour=!1,Z.tourPath=null,Z.tourListTitle=null,Z.tourPlaying=null,Z.tourStop=!1,Z.slideshow=!1,Z.slidePath=null,Z.slideListTitle=null,Z.slideshowPlaying=null,Z.slideTransitionTimeout=null,Z.slideTransitionSpeed=null,Z.slideOpacity=0,Z.audioContent=!1,Z.audioMuted=!1,Z.annotations=!1,Z.annotationPath=null,Z.annotationPanelVisible=null,Z.annotationPanelVisibleState=!1,Z.annotationFolder=null,Z.annotationXMLText=null,Z.annotationJSONObject=null,Z.annotationsAddMultiple=null,Z.annotationsAutoSave=null,Z.saveButtonVisible=null,Z.labelClickSelect=null,Z.simplePath=!1,Z.noPost=!1,Z.noPostDefaults=!1,Z.unsavedEditsTest=!0,Z.maskVisible=null,Z.maskingSelection=!1,Z.maskFadeTimeout=null,Z.maskFadeSpeed=null,Z.maskOpacity=0,Z.maskClearOnUserAction=null,Z.externalEditPermissionFunction=null,Z.annotationSort="none",Z.saveHandlerPath=null,Z.saveImageHandlerPath=null,Z.saveImageFull=null,Z.postingXML=!1,Z.postingImage=!1,Z.minimizeVisible=null,Z.sliderZoomVisible=null,Z.sliderVisible=null,Z.panButtonsVisible=null,Z.resetVisible=null,Z.fullViewVisible=null,Z.fullScreenVisible=null,Z.fullPageVisible=null,Z.initialFullPage=null,Z.fullPageInitial=null,Z.measureVisible=!1,Z.captionTextColor=null,Z.captionBackColor=null,Z.polygonLineColor=null,Z.polygonFillColor=null,Z.captionTextVisible=!0,Z.captionBackVisible=!0,Z.polygonFillVisible=!0,Z.polygonLineVisible=!0,Z.rotationVisible=null,Z.initialR=null,Z.initialRotation=null,Z.virtualPointerVisible=null,Z.crosshairsVisible=null,Z.rulerVisible=null,Z.units=null,Z.unitsPerImage=null,Z.pixelsPerUnit=null,Z.sourceMagnification=null,Z.magnification=null,Z.rulerListType=null,Z.rulerW=null,Z.rulerWidth=null,Z.rulerH=null,Z.rulerHeight=null,Z.rulerL=null,Z.rulerLeft=null,Z.rulerT=null,Z.rulerTop=null,Z.coordinatesVisible=null,Z.saveImageFull=null,Z.saveImageFilename=null,Z.saveImageFormat=null,Z.saveImageCompression=null,Z.saveImageBackColor=null,Z.imageFiltersVisible=null,Z.initialImageFilters=null,Z.progressVisible=null,Z.messagesVisible=null,Z.logoVisible=null,Z.logoLink=null,Z.logoLinkURL=null,Z.logoCustomPath=null,Z.canvas=null,Z.debug=null,Z.imageProperties=null,Z.serverIP=null,Z.serverPort=null,Z.tileHandlerPath=null,Z.tileHandlerPathFull=null,Z.tileW=null,Z.tileH=null,Z.tileType="jpg",Z.tilesPNG=null,Z.freehandVisible=null,Z.textVisible=null,Z.iconVisible=null,Z.rectangleVisible=null,Z.polygonVisible=null,Z.annotationPathProvided=!1,Z.saveHandlerProvided=!1,Z.imageSetPathProvided=!1,Z.saveImageHandlerProvided=!1,Z.tileSource=null,Z.tileSourceMultiple=null,Z.focal=null,Z.quality=null,Z.markupMode=null,Z.editMode=null,Z.editing=null,Z.labelMode="view",Z.editModePrior=Z.editMode,Z.sliderFocus="zoom",Z.animation=!1,Z.animationPath=null,Z.animationCount=0,Z.animationAxis=null,Z.animator=null,Z.slidestack=!1,Z.slidestackPath=null,Z.imageSet=!1,Z.imageSetPath=null,Z.imageSetLength=null,Z.imageSetListPosition=null,Z.imageSetListTitle=null,Z.imageSetStart=null,Z.imageSetLoop=null,Z.sliderImageSetVisible=null,Z.mouseWheelParmeterProvided=null,Z.mouseWheel=null,Z.imageSetHotspotPath=null,Z.hotspotFileShared=!1,Z.imageSetAnnotationPath=null,Z.annotationFileShared=!1,Z.Viewer=null,Z.ViewerDisplay=null,Z.Viewport=null,Z.Toolbar=null,Z.ToolbarDisplay=null,Z.ToolbarMinimized=!1,Z.TooltipDisplay=null,Z.Navigator=null,Z.NavigatorDisplay=null,Z.MessageDisplay=null,Z.messages=null,Z.messageDisplayList=[],Z.overlayMessage=null,Z.CoordinatesDisplay=null,Z.coordinates=null,Z.coordinatesSave=null,Z.CopyrightDisplay=null,Z.AnnotationPanelDisplay=null,Z.imageW=null,Z.imageH=null,Z.imageCenterX=null,Z.imageCenterY=null,Z.imageX=0,Z.imageY=0,Z.imageZ=0,Z.imageR=0,Z.priorX=0,Z.priorY=0,Z.priorZ=0,Z.priorR=0,Z.preventDupCall=!1,Z.fitZ=null,Z.fillZ=null,Z.zooming="stop",Z.panningX="stop",Z.panningY="stop",Z.fullView=!1,Z.fullViewPrior=!1,Z.interactivityOff=!1,Z.useCanvas=!0,Z.specialStorageEnabled=null,Z.callbacks=[],Z.updateViewPercent=0,Z.TraceDisplay=null,Z.traces=null,Z.mouseIsDown=!1,Z.buttonIsDown=!1,Z.keyIsDown=!1,Z.mouseWheelIsDown=!1,Z.mouseWheelCompleteDuration=null,Z.mouseWheelCompleteTimer=null,Z.mouseOutDownPoint=null,Z.viewportCurrentID=0,Z.viewportCurrent=null,Z.viewportChangeTimeout=null},detectBrowserFeatures:function(){Z.browsers={UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5};var e=Z.browsers.UNKNOWN,t=0,i=1e4,a=navigator.appName,n=navigator.appVersion,l=!1,o=!1,r=navigator.userAgent.toLowerCase();if("Microsoft Internet Explorer"==a&&window.attachEvent&&window.ActiveXObject){var s=r.indexOf("msie");e=Z.browsers.IE,t=parseFloat(r.substring(s+5,r.indexOf(";",s))),l="undefined"!=typeof document.documentMode}else if("Netscape"==a&&-1!=r.indexOf("trident"))e=Z.browsers.IE,t=11;else if("Netscape"==a&&window.addEventListener){var u=r.indexOf("firefox"),d=r.indexOf("safari"),p=r.indexOf("chrome");if(u>=0)e=Z.browsers.FIREFOX,t=parseFloat(r.substring(u+8)),i=1e4;else if(d>=0){var c=r.substring(0,d).lastIndexOf("/");e=p>=0?Z.browsers.CHROME:Z.browsers.SAFARI,t=parseFloat(r.substring(c+1,d)),i=1e4}var g=new Image;g.style.getPropertyValue&&(o=g.style.getPropertyValue("image-rendering"))}else"Opera"==a&&window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera)&&(e=Z.browsers.OPERA,t=parseFloat(n));var m;if(window.XMLHttpRequest)netReq=new XMLHttpRequest,m="XMLHttpRequest";else if(window.ActiveXObject)for(var h=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],f=0,T=h.length;T>f;f++)try{netReq=new ActiveXObject(h[f]),m=h[f];break}catch(b){continue}for(var E,v,I=("response"in XMLHttpRequest.prototype||"mozResponseArrayBuffer"in XMLHttpRequest.prototype||"mozResponse"in XMLHttpRequest.prototype||"responseArrayBuffer"in XMLHttpRequest.prototype),y=document.createElement("canvas"),U=!(!y.getContext||!y.getContext("2d")),S=!(e==Z.browsers.SAFARI&&4>t||e==Z.browsers.CHROME&&2>t),A=U&&S,L=!(e==Z.browsers.CHROME&&2>t),x=l||o?"high":null,w=document.documentElement||{},O=w.style||{},R=!1,P=["transform","WebkitTransform","MozTransform","OTransform","msTransform"];E=P.shift();)if("undefined"!=typeof O[E]){R=!0,v=/webkit/i.test(E);break}var D=R,C=!1;("undefined"!=typeof document.cancelFullScreen||"undefined"!=typeof document.webkitCancelFullScreen||"undefined"!=typeof document.mozCancelFullScreen||"undefined"!=typeof document.oCancelFullScreen||"undefined"!=typeof document.msCancelFullScreen||"undefined"!=typeof document.msExitFullscreen)&&(C=!0);var N=Array.prototype.map,V=Array.prototype.splice,k=!1;try{{new Float32Array(1)}k=!0}catch(b){}var M=!1;try{{new Uint8Array(1)}M=!0}catch(b){}var F=!1;if("function"==typeof Object.defineProperty)try{Object.defineProperty({},"x",{}),F=!0}catch(b){}var _,H="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,B=r.indexOf("android")>-1||r.indexOf("iphone")>-1||r.indexOf("ipad")>-1||r.indexOf("ipod")>-1;switch(window.location.protocol){case"http:":_=!1;break;case"https:":_=!1;break;case"file:":_=!0;break;default:_=null}var z=!(Z.browser==Z.browsers.IE&&Z.browserVersion<9||Z.browser==Z.browsers.OPERA&&Z.browserVersion<15||Z.browser==Z.browsers.CHROME&&Z.browserVersion<25&&Z.browser==Z.browsers.FIREFOX&&Z.browserVersion<20&&Z.browser==Z.browsers.SAFARI&&Z.browserVersion<5);Z.browser=e,Z.browserVersion=t,Z.scaleThreshold=i,Z.xmlHttpRequestSupport=m,Z.responseArraySupported=I,Z.canvasSupported=A,Z.useCanvas=Z.canvasSupported,Z.imageFiltersVisible=!Z.useCanvas&&Z.imageFiltersVisible?!1:Z.imageFiltersVisible,Z.cssTransformsSupported=R,Z.cssTransformProperty=E,Z.cssTransformNoUnits=v,Z.alphaSupported=L,Z.renderQuality=x,Z.rotationSupported=D,Z.fullScreenSupported=C,Z.arrayMapSupported=N,Z.arraySpliceSupported=V,Z.float32ArraySupported=k,Z.uInt8ArraySupported=M,Z.definePropertySupported=F,Z.touchSupport=H,Z.mobileDevice=B,Z.localUse=_,Z.zifSupported=z},enforceCopyright:function(){var e=this.readCookie("imageCopyright");e?Z.Viewer.configureViewer():this.loadCopyrightText()},readCookie:function(e){for(var t=e+"=",i=document.cookie.split(";"),a=0,n=i.length;n>a;a++){for(var l=i[a];" "==l.charAt(0);)l=l.substring(1,l.length);if(0==l.indexOf(t))return l.substring(t.length,l.length)}return null},loadCopyrightText:function(){var e=new Z.NetConnector;e.loadXML(Z.copyrightPath)},showCopyright:function(e,t){var i=this.getResource("DEFAULT_COPYRIGHTSCREENCOLOR"),a=this.getResource("DEFAULT_COPYRIGHTBUTTONCOLOR");Z.CopyrightDisplay=this.createContainerElement("div","CopyrightDisplay","inline-block","absolute","hidden",Z.viewerW-2+"px",Z.viewerH-2+"px","0px","0px","solid","1px",i,"0px","0px","normal",null,!0),Z.ViewerDisplay.appendChild(Z.CopyrightDisplay);var n=parseInt(Z.Utils.getResource("DEFAULT_UIELEMENTBASEZINDEX"),10);Z.CopyrightDisplay.style.zIndex=(n+11).toString();var l=440,o=200,r=parseFloat(Z.CopyrightDisplay.style.width)/2-l/2,s=parseFloat(Z.CopyrightDisplay.style.height)/2-o/2,u=this.createContainerElement("div","textBox","inline-block","absolute","hidden",l+"px",o+"px",r+"px",s+"px","none","0px","transparent none","0px","0px","normal",null,!0);u.id="textBox",Z.CopyrightDisplay.appendChild(u);var d=document.createTextNode(e);u.appendChild(this.createCenteredElement(d,"copyrightTextNode")),this.setTextNodeStyle(d,"black","verdana","16px","none","normal","normal","normal","normal","1em","justify","none");var p=this.createContainerElement("div","declinedTextContainer","hidden","absolute","hidden","0px","0px","0px","0px","none","0px","transparent none","0px","0px","normal",null,!0),c=document.createTextNode(t);p.appendChild(c),u.appendChild(p);var g=80,m=20,h=30,f=20,T=r+l/2-(2*g+h)/2,b=s+o+f,E=this.getResource("UI_COPYRIGHTAGREEBUTTONTEXT"),v=new Z.Utils.Button("buttonAgree",E,null,null,null,null,g+"px",m+"px",T+"px",b+"px","mousedown",this.copyrightAgreeButtonHandler,"TIP_COPYRIGHTAGREE","solid","1px",a,"0px","0px");Z.CopyrightDisplay.appendChild(v.elmt),T+=g+h,E=this.getResource("UI_COPYRIGHTEXITBUTTONTEXT");var I=new Z.Utils.Button("buttonExit",E,null,null,null,null,g+"px",m+"px",T+"px",b+"px","mousedown",this.copyrightExitButtonHandler,"TIP_COPYRIGHTEXIT","solid","1px",a,"0px","0px");Z.CopyrightDisplay.appendChild(I.elmt)},hideCopyright:function(){var e=document.getElementById("copyrightTextNode").firstChild,t=document.getElementById("declinedTextContainer").firstChild.nodeValue;e.nodeValue=t;var i=document.getElementById("buttonAgree");Z.Utils.removeEventListener(i,"mousedown",this.copyrightAgreeButtonHandler),Z.CopyrightDisplay.removeChild(i);var a=document.getElementById("buttonExit");Z.Utils.removeEventListener(a,"mousedown",this.copyrightExitButtonHandler),Z.CopyrightDisplay.removeChild(a)},copyrightAgreeButtonHandler:function(){Z.ViewerDisplay.removeChild(Z.CopyrightDisplay),document.cookie="imageCopyright=confirmed",Z.Viewer.configureViewer()},copyrightExitButtonHandler:function(){Z.Utils.hideCopyright()},parseParameters:function(e){var t=[];if("object"==typeof e)t=e;else if("string"==typeof e)for(var i=e.split("&"),a=0,n=i.length;n>a;a++){var l=i[a],o=l.indexOf("=");if(o>0){var r=l.substring(0,o),s=l.substring(o+1);t[r]=s}}return t},parametersToDelimitedString:function(e,t){var i="";for(var a in e)i+=a+"="+e[a].toString()+t;return i=i.slice(0,-1)},setParameters:function(e){var t=this.getResource("ERROR_UNRECOGNIZEDPARAMETERALERT"),i=this.getResource("DEFAULT_EXPRESSPARAMETERSENABLETEST"),a=this.getResource("DEFAULT_EXPRESSPARAMETERSDISABLEVALUE"),n=this.getResource("DEFAULT_EXPRESSPARAMETERSDISABLEDALERT"),l=i!=a?!0:!1;l||(Z.logoLinkURL=Z.Utils.getResource("UI_LOGOLINK"));var o=this.getResource("DEFAULT_PROPARAMETERSENABLETEST"),r=this.getResource("DEFAULT_PROPARAMETERSDISABLEVALUE"),s=this.getResource("DEFAULT_PROPARAMETERSDISABLEDALERT"),u=o!=r?!0:!1,d=this.getResource("DEFAULT_SPECIALSTORAGESUPPORTENABLETEST"),p=this.getResource("DEFAULT_SPECIALSTORAGESUPPORTDISABLEVALUE"),c=this.getResource("DEFAULT_SPECIALSTORAGESUPPORTDISABLEDALERT");Z.specialStorageEnabled=d!=p?!0:!1;var g=this.getResource("DEFAULT_ENTERPRISEPARAMETERSENABLETEST"),m=this.getResource("DEFAULT_ENTERPRISEPARAMETERSDISABLEVALUE"),h=this.getResource("DEFAULT_ENTERPRISEPARAMETERSDISABLEDALERT"),f=g!=m?!0:!1;if(Z.skinPath=this.getResource("DEFAULT_SKINXMLPATH"),Z.skinMode=this.getResource("DEFAULT_SKINMODE"),isNaN(parseFloat(this.getResource("DEFAULT_INITIALX")))||(Z.initialX=parseFloat(this.getResource("DEFAULT_INITIALX"))),isNaN(parseFloat(this.getResource("DEFAULT_INITIALY")))||(Z.initialY=parseFloat(this.getResource("DEFAULT_INITIALY"))),isNaN(parseFloat(this.getResource("DEFAULT_INITIALZOOM")))||(Z.initialZ=parseFloat(this.getResource("DEFAULT_INITIALZOOM"))),isNaN(parseFloat(this.getResource("DEFAULT_MINZOOM")))||(Z.minZ=parseFloat(this.getResource("DEFAULT_MINZOOM"))),isNaN(parseFloat(this.getResource("DEFAULT_MAXZOOM")))||(Z.maxZ=parseFloat(this.getResource("DEFAULT_MAXZOOM"))),isNaN(parseFloat(this.getResource("DEFAULT_ZOOMSPEED")))||(Z.zoomSpeed=parseFloat(this.getResource("DEFAULT_ZOOMSPEED"))),isNaN(parseFloat(this.getResource("DEFAULT_PANSPEED")))||(Z.panSpeed=parseFloat(this.getResource("DEFAULT_PANSPEED"))),isNaN(parseFloat(this.getResource("DEFAULT_FADEINSPEED")))||(Z.fadeInSpeed=parseFloat(this.getResource("DEFAULT_FADEINSPEED"))),Z.navigatorVisible=parseInt(this.getResource("DEFAULT_NAVIGATORVISIBLE"),10),Z.navigatorW=parseInt(this.getResource("DEFAULT_NAVIGATORWIDTH"),10),Z.navigatorH=parseInt(this.getResource("DEFAULT_NAVIGATORHEIGHT"),10),Z.navigatorL=parseInt(this.getResource("DEFAULT_NAVIGATORLEFT"),10),Z.navigatorT=parseInt(this.getResource("DEFAULT_NAVIGATORTOP"),10),Z.navigatorFit=this.getResource("DEFAULT_NAVIGATORFIT"),Z.navigatorRectangleColor=this.getResource("DEFAULT_NAVIGATORRECTANGLECOLOR"),Z.clickZoom="0"!=this.getResource("DEFAULT_CLICKZOOM"),Z.doubleClickZoom="0"!=this.getResource("DEFAULT_DOUBLECLICKZOOM"),Z.doubleClickDelay=parseFloat(this.getResource("DEFAULT_DOUBLECLICKDELAY")),Z.clickPan="0"!=this.getResource("DEFAULT_CLICKPAN"),Z.mousePan="0"!=this.getResource("DEFAULT_MOUSEPAN"),Z.constrainPan="0"!=this.getResource("DEFAULT_CONSTRAINPAN"),Z.panBuffer=parseFloat(this.getResource("DEFAULT_PANBUFFER")),Z.constrainPanStrict="0"!=this.getResource("DEFAULT_CONSTRAINPANSTRICT"),Z.smoothPan=Z.useCanvas&&"0"!=this.getResource("DEFAULT_SMOOTHPAN"),Z.smoothPanEasing=parseInt(this.getResource("DEFAULT_SMOOTHPANEASING"),10),Z.smoothPanGlide=parseInt(this.getResource("DEFAULT_SMOOTHPANGLIDE"),10),Z.keys="0"!=this.getResource("DEFAULT_KEYS"),Z.canvas="0"!=this.getResource("DEFAULT_CANVAS"),Z.debug=parseInt(this.getResource("DEFAULT_DEBUG"),10),Z.toolbarVisible=parseInt(this.getResource("DEFAULT_TOOLBARVISIBLE"),10),Z.toolbarAutoShowHide=0!=Z.toolbarVisible&&1!=Z.toolbarVisible&&6!=Z.toolbarVisible&&7!=Z.toolbarVisible&&8!=Z.toolbarVisible,Z.toolbarPosition=parseFloat(this.getResource("DEFAULT_TOOLBARPOSITION")),Z.logoVisible="0"!=this.getResource("DEFAULT_LOGOVISIBLE"),Z.logoCustomPath=this.getResource("DEFAULT_LOGOCUSTOMPATH"),Z.minimizeVisible="0"!=this.getResource("DEFAULT_MINIMIZEVISIBLE"),Z.sliderZoomVisible="0"!=this.getResource("DEFAULT_SLIDERZOOMVISIBLE"),Z.mouseWheel=parseInt(this.getResource("DEFAULT_MOUSEWHEEL"),10),Z.panButtonsVisible="0"!=this.getResource("DEFAULT_PANBUTTONSVISIBLE"),Z.resetVisible="0"!=this.getResource("DEFAULT_RESETVISIBLE"),Z.tooltipsVisible="0"!=this.getResource("DEFAULT_TOOLTIPSVISIBLE"),Z.helpVisible=parseInt(this.getResource("DEFAULT_HELPVISIBLE"),10),Z.progressVisible="0"!=this.getResource("DEFAULT_PROGRESSVISIBLE"),Z.messagesVisible="0"!=this.getResource("DEFAULT_MESSAGESVISIBLE"),Z.fullViewVisible="0"!=this.getResource("DEFAULT_FULLVIEWVISIBLE"),Z.fullScreenVisible="0"!=this.getResource("DEFAULT_FULLSCREENVISIBLE"),Z.fullPageVisible="0"!=this.getResource("DEFAULT_FULLPAGEVISIBLE"),Z.initialFullPage="0"!=this.getResource("DEFAULT_INITIALFULLPAGE"),Z.measureVisible="0"!=this.getResource("DEFAULT_MEASUREVISIBLE"),Z.rotationVisible="0"!=this.getResource("DEFAULT_ROTATIONVISIBLE"),Z.initialR=this.getResource("DEFAULT_INITIALR"),isNaN(parseFloat(this.getResource("DEFAULT_SCREENSAVERSPEED")))||(Z.screensaverSpeed=parseFloat(this.getResource("DEFAULT_SCREENSAVERSPEED"))),isNaN(parseFloat(this.getResource("DEFAULT_MASKFADESPEED")))||(Z.maskFadeSpeed=parseFloat(this.getResource("DEFAULT_MASKFADESPEED"))),Z.maskClearOnUserAction="0"!=this.getResource("DEFAULT_MASKCLEARONUSERACTION"),Z.units=this.getResource("DEFAULT_UNITS"),Z.sourceMagnification=parseInt(this.getResource("DEFAULT_SOURCEMAGNIFICATION"),10),Z.virtualPointerVisible="0"!=this.getResource("DEFAULT_VIRTUALPOINTERVISIBLE"),Z.crosshairsVisible="0"!=this.getResource("DEFAULT_CROSSHAIRSVISIBLE"),Z.rulerVisible=parseInt(this.getResource("DEFAULT_RULERVISIBLE"),10),Z.rulerListType=this.getResource("DEFAULT_RULERLISTTYPE"),Z.rulerW=parseInt(this.getResource("DEFAULT_RULERWIDTH"),10),Z.rulerH=parseInt(this.getResource("DEFAULT_RULERHEIGHT"),10),Z.rulerL=parseInt(this.getResource("DEFAULT_RULERLEFT"),10),Z.rulerT=parseInt(this.getResource("DEFAULT_RULERTOP"),10),isNaN(parseFloat(this.getResource("DEFAULT_SLIDETRANSITIONSPEED")))||(Z.slideTransitionSpeed=parseFloat(this.getResource("DEFAULT_SLIDETRANSITIONSPEED"))),Z.coordinatesVisible="0"!=this.getResource("DEFAULT_COORDINATESVISIBLE"),Z.labelClickSelect="0"!=this.getResource("DEFAULT_LABELCLICKSELECT"),Z.sliderImageSetVisible="0"!=this.getResource("DEFAULT_IMAGESETSLIDERVISIBLE"),"object"==typeof e&&null!==e){Z.annotationPathProvided=void 0!==e.zHotspotPath||void 0!==e.zAnnotationPath||void 0!==e.zAnnotationXMLText||void 0!==e.zAnnotationJSONObject,Z.saveHandlerProvided=void 0!==e.zSaveHandlerPath||void 0!==e.zNoPost&&"1"==e.zNoPost,Z.imageSetPathProvided=void 0!==e.zAnimationPath||void 0!==e.zSlidestackPath,Z.saveImageHandlerProvided=void 0!==e.zSaveImageHandlerPath,Z.mouseWheelParmeterProvided=void 0!==e.zMouseWheel;for(var T in e)if("function"!=typeof e[T]||"zOnAnnotationReady"===T||"zOnReady"===T)if("undefined"==typeof Z[Z.Utils.stringLowerCaseFirstLetter(T.substr(1))])alert(t+" "+T);else if(pValue=e[T],l||"zNavigatorVisible"==T)switch(T){case"zOnAnnotationReady":"function"==typeof pValue&&Z.setCallback("annotationPanelInitialized",pValue);break;case"zOnReady":"function"==typeof pValue&&Z.setCallback("readyViewer",pValue);break;case"zInitialX":isNaN(parseFloat(pValue))||(Z.initialX=parseFloat(pValue));break;case"zInitialY":isNaN(parseFloat(pValue))||(Z.initialY=parseFloat(pValue));break;case"zInitialZoom":"fit"==pValue&&(pValue="-1"),"fill"==pValue&&(pValue="0"),isNaN(parseFloat(pValue))||(Z.initialZ=parseFloat(pValue),Z.initialZ&&Z.initialZ>0&&Z.initialZ<=100&&(Z.initialZ/=100));break;case"zMinZoom":"fit"==pValue&&(pValue="-1"),"fill"==pValue&&(pValue="0"),isNaN(parseFloat(pValue))||(Z.minZ=parseFloat(pValue),Z.minZ&&Z.minZ>0&&Z.minZ<=100&&(Z.minZ/=100));break;case"zMaxZoom":isNaN(parseFloat(pValue))||(Z.maxZ=parseFloat(pValue),Z.maxZ&&-1!=Z.maxZ&&(Z.maxZ/=100));break;case"zNavigatorVisible":Z.navigatorVisible=parseInt(pValue,10);break;case"zToolbarVisible":Z.toolbarVisible=parseInt(pValue,10),Z.toolbarAutoShowHide=0!=Z.toolbarVisible&&1!=Z.toolbarVisible&&6!=Z.toolbarVisible&&7!=Z.toolbarVisible&&8!=Z.toolbarVisible;break;case"zLogoVisible":"0"==pValue&&(Z.logoVisible=!1);break;case"zMinimizeVisible":"0"==pValue&&(Z.minimizeVisible=!1);break;case"zSliderVisible":"0"==pValue&&(Z.sliderZoomVisible=!1);break;case"zPanButtonsVisible":"0"==pValue&&(Z.panButtonsVisible=!1);break;case"zResetVisible":"0"==pValue&&(Z.resetVisible=!1);break;case"zFullViewVisible":"1"==pValue?(Z.fullScreenVisible=!0,Z.fullPageVisible=!1):"0"==pValue&&(Z.fullScreenVisible=!1,Z.fullPageVisible=!1);break;case"zFullScreenVisible":"0"==pValue&&(Z.fullScreenVisible=!1,Z.fullPageVisible=!1);break;case"zFullPageVisible":"1"==pValue&&(Z.fullScreenVisible=!1,Z.fullPageVisible=!0);break;case"zInitialFullPage":"1"==pValue&&(Z.initialFullPage=!0);break;case"zFullPageInitial":alert(Z.Utils.getResource("ERROR_PARAMETERDEPRECATED")+" zFullPageInitial is now zInitialFullPage");break;case"zProgressVisible":"0"==pValue&&(Z.progressVisible=!1);break;case"zTooltipsVisible":"0"==pValue&&(Z.tooltipsVisible=!1);break;case"zHelpVisible":Z.helpVisible=parseInt(pValue,10);break;case"zNavigatorRectangleColor":Z.navigatorRectangleColor=pValue;break;case"zSkinPath":Z.skinPath=pValue;break;default:if(u)switch(T){case"zZoomSpeed":Z.zoomSpeed=parseInt(pValue,10);break;case"zPanSpeed":Z.panSpeed=parseInt(pValue,10);break;case"zFadeInSpeed":Z.fadeInSpeed=parseInt(pValue,10);break;case"zClickZoom":"0"==pValue&&(Z.clickZoom=!1);break;case"zDoubleClickZoom":"0"==pValue&&(Z.doubleClickZoom=!1);break;case"zDoubleClickDelay":Z.doubleClickDelay=parseInt(pValue,10);break;case"zClickPan":"0"==pValue&&(Z.clickPan=!1);break;case"zMousePan":"0"==pValue&&(Z.mousePan=!1);break;case"zKeys":"0"==pValue&&(Z.keys=!1);break;case"zMessagesVisible":Z.messagesVisible=parseInt(pValue,10);break;case"zConstrainPan":Z.constrainPan="0"==pValue?!1:!0,Z.constrainPanStrict="2"==pValue?!0:!1;break;case"zPanBuffer":var b=parseFloat(pValue);isNaN(b)||(Z.panBuffer=b);break;case"zSmoothPan":"0"==pValue&&(Z.smoothPan=!1);break;case"zSmoothPanEasing":var E=parseInt(pValue,10);E>=1&&5>=E&&(Z.smoothPanEasing=E);break;case"zSmoothPanGlide":var v=parseInt(pValue,10);v>=1&&5>=v&&(Z.smoothPanGlide=v);break;case"zAutoResize":"0"==pValue&&(Z.autoResize=!1);break;case"zCanvas":"0"==pValue&&(Z.canvas=!1),Z.canvasSupported&&Z.canvas||(Z.useCanvas=!1);break;case"zDebug":Z.debug=parseInt(pValue,10);break;case"zImageProperties":Z.imageProperties=pValue;break;case"zNavigatorWidth":isNaN(parseInt(pValue,10))||(Z.navigatorW=parseInt(pValue,10));break;case"zNavigatorHeight":isNaN(parseInt(pValue,10))||(Z.navigatorH=parseInt(pValue,10));break;case"zNavigatorLeft":isNaN(parseInt(pValue,10))||(Z.navigatorL=parseInt(pValue,10));break;case"zNavigatorTop":isNaN(parseInt(pValue,10))||(Z.navigatorT=parseInt(pValue,10));
break;case"zNavigatorFit":isNaN(parseFloat(pValue))||(Z.navigatorFit=parseInt(pValue,10));break;case"zToolbarPosition":Z.toolbarPosition=parseInt(pValue,10);break;case"zLogoCustomPath":Z.logoCustomPath=pValue;break;case"zRotationVisible":"1"==pValue&&(Z.rotationVisible=!0);break;case"zInitialRotation":isNaN(parseFloat(pValue))||(Z.initialR=parseInt(pValue,10));break;case"zVirtualPointerVisible":"1"==pValue&&(Z.virtualPointerVisible=!0);break;case"zCrosshairsVisible":"1"==pValue&&(Z.crosshairsVisible=!0);break;case"zMeasureVisible":Z.measureVisible="1"==pValue?!0:!1;break;case"zCaptionTextColor":Z.captionTextColor=Z.Utils.stringValidateColorValue(pValue),Z.captionsColorsDefault=!1;break;case"zCaptionBackColor":Z.captionBackColor=Z.Utils.stringValidateColorValue(pValue),Z.captionsColorsDefault=!1;break;case"zPolygonLineColor":Z.polygonLineColor=Z.Utils.stringValidateColorValue(pValue);break;case"zPolygonFillColor":Z.polygonFillColor=Z.Utils.stringValidateColorValue(pValue);break;case"zCaptionTextVisible":"0"==pValue&&(Z.captionTextVisible=!1);break;case"zCaptionBackVisible":"0"==pValue&&(Z.captionBackVisible=!1);break;case"zPolygonLineVisible":"0"==pValue&&(Z.polygonLineVisible=!1);break;case"zPolygonFillVisible":"0"==pValue&&(Z.polygonFillVisible=!1);break;case"zRulerVisible":Z.rulerVisible=parseInt(pValue,10);break;case"zRulerListType":this.stringValidate(pValue)&&(Z.rulerListType=pValue);break;case"zRulerWidth":isNaN(parseInt(pValue,10))||(Z.rulerW=parseInt(pValue,10));break;case"zRulerHeight":isNaN(parseInt(pValue,10))||(Z.rulerH=parseInt(pValue,10));break;case"zRulerLeft":isNaN(parseInt(pValue,10))||(Z.rulerL=parseInt(pValue,10));break;case"zRulerTop":isNaN(parseInt(pValue,10))||(Z.rulerT=parseInt(pValue,10));break;case"zUnits":this.stringValidate(pValue)&&(Z.units=pValue);break;case"zUnitsPerImage":isNaN(parseFloat(pValue))||(Z.unitsPerImage=parseFloat(pValue));break;case"zPixelsPerUnit":isNaN(parseFloat(pValue))||(Z.pixelsPerUnit=parseFloat(pValue));break;case"zSourceMagnification":isNaN(parseInt(pValue,10))||(Z.sourceMagnification=parseInt(pValue,10));break;case"zMagnification":alert(Z.Utils.getResource("ERROR_PARAMETERDEPRECATED")+" zMagnification is now zSourceMagnification");break;case"zWatermarkPath":Z.watermarkPath=pValue;break;case"zCopyrightPath":Z.copyrightPath=pValue;break;case"zCoordinatesVisible":"1"==pValue&&(Z.coordinatesVisible=!0);break;case"zHotspotPath":Z.hotspotPath=Z.Utils.stringRemoveTrailingSlashCharacters(pValue),Z.hotspotFolder=Z.hotspotPath,".xml"==Z.hotspotPath.toLowerCase().substring(Z.hotspotPath.length-4,Z.hotspotPath.length)&&(Z.hotspotFolder=Z.hotspotFolder.substring(0,Z.hotspotFolder.lastIndexOf("/"))),Z.hotspots=!0;break;case"zHotspotListTitle":Z.hotspotListTitle=pValue;break;case"zHotspotsDrawOnlyInView":"0"==pValue&&(Z.hotspotsDrawOnlyInView=!1);break;case"zCaptionBoxes":"1"==pValue&&(Z.captionBoxes=!0);break;case"zScreensaver":"1"==pValue&&(Z.screensaver=!0,Z.tour=!0);break;case"zScreensaverSpeed":Z.screensaverSpeed=parseInt(pValue,10);break;case"zTourPath":Z.tourPath=Z.Utils.stringRemoveTrailingSlashCharacters(pValue),Z.hotspotPath=Z.tourPath,Z.hotspotFolder=Z.hotspotPath,".xml"==Z.hotspotPath.toLowerCase().substring(Z.hotspotPath.length-4,Z.hotspotPath.length)&&(Z.hotspotFolder=Z.hotspotFolder.substring(0,Z.hotspotFolder.lastIndexOf("/"))),Z.tour=!0;break;case"zTourListTitle":Z.tourListTitle=pValue;break;case"zSlidePath":Z.slidePath=Z.Utils.stringRemoveTrailingSlashCharacters(pValue),Z.slideshow=!0;break;case"zSlideListTitle":Z.slideListTitle=pValue;break;case"zAnimationPath":Z.imageSetPath=Z.Utils.stringRemoveTrailingSlashCharacters(pValue),Z.imageSet=!0,Z.animation=!0,Z.mouseWheelParmeterProvided||(Z.mouseWheel=parseInt(this.getResource("DEFAULT_MOUSEWHEELANIMATION"),10),Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom");break;case"zImageSetSliderVisible":"0"==pValue&&(Z.sliderImageSetVisible=!1);break;case"zMouseWheel":Z.mouseWheel=parseInt(pValue,10),Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom";break;case"zTilesPNG":"1"==pValue&&(Z.tileType="png");break;case"zTileW":Z.tileW=parseInt(pValue,10);break;case"zTileH":Z.tileH=parseInt(pValue,10);break;default:if(f)switch(T){case"zLabelClickSelect":"1"==pValue&&(Z.labelClickSelect=!0);break;case"zMaskVisible":"1"==pValue&&(Z.maskVisible=!0);break;case"zMaskFadeSpeed":Z.maskFadeSpeed=parseInt(pValue,10);break;case"zMaskClearOnUserAction":"0"==pValue&&(Z.maskClearOnUserAction=!1);break;default:if(Z.specialStorageEnabled==p)alert(c+" "+T);else switch(T){case"zServerIP":Z.serverIP=pValue;break;case"zServerPort":Z.serverPort=pValue;break;case"zTileHandlerPath":Z.tileHandlerPath=pValue;break;case"zImageW":Z.imageW=parseInt(pValue,10),Z.imageCenterX=Z.imageW/2;break;case"zImageH":Z.imageH=parseInt(pValue,10),Z.imageCenterY=Z.imageH/2;break;case"zFocal":Z.focal=parseInt(pValue,10);break;case"zQuality":Z.quality=parseInt(pValue,10)}}else alert(h+" "+T)}else alert(s+" "+T)}else alert(n+" "+T)}if(Z.Utils.stringValidate(Z.annotationPath)||Z.Utils.stringValidate(Z.saveHandlerPath)||Z.Utils.stringValidate(Z.saveImageHandlerPath))if(f){if(Z.Utils.stringValidate(Z.saveHandlerPath)){var I=Z.saveHandlerPath,y=Z.saveImageHandlerPath;Z.saveHandlerPath=I,Z.saveImageHandlerPath=y}}else Z.annotationPath="",alert(h);Z.Utils.validateImagePath()},resetParametersXYZ:function(e){if(isNaN(parseFloat(this.getResource("DEFAULT_INITIALX")))||(Z.initialX=parseFloat(this.getResource("DEFAULT_INITIALX"))),isNaN(parseFloat(this.getResource("DEFAULT_INITIALY")))||(Z.initialY=parseFloat(this.getResource("DEFAULT_INITIALY"))),isNaN(parseFloat(this.getResource("DEFAULT_INITIALZOOM")))||(Z.initialZ=parseFloat(this.getResource("DEFAULT_INITIALZOOM"))),isNaN(parseFloat(this.getResource("DEFAULT_MINZOOM")))||(Z.minZ=parseFloat(this.getResource("DEFAULT_MINZOOM"))),isNaN(parseFloat(this.getResource("DEFAULT_MAXZOOM")))||(Z.maxZ=parseFloat(this.getResource("DEFAULT_MAXZOOM"))),this.stringValidate(e))for(var t=0,i=e.length;i>t;t++){var a=e[t],n=a.indexOf("=");if(n>0){var l=a.substring(0,n),o=a.substring(n+1);if(this.stringValidate(o))switch(l){case"zInitialX":isNaN(parseFloat(o))||(Z.initialX=parseFloat(o));break;case"zInitialY":isNaN(parseFloat(o))||(Z.initialY=parseFloat(o));break;case"zInitialZoom":"fit"==o&&(o="-1"),"fill"==o&&(o="0"),isNaN(parseFloat(o))||(Z.initialZ=parseFloat(o),Z.initialZ&&Z.initialZ>0&&Z.initialZ<=100&&(Z.initialZ/=100));break;case"zMinZoom":"fit"==o&&(o="-1"),"fill"==o&&(o="0"),isNaN(parseFloat(o))||(Z.minZ=parseFloat(o),Z.minZ&&Z.minZ>0&&Z.minZ<=100&&(Z.minZ/=100));break;case"zMaxZoom":isNaN(parseFloat(o))||(Z.maxZ=parseFloat(o),Z.maxZ&&-1!=Z.maxZ&&(Z.maxZ/=100))}}}},validateImagePath:function(e){var t="undefined"!=typeof e&&Z.Utils.stringValidate(e)?e:Z.imagePath;if(null!==t){{this.getResource("DEFAULT_SPECIALSTORAGESUPPORTDISABLEDALERT")}-1!=t.toLowerCase().indexOf(".zif")?Z.zifSupported?(Z.tileSource="ZoomifyImageFile",Z.Utils.validateResponseArrayFunctionality()):alert(this.getResource("ALERT_ZIFREQUIRESNEWERBROWSER")):-1!=t.toLowerCase().indexOf(".jpg")||-1!=t.toLowerCase().indexOf(".png")?Z.tileSource="ZoomifyImageFolder":Z.Utils.stringValidate(Z.tileHandlerPath)||(Z.tileSource="ZoomifyImageFolder")}else(Z.imageSet||Z.slideshow)&&(Z.tileSourceMultiple=!0)},clearImageParameters:function(){Z.imagePath=null,Z.parameters=null,Z.initialX=null,Z.initialY=null,Z.initialZ=null,Z.minZ=null,Z.maxZ=null,Z.hotspots=!1,Z.hotspotPath=null,Z.hotspotFolder=null,Z.tour=!1,Z.tourPath=null,Z.tourPlaying=null,Z.tourStop=!1,Z.annotations=!1,Z.annotationPath=null,Z.annotationPanelVisible=null,Z.annotationFolder=null,Z.annotationJSONObject=null,Z.annotationXMLText=null,Z.annotationsAddMultiple=null,Z.annotationsAutoSave=null,Z.postingXML=!1,Z.postingImage=!1,Z.initialR=null,Z.unitsPerImage=null,Z.pixelsPerUnit=null,Z.sourceMagnification=null,Z.imageProperties=null,Z.tileW=null,Z.tileH=null,Z.tileType="jpg",Z.annotationPathProvided=!1,Z.imageSetPathProvided=!1,Z.tileSource=null,Z.tileSourceMultiple=null,Z.focal=null,Z.quality=null,Z.markupMode=null,Z.editMode=null,Z.editing=null,Z.labelMode="view",Z.editModePrior=Z.editMode,Z.sliderFocus="zoom",Z.animation=!1,Z.animationPath=null,Z.animationCount=0,Z.animationAxis=null,Z.animator=null,Z.slidestack=!1,Z.slidestackPath=null,Z.imageSet=!1,Z.imageSetPath=null,Z.imageSetLength=null,Z.sliderImageSetVisible=null,Z.imageSetSliderVisible=null,Z.mouseWheelParmeterProvided=null,Z.mouseWheel=null,Z.imageSetHotspotPath=null,Z.hotspotFileShared=!1,Z.imageSetAnnotationPath=null,Z.annotationFileShared=!1,Z.imageW=null,Z.imageH=null,Z.imageCenterX=null,Z.imageCenterY=null,Z.imageX=0,Z.imageY=0,Z.imageZ=0,Z.imageR=0,Z.priorX=0,Z.priorY=0,Z.priorZ=0,Z.priorR=0,Z.fitZ=null,Z.fillZ=null,Z.zooming="stop",Z.panningX="stop",Z.panningY="stop",Z.fullView=!1,Z.fullViewPrior=!1},getResource:function(e){var t="";switch(e){case"DEFAULT_EXPRESSPARAMETERSENABLETEST":t="Enable Express parameters";break;case"DEFAULT_EXPRESSPARAMETERSDISABLEVALUE":t="Changing This Violates License Agreement";break;case"DEFAULT_EXPRESSPARAMETERSDISABLEDALERT":t="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Express, Pro, and Enterprise editions: ";break;case"DEFAULT_PROPARAMETERSENABLETEST":t="Enable Pro parameters";break;case"DEFAULT_PROPARAMETERSDISABLEVALUE":t="Changing This Violates License Agreement";break;case"DEFAULT_PROPARAMETERSDISABLEDALERT":t="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Pro and Enterprise editions: ";break;case"DEFAULT_SPECIALSTORAGESUPPORTENABLETEST":t="Changing this violates License Agreement";break;case"DEFAULT_SPECIALSTORAGESUPPORTDISABLEVALUE":t="Changing this violates License Agreement";break;case"DEFAULT_SPECIALSTORAGESUPPORTDISABLEDALERT":t="Support for Zoomify Image File (PFF) storage and other special storage options is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Enterprise edition.";break;case"DEFAULT_ENTERPRISEPARAMETERSENABLETEST":t="Changing this violates License Agreement";break;case"DEFAULT_ENTERPRISEPARAMETERSDISABLEVALUE":t="Changing this violates License Agreement";break;case"DEFAULT_ENTERPRISEPARAMETERSDISABLEDALERT":t="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Enterprise edition: ";break;case"DEFAULT_HEADERSTARTBYTE":t="0";break;case"DEFAULT_HEADERENDBYTEZIF":t="8192";break;case"DEFAULT_CHUNKSIZE":t="1024";break;case"DEFAULT_TILEW":t="256";break;case"DEFAULT_TILEH":t="256";break;case"DEFAULT_IMAGESLOADINGMAX":t="300";break;case"DEFAULT_IMAGELOADTIMEOUT":t="60000";break;case"DEFAULT_IMAGELOADQUEUEDELAY":t="100";break;case"DEFAULT_TIERSMAXSCALEUP":t="1.15";break;case"DEFAULT_TILESMAXCACHE":t="300";break;case"DEFAULT_BACKFILLTHRESHOLD3":t="6";break;case"DEFAULT_BACKFILLDYNAMICADJUST":t="3";break;case"DEFAULT_BACKFILLTHRESHOLD2":t="5";break;case"DEFAULT_BACKFILLCHOICE2":t="3";break;case"DEFAULT_BACKFILLTHRESHOLD1":t="3";break;case"DEFAULT_BACKFILLCHOICE1":t="2";break;case"DEFAULT_BACKFILLCHOICE0":t="0";break;case"DEFAULT_PANBUFFER":t=Z.mobileDevice?"1":"1.5",Z.rotationVisible&&(t="2");break;case"DEFAULT_PANBUFFERUNCONVERTED":t=Z.mobileDevice?Z.rotationVisible?"2":"1":"10";break;case"DEFAULT_PAN_BUFFERSIZEMAXBROWSER":t="10000";break;case"DEFAULT_PAN_BUFFERSIZEMAXFIREFOX":t="4000";break;case"DEFAULT_PAN_BUFFERSIZEMAXIMAGESET":t="1000";break;case"DEFAULT_BACKFILLBUFFER":t=Z.mobileDevice?"1":"2";break;case"DEFAULT_CANVAS":t="1";break;case"DEFAULT_UIELEMENTBASEZINDEX":t="2000";break;case"DEFAULT_VALIDATEVIEWRETRYLIMIT":t="2";break;case"DEFAULT_VALIDATEVIEWRETRYDELAY":t="1000";break;case"DEFAULT_DEBUG":t="0";break;case"DEFAULT_PANSPEED":t="5";break;case"DEFAULT_PANSTEPDISTANCE":t="10";break;case"DEFAULT_ZOOMSPEED":t="5";break;case"DEFAULT_ZOOMSTEPDISTANCE":t="0.02";break;case"DEFAULT_ZAPSTEPDURATION":t="30";break;case"DEFAULT_ZAPTVSTEPS":t="20";break;case"DEFAULT_ZAPTVDURATION":t="800";break;case"DEFAULT_CLICKZOOMTIERSKIPTHRESHOLD":t="0.2";break;case"DEFAULT_GESTURETESTDURATION":t="10";break;case"DEFAULT_AUTORESIZESKIPDURATION":t="10";break;case"DEFAULT_MOUSEWHEEL":t="1";break;case"DEFAULT_MOUSEWHEELANIMATION":t="1";break;case"DEFAULT_MOUSEWHEELSLIDESTACK":t="1";break;case"DEFAULT_MOUSEWHEELCOMPLETEDURATION":t="300";break;case"DEFAULT_FADEINSPEED":t="5";break;case"DEFAULT_FADEINSTEP":t="0.067";break;case"DEFAULT_KEYS":t="1";break;case"DEFAULT_MOUSEPAN":t="1";break;case"DEFAULT_CLICKPAN":t="1";break;case"DEFAULT_CLICKZOOM":t="1";break;case"DEFAULT_DOUBLECLICKZOOM":t="1";break;case"DEFAULT_DOUBLECLICKDELAY":t="250";break;case"DEFAULT_CONSTRAINPAN":t="1";break;case"DEFAULT_CONSTRAINPANSTRICT":t="0";break;case"DEFAULT_SMOOTHPAN":t="1";break;case"DEFAULT_SMOOTHPANEASING":t="2";break;case"DEFAULT_SMOOTHPANGLIDE":t="2";break;case"DEFAULT_INITIALX":t=null;break;case"DEFAULT_INITIALY":t=null;break;case"DEFAULT_INITIALZOOM":t=null;break;case"DEFAULT_MINZOOM":t=null;break;case"DEFAULT_MAXZOOM":t="1";break;case"DEFAULT_BACKGROUNDCOLOR":t="#FBFAFA";break;case"DEFAULT_BACKGROUNDCOLORNOALPHA":t="#FBFAFA";break;case"DEFAULT_BACKGROUNDCOLORLIGHT":t="#FEFEFE";break;case"DEFAULT_BACKGROUNDALPHA":t="0.75";break;case"DEFAULT_BACKGROUNSMALLDALPHA":t="0.75";break;case"DEFAULT_BUTTONBORDERCOLOR":t="#C0C0C0";break;case"DEFAULT_SKINXMLFILE":t="skinFiles.xml";break;case"DEFAULT_SKINXMLPATH":t="http://collections.centerofthewest.org/Assets/Skins/Default";break;case"DEFAULT_SKINMODE":t="0";break;case"DEFAULT_NAVIGATORVISIBLE":t="2";break;case"DEFAULT_NAVIGATORWIDTH":t="150";break;case"DEFAULT_NAVIGATORHEIGHT":t="100";break;case"DEFAULT_NAVIGATORLEFT":t="-1";break;case"DEFAULT_NAVIGATORTOP":t="-1";break;case"DEFAULT_NAVIGATORFIT":t=null;break;case"DEFAULT_NAVIGATORRECTANGLECOLOR":t="#0000FF";break;case"DEFAULT_TOOLBARVISIBLE":t="4";break;case"DEFAULT_TOOLBARPOSITION":t="1";break;case"DEFAULT_TOOLTIPSVISIBLE":t="1";break;case"DEFAULT_HELPVISIBLE":t="1";break;case"DEFAULT_LOGOVISIBLE":t="1";break;case"DEFAULT_LOGOCUSTOMPATH":t=null;break;case"DEFAULT_MINIMIZEVISIBLE":t="1";break;case"DEFAULT_SLIDERZOOMVISIBLE":t="1";break;case"DEFAULT_SLIDERTESTDURATIONZOOM":t="10";break;case"DEFAULT_PANBUTTONSVISIBLE":t="1";break;case"DEFAULT_RESETVISIBLE":t="1";break;case"DEFAULT_FULLVIEWVISIBLE":t="1";break;case"DEFAULT_FULLSCREENVISIBLE":t="1";break;case"DEFAULT_FULLVIEWBACKCOLOR":t="white";break;case"DEFAULT_FULLPAGEVISIBLE":t="0";break;case"DEFAULT_INITIALFULLPAGE":t="0";break;case"DEFAULT_VIRTUALPOINTERPATH":t="Assets/VirtualPointer/virtualPointer.png";break;case"DEFAULT_MEASUREVISIBLE":t="undefined"==typeof Z.parameters||null===Z.parameters||"undefined"!=typeof Z.parameters.zMeasureVisible&&"0"==Z.parameters.zMeasureVisible||!("undefined"!=typeof Z.parameters.zMarkupMode&&"1"==Z.parameters.zMarkupMode||"undefined"!=typeof Z.parameters.zEditMode&&"1"==Z.parameters.zEditMode)?"0":"1";break;case"DEFAULT_FULLVIEWEXITEXTERNALBUTTONCOLOR":t="	#F8F8F8";break;case"DEFAULT_ROTATIONVISIBLE":t="0";break;case"DEFAULT_INITIALR":t="0";break;case"DEFAULT_PROGRESSVISIBLE":t="1";break;case"DEFAULT_PROGRESSDURATION":t="500";break;case"DEFAULT_PROGRESSTEXT":t=" ";break;case"DEFAULT_PROGRESSTEXTCOLOR":t="#000000";break;case"DEFAULT_MESSAGESVISIBLE":t="1";break;case"DEFAULT_SOURCEMAGNIFICATION":t="40";break;case"DEFAULT_UNITS":t="pixels";break;case"DEFAULT_VIRTUALPOINTERVISIBLE":t="0";break;case"DEFAULT_CROSSHAIRSVISIBLE":t="0";break;case"DEFAULT_RULERVISIBLE":t="0";break;case"DEFAULT_RULERLISTTYPE":t="2";break;case"DEFAULT_RULERTEXTFONTSIZE":t="10";break;case"DEFAULT_SCALEBARCOLOR":t="#696969";break;case"DEFAULT_RULERWIDTH":t="150";break;case"DEFAULT_RULERHEIGHT":t="30";break;case"DEFAULT_RULERLEFT":t="-1";break;case"DEFAULT_RULERTOP":t="-1";break;case"DEFAULT_COORDINATESVISIBLE":t="0";break;case"DEFAULT_WATERMARKALPHA":t="0.6";break;case"DEFAULT_WATERMARKMINSCALE":t="0.33";break;case"DEFAULT_WATERMARKSPANW":t="512";break;case"DEFAULT_WATERMARKSPANH":t="384";break;case"DEFAULT_SCREENSAVERSPEED":t="5";break;case"DEFAULT_MASKFADESPEED":t="5";break;case"DEFAULT_MASKFADESTEP":t="0.05";break;case"DEFAULT_MASKCLEARONUSERACTION":t="1";break;case"DEFAULT_COPYRIGHTSCREENCOLOR":t="#D3D3D3";break;case"DEFAULT_COPYRIGHTBUTTONCOLOR":t="#FFFFFF";break;case"DEFAULT_TOURSXMLFILE":t="destinations.xml";break;case"DEFAULT_TOURAUTOSTART":t=!0;break;case"DEFAULT_TOURAUTOLOOP":t=!0;break;case"DEFAULT_SLIDESXMLFILE":t="slides.xml";break;case"DEFAULT_SLIDESHOWAUTOSTART":t=!0;break;case"DEFAULT_SLIDESHOWAUTOLOOP":t=!0;break;case"DEFAULT_SLIDELISTSOURCE":t="NAME";break;case"DEFAULT_SLIDELISTWIDTH":t="200";break;case"DEFAULT_SLIDELISTPOSITION":t="2";break;case"DEFAULT_SLIDETRANSITIONSPEED":t="2";break;case"DEFAULT_SLIDETRANSITIONSTEP":t="0.05";break;case"DEFAULT_MEASURECAPTIONWIDTH":t="170";break;case"DEFAULT_MEASURECAPTIONHEIGHT":t="12";break;case"DEFAULT_MEASURECAPTIONBACKOPACITY":t="0.3";break;case"DEFAULT_MEASURECAPTIONFONTSIZE":t="11";break;case"DEFAULT_HOTSPOTSXMLFILE":t="hotspots.xml";break;case"DEFAULT_HOTSPOTCAPTIONPADDING":t="6";break;case"DEFAULT_HOTSPOTCAPTIONPADDINGCANVAS":t="12";break;case"DEFAULT_MINHOTSPOTCAPTIONPADDING":t="2";break;case"DEFAULT_MAXHOTSPOTCAPTIONPADDING":t="7";break;case"DEFAULT_HOTSPOTCAPTIONFONTSIZE":t="14";break;case"DEFAULT_MINHOTSPOTCAPTIONFONTSIZE":t="3";break;case"DEFAULT_MAXHOTSPOTCAPTIONFONTSIZE":t="14";break;case"DEFAULT_FONTTOPIXELSCONVERSIONFACTOR":t="1.8";break;case"DEFAULT_HOTSPOTSINITIALVISIBILITY":t=!0;break;case"DEFAULT_HOTSPOTSMINSCALE":t="0.2";break;case"DEFAULT_HOTSPOTSMAXSCALE":t="2";break;case"DEFAULT_HOTSPOTLISTSOURCE":t="NAME";break;case"DEFAULT_HOTSPOTLISTWIDTH":t="200";break;case"DEFAULT_HOTSPOTLISTPOSITION":t="2";break;case"DEFAULT_LABELCLICKSELECT":t="0";break;case"DEFAULT_ANNOTATIONSXMLFILE":t="annotations.xml";break;case"DEFAULT_ANNOTATIONMEDIA":t="circle.png";break;case"DEFAULT_ANNOTATIONMEDIATYPE":t="icon";break;case"DEFAULT_POLYGONLINEWIDTH":t=2;break;case"DEFAULT_POLYGONOPACITY":t=.3;break;case"DEFAULT_POLYGONVIEWBUFFER":t=300;break;case"DEFAULT_CONTROLPOINTLINEWIDTH":t="1";break;case"DEFAULT_CONTROLPOINTSTROKECOLOR":t="#FFFFFF";break;case"DEFAULT_CAPTIONTEXTCOLOR":t="#FFFFFF";break;case"DEFAULT_CAPTIONBACKCOLOR":t="#000000";break;case"DEFAULT_POLYGONLINEWIDTHFREEHAND":t=2;break;case"DEFAULT_FIRSTCONTROLPOINTFILLCOLOR":t="#FFFFFF";break;case"DEFAULT_STANDARDCONTROLPOINTFILLCOLOR":t="#999999";break;case"DEFAULT_CONTROLPOINTRADIUS":t="10";break;case"DEFAULT_IMAGESETLISTSOURCE":t="NAME";break;case"DEFAULT_IMAGESETLISTWIDTH":t="222";break;case"DEFAULT_IMAGESETLISTPOSITION":t="2";break;case"DEFAULT_IMAGESETSLIDERVISIBLE":t="1";break;case"DEFAULT_SLIDERTESTDURATIONIMAGESET":t="10";break;case"DEFAULT_ANIMATIONOPTIMALMOTIONIMAGES":t="30";break;case"DEFAULT_ANIMATIONOPTIMALPOSITIONDELTA":t="50";break;case"DEFAULT_ANIMATIONAXIS":t="horizontal";break;case"DEFAULT_ANIMATOR":t="motion";break;case"DEFAULT_HELPSCREENCOLOR":t="lightgray";break;case"DEFAULT_HELPBUTTONCOLOR":t="white";break;case"DEFAULT_MESSAGESCREENCOLOR":t="lightgray";break;case"DEFAULT_MESSAGEBUTTONCOLOR":t="white";break;case"DEFAULT_COORDINATESSCREENCOLOR":t="lightgray";break;case"DEFAULT_TRACEDISPLAYTEXTFONTSIZE":t="11";break;case"DEFAULT_TRACEDISPLAYTEXTPADDINGSMALL":t="2";break;case"DEFAULT_TRACEDISPLAYSCREENCOLOR":t="#D3D3D3";break;case"DEFAULT_TRACEDISPLAYBUTTONCOLOR":t="#FFFFFF";break;case"DEFAULT_IMAGESETXMLFILE":t=Z.animation?"animation.xml":"slidestack.xml";break;case"ALERT_POLYGONSREQUIRECANVAS":t="Displaying or editing polygon hotspots requires a browser that supports the HTML5 canvas feature.";break;case"ALERT_ROTATIONREQUIRESNEWERBROWSER":t="Rotation requires a newer browser version. Please consider upgrading to the current release of your browser.";break;case"ALERT_ZIFREQUIRESNEWERBROWSER":t="Viewing Zoomify Images stored in the ZIF format requires a newer browser version. Please consider upgrading to the current release of your browser.";break;case"ALERT_HOWTOHELPREMINDER":t="\nClick the '?' button for help.";break;case"ALERT_LOADINGANNOTATIONS":t="\nLoading annotations...";break;case"ALERT_HOWTOEDITMESSAGEDURATION":t="5000";break;case"ALERT_HOWTOEDITMESSAGEDURATIONSHORT":t="3000";break;case"ALERT_HOWTOEDITMODEVIEW":t="Click image to zoom-in.\nAlt-click to zoom-out.\nClick-drag to pan.";break;case"ALERT_HOWTOEDITMODEMEASURE":t="Click in image to measure length.\nAdditional clicks measure perimeter.\nRe-click starting point to measure area.";break;case"ALERT_HOTSPOTCLICKURLDISABLED":t="Click links are disabled in edit mode\nto allow hotspot positioning by click-dragging:\n";break;case"ALERT_LOADINGIMAGESET":t=Z.animation?"\nLoading animation images...":"\nLoading slidestack slides...";break;case"ERROR_ERROR":t="error";break;case"ERROR_MESSAGEDURATIONLONG":t="9000";break;case"ERROR_MESSAGEDURATION":t="3000";break;case"ERROR_MESSAGEDURATIONMEDIUM":t="1500";break;case"ERROR_MESSAGEDURATIONSHORT":t="750";break;case"ERROR_UNRECOGNIZEDPARAMETERALERT":t="Parameter unrecognized or deprecated - see the Parameters List documentation: ";break;case"ERROR_PARAMETERDEPRECATED":t="Parameter deprecated - please replace: ";break;case"ERROR_UNSUPPORTEDLOCALVIEWING-BROWSER":t="Recent versions of most browsers allow dynamic content loading (such as viewing of Zoomify Images) only from a web server.  Please change your browser settings (see READ ME FIRST file for details) or use FireFox or an earlier version of your browser for local viewing.";break;case"ERROR_UNSUPPORTEDLOCALVIEWING-FORMAT-ZIF":t="Browsers allow ZIF file viewing only from a web server.  Please use Zoomify Image folders for local viewing.";break;case"ERROR_IMAGEPATHINVALID":t="Image failed to load: possible invalid path, missing image, or network error.";break;case"ERROR_TILEPATHINVALID":t="Sorry!  Part of this view is not refreshing.  The network may be slow, or the website may be missing a file:  ";break;case"ERROR_VALIDATEVIEW":t="Sorry!  Part of this view is not refreshing. The network\nmay be slow, or the website may be missing a file.  ";break;case"ERROR_TILEPATHINVALID-ZIF":t="Sorry!  Part of this view is not refreshing.  The network may be slow, or the ZIF file may be faulty:  ";break;case"ERROR_HOTSPOTORANNOTATIONPATHMISSING":t="Attempt to initiate Edit mode without providing path to hotspots or annotations XML data file.";break;case"ERROR_HOTSPOTPATHINVALID":t="Hotspot media failed to load: possible invalid path, missing file, or legacy hotspot media such as library clip of Flash-based viewer.";break;case"ERROR_HOTSPOTMEDIAINVALID":t="Media of one or more hotspots unsupported: hotspot media of type 'symbol' depend on internal Library of Flash-based viewers.";break;case"ERROR_XMLSAVEHANDLERPATHMISSING":t="Attempt to initiate Edit mode without providing path to Save Handler - server side script or other resource to post XML data.";break;case"ERROR_XMLSAVEHANDLERPATHINVALID":t="Annotations cannot be saved: missing or incorrect save\nhandler path parameter, or missing file on server.";break;case"ERROR_MAKINGNETWORKREQUEST-ZIFBYTERANGE":t="Error loading image: ZIF file data request failed. Request content type: ";break;case"ERROR_MAKINGNETWORKREQUEST-ZIFBYTES":t="Error loading image: ZIF file invalid.";break;case"ERROR_XMLHTTPREQUESTUNSUPPORTED":t="Browser does not support XMLHttpRequest.";break;case"ERROR_MAKINGNETWORKREQUEST-IMAGEXML":t="Error loading image: please make sure image path in web page matches image folder location on webserver.";break;case"ERROR_MAKINGNETWORKREQUEST-TOOLBARSKINSXML":t="Error loading toolbar - skin files not found: please verify that the folders 'Assets/Skins/Default' are in same folder as the web page displaying the Viewer, or add zSkinPath parameter to web page. The zSkinPath parameter may be required if using a content management system such as Drupal, Joomla, or WordPress.";break;case"ERROR_MAKINGNETWORKREQUEST-SLIDESXML":t="Error loading slides: please make sure slide path in web page matches slides folder location on webserver.";break;case"ERROR_MAKINGNETWORKREQUEST-HOTSPOTSXML":t="Error loading hotspots: please make sure hotspot path in web page matches hotspots folder location on webserver.";break;case"ERROR_MAKINGNETWORKREQUEST-CREATINGANNOTATIONSXMLFILE":t="Error finding annotations XML at location provided.\nCreating new file.";break;case"ERROR_MAKINGNETWORKREQUEST-ANNOTATIONSXML":t="Error loading annotations: please make sure annotation XML path in web page matches annotation folder location on webserver.";break;case"ERROR_MAKINGNETWORKREQUEST":t="Error making network request:\npossible invalid path or network error.";break;case"ERROR_NETWORKSECURITY":t="Error related to network security: ";break;case"ERROR_NETWORKSTATUS":t="Error related to network status: ";break;case"ERROR_NETWORKSTATUSRANGEREQUESTS":t="Network error. If using ZIF storage, setting MIME type on web server may be necessary. See READ ME FIRST file in ZIF Storage folder or contact Support: ";break;case"ERROR_CONVERTINGXMLTEXTTODOC":t=" converting XML text to XML doc (DOMParser): ";break;case"ERROR_CONVERTINGXMLDOCTOTEXT":t=" converting XML doc to XML text (DOMParser): ";break;case"ERROR_XMLDOMUNSUPPORTED":t="Browser does not support XML DOM.";break;case"ERROR_XMLDOCINVALID":t="XML Doc invalid.";break;case"ERROR_XMLINVALID":t="XML invalid.";break;case"ERROR_IMAGEXMLINVALID":t="Image XML invalid.";break;case"ERROR_IMAGEPROPERTIESXMLINVALID":t="Image properties XML invalid.";break;case"ERROR_IMAGEPROPERTIESINVALID":t="Image properties invalid.";break;case"ERROR_IMAGEPROPERTIESPARAMETERINVALID":t="Image properties parameter invalid.";break;case"ERROR_IMAGETILECOUNTINVALID":t="Image tile count does not match value in image XML. If the count is invalid display problems can result.";break;case"ERROR_EXECUTINGCALLBACK":t=" while executing callback: ";break;case"ERROR_IMAGEREQUESTTIMEDOUT":t="\nImage tile request not fulfilled within time period expected";break;case"ERROR_UNCONVERTEDIMAGEPATHINVALID":t="Unconverted JPEG or PNG image failed to load: possible invalid path, missing image, or network error.";break;case"ERROR_TRANSLATINGCANVASFORUNCONVERTEDIMAGE":t="\nTranslation of canvas failed";break;case"ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE":t="\nScaling of canvas failed";break;case"ERROR_SETTINGTRANSFORMONCANVASFORUNCONVERTEDIMAGE":t="\nTransform on canvas failed";break;case"ERROR_NAVIGATORIMAGEPATHINVALID":t="Navigator image failed to load: possible invalid path, missing image, or network error.";break;case"ERROR_SKINXMLINVALID":t="Skin XML invalid.";break;case"ERROR_SKINXMLMISSINGNAMES":t="The skin XML file has one or more faulty name lines.";break;case"ERROR_VIRTUALPOINTERPATHINVALID":t="Virtual pointer graphic failed to load: ";break;case"ERROR_WATERMARKPATHINVALID":t="Watermark image failed to load: ";break;case"ERROR_UNKNOWNELEMENTSTYLE":t="Unknown element style - no known method to identify.";break;case"ERROR_UNKNOWNMOUSEPOSITION":t="Unknown mouse position - no known method to calculate.";break;case"ERROR_UNKNOWNMOUSESCROLL":t="Unknown mouse scroll - no known method to calculate.";break;case"ERROR_UNKNOWNWINDOWSIZE":t="Unknown window size - no known method to calculate.";break;case"TIP_LOGO":t="Launch Zoomify Website";break;case"TIP_MINIMIZE":var i="";Z.hotspots?i="\nAlt-Click: Toggle Hotspot Visibility":Z.annotations&&(i="\nAlt-Click: Toggle Label Visibility"),t="Minimize Toolbar"+i;break;case"TIP_EXPAND":var i="";Z.hotspots?i="\nAlt-Click: Toggle Hotspot Visibility":Z.annotations&&(i="\nAlt-Click: Toggle Label Visibility"),t="Expand Toolbar"+i;break;case"TIP_ZOOMOUT":t="Zoom Out";break;case"TIP_SLIDER":t="Zoom In And Out";break;case"TIP_ZOOMIN":t="Zoom In";break;case"TIP_PANLEFT":t="Pan Left";break;case"TIP_PANUP":t="Pan Up";break;case"TIP_PANDOWN":t="Pan Down";break;case"TIP_PANRIGHT":t="Pan Right";break;case"TIP_RESET":t="Reset Initial View\nAlt-Click: Prior View";break;case"TIP_TOGGLEFULLVIEW":t="Enter Full View";break;case"TIP_TOGGLEFULLVIEWEXIT":t="Exit Full View";break;case"TIP_TOGGLEFULLVIEWEXITEXTERNAL":t="Exit Full View";break;case"TIP_HELP":t="Show Help";break;case"TIP_HELPMARKUP":t="Show Markup Help";break;case"TIP_HELPANNOTATION":t="Show Annotation Help";break;case"TIP_ROTATECLOCKWISE":t="Rotate Clockwise 90 Degrees";break;case"TIP_ROTATECOUNTERWISE":t="Rotate Counterwise 90 Degrees";break;case"TIP_VIRTUALPOINTER":t="Click-Drag To Position";break;case"TIP_TOGGLEMEASURING":t="Begin Measuring";break;case"TIP_TOGGLEMEASURINGEXIT":t="Stop Measuring";break;case"TIP_TOURPRIOR":t="Prior Destination";break;case"TIP_TOURNEXT":t="Next Destination";break;case"TIP_TOURSTART":t="Start Tour";break;case"TIP_TOURSTOP":t="Stop Tour";break;case"TIP_SLIDEPRIOR":t="Prior Slide";break;case"TIP_SLIDENEXT":t="Next Slide";break;case"TIP_SLIDESHOWSTART":t="Start Slideshow";break;case"TIP_SLIDESHOWSTOP":t="Stop Slideshow";break;case"TIP_AUDIOMUTE":t="Mute Sound";break;case"TIP_AUDIOON":t="Enable Sound";break;case"TIP_IMAGESETPRIOR":t=Z.animation?"Prior Image":"Prior Slide";break;case"TIP_IMAGESETSLIDER":t=Z.animation?"Change Image":"Change Slide";break;case"TIP_IMAGESETNEXT":t=Z.animation?"Next Image":"Next Slide";break;case"TIP_VIEWMODE":t="Image Navigation";break;case"TIP_EDITMODECOLORPICKER":t="Toggle Color Palette";break;case"TIP_EDITMODEMEASURE":t="Measurements";break;case"TIP_HELPOK":t="Close Help Display";break;case"TIP_MESSAGEOK":t="Accept And Close Message";break;case"TIP_MESSAGECANCEL":t="Decline And Close Message";break;case"TIP_COPYRIGHTAGREE":t="Agree To Copyright And View Images";break;case"TIP_COPYRIGHTEXIT":t="Exit And Do Not View Images";break;case"TIP_SHOWGLOBALS":t="Toggle Full Page View";break;case"TIP_TOGGLEDISPLAY":t="Toggle Viewport Display";break;case"TIP_TOGGLEBACKFILL":t="Toggle Viewport Backfill";break;case"TIP_TOGGLECONSTRAINPAN":t="Toggle Constrain Pan";break;case"UI_LOGOLINKDISPLAY":t="www.zoomify.com";break;case"UI_LOGOLINK":t="http://www.zoomify.com";break;case"UI_LOGOLINKTARGET":t="_blank";break;case"UI_NAVIGATORACCESSIBILITYALTATTRIBUTE":t="Navigator Bird's Eye View";break;case"UI_FVCANCELBUTTONTEXT":t="X";break;case"UI_RULERMIN":t=" min";break;case"UI_RULERMAX":t=" max";break;case"UI_RULERNOPARAMS":t="units in %s";break;case"UI_MEASURELENGTH":t="Length: ";break;case"UI_MEASURELENGTHTOTAL":t="Total length: ";break;case"UI_MEASUREPERIMETER":t="Perimeter: ";break;case"UI_MEASUREAREA":t="Area: ";break;case"UI_MEASURESQUARE":t="";break;case"UI_COPYRIGHTAGREEBUTTONTEXT":t="Agree";break;case"UI_COPYRIGHTEXITBUTTONTEXT":t="Exit";break;case"UI_LISTMOUSEDOWNTEXT":t="Select an item...";break;case"UI_TOURLISTTITLE":t="Tour Destinations";break;case"UI_SLIDELISTTITLE":t="Slides";break;case"UI_HOTSPOTLISTTITLE":t="Hotspots";break;case"UI_IMAGESETLISTTITLE":t="ImageSet Slide List";break;case"UI_IMAGESETSTART":t="0";break;case"UI_IMAGESETLOOP":t="1";break;case"UI_IMAGESETSLIDER":t="1";break;case"UI_HELPDISPLAYWIDTH":t="430";break;case"UI_HELPDISPLAYHEIGHT":t="300";break;case"UI_HELPOKBUTTONTEXT":t="OK";break;case"UI_MESSAGEDISPLAYWIDTH":t="430";break;case"UI_MESSAGEDISPLAYHEIGHT":t="84";break;case"UI_MESSAGECANCELBUTTONTEXT":t="Cancel";break;case"UI_MESSAGEOKBUTTONTEXT":t="OK";break;case"UI_COORDINATESDISPLAYWIDTH":t="290";break;case"UI_COORDINATESDISPLAYHEIGHT":t="200";break;case"UI_COORDINATESDISPLAYTEXT":t="Mouse Coordinates\nAlt-click, select in list, right-click, Copy";break;case"UI_TRACEDISPLAYTITLE":t="Trace Values\n\n";break;case"UI_TRACEDISPLAYDEBUGINFOTEXT":t="This panel is enabled using the HTML parameter 'zDebug=1' (basic) or 'zDebug=2' (adds tile tracing). It can be called in JavaScript as follows:\n\n   Z.Utils.trace('value to display');  \n\nThe buttons below display or modify important state values.  Web designers new to JavaScript will also benefit from the console, trace, profiling, and other debugging features of leading browsers.";break;case"UI_TRACEDISPLAYTILESTATUSTEXT":t="Required Cached Requested Loaded Displayed Waiting";break;case"UI_TRACEDISPLAYELAPSEDTIMETEXT":t="Seconds";break;case"UI_TRACEDISPLAYTILESPERSECONDTEXT":t="Loads / Second";
break;case"UI_TRACEDISPLAYSHOWGLOBALSBUTTONTEXT":t="Show Globals";break;case"UI_TRACEDISPLAYTOGGLEDISPLAYBUTTONTEXT":t="Toggle Display";break;case"UI_TRACEDISPLAYTOGGLEBACKFILLBUTTONTEXT":t="Toggle Backfill";break;case"UI_TRACEDISPLAYTOGGLECONSTRAINPANBUTTONTEXT":t="Toggle Constrain Pan";break;case"CONTENT_HELPTOOLBAR":t="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Viewer Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>To explore this image, simply click the image to zoom, double-click to zoom out, or click-drag to pan.<br><br>The Navigator thumbnail overview can also be clicked or click-dragged to pan.<br><br>Use the Toolbar for exact navigation - if using a mouse, hold it over any button to see a helpful tip.</font></p>";break;case"CONTENT_HELPMARKUP":t="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Markup Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>Markup Mode allows fast, easy addition of labels to a zoomable image.<br><br><strong>Creating A Label</strong><br><br>Click any of the buttons at the top of the Markup Panel: Freehand, Text, Rectangle, Polygon, or Measure.<br><br>Next, click or click-drag in the image:<ul><li>Freehand drawings are created by click-dragging.<li>Text labels are created with a simple click in the image.<li>Icons first require the type of icon to be chosen from the icon list. Then the icon is created by clicking the image.<li>Rectangles do not require multiple clicks - just click-drag and all four corners are automatically created and positioned.<li>Polygons require multiple clicks in the image to create corner <i>control points</i>.  Alt-click the image to create a final point, or click the first point to close the polygon.<li>Measurements are just like polygons but the caption dynamically changes to display the current length or area.<li>Control points of rectangles, polygons, and measurments can be click-dragged to modify a polygon.</ul>Use the Color button to set a color. The color selected affects freehand drawings, text captions, icon captions, and the lines and captions of rectangles, polygons, and measurements.<br><br>Use the View button to return to navigation mode.<br><br><strong>Editing Label Values</strong><br><br>The Markup Panel also displays the name and caption of the currently selected label for easy editing. Use the TAB key to implement any edits or click in the image.<br><br>Delete a label using the trash can button. The label will be removed from the image and the Markup Panel will display the prior label in the label list.<br><br>Save a label using the button with the disk icon. Or, use the label list to change the selected label - the previously selected label will be automatically saved.<br><br><i><strong>Special Tips:</strong><ul><li>Alt-click any label to display its name and caption in the Markup Panel for editing.<li>Alt-click-drag any completed label to reposition it in the image.<li>If using a mouse, hold the cursor over any button at any time to see a helpful reminder.</ul></i></font></p>";break;case"CONTENT_HELPANNOTATIONEDITING":t="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Annotation Editing Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>The Annotation Panel provides an intuitive, visual means, to add <i>Points of Interest</i> to a zoomable image, including the option of associated <i>Labels</i> and <i>Notes</i>.<br><br><strong>Point Of Interests</strong><br><br>A Point Of Interest (POI) is a place in the image that is named and listed so that it can be navigated to easily.<br><br>To create a Point Of Interest, click the <i>Add</i> button beneath the Point Of Interest choice list at the top of the Annotation Panel to create a new Point of Interest. Or, click the <i>Edit</i> button to modify the current POI. If no Annotations have been created, a placeholder POI will be the only item in the Point Of Interest list.<br><br><i><strong>More Buttons:</strong></i><br><br>When the Add button is clicked, two different buttons will be displayed: <i>Save</i> and <i>Cancel</i>. If the Edit button is clicked, a third button will also be displayed: <i>Delete</i>.<br><br>Save a Point Of Interest using the button with the disk icon. Cancel edits to a Point Of Interest using the button with the large X icon.<br><br>Delete a Point Of Interest using the trash can button. The POI will be removed from the list and the prior POI in the list will be displayed.<br><br><i><strong>Important:</strong><ul><li>Changing the selected POI in the POI list will automatically save any edits to the current POI.<li>Clicking any of the buttons Save, Cancel, and Delete will leave the Add or Edit mode and return to Annotation Panel to its default display.<li>If using a mouse, hold the cursor over any button to see a helpful reminder.</ul></i><strong>Labels</strong><br><br>To add a new Label to the current Point Of Interest, click the Add button beneath the Label section of the Annotation Panel. Or, click the Edit button to edit the current Label. If no Labels have been created yet, the Label list will be empty.<br><br>If adding a new Label, click any of the buttons at the top of the Label section of the Annotation Panel: Freehand, Text, Rectangle, Polygon, or Measure.<br><br>Now click or click-drag in the image to create a new Label:<ul><li>Freehand drawings are created by click-dragging.<li>Text labels are created with a simple click in the image.<li>Icons first require the type of icon to be chosen from the icon list. Then the icon is created by clicking the image.<li>Rectangles do not require multiple clicks - just click-drag and all four corners are automatically created and repositioned.<li>Polygons require multiple clicks in the image to create corner <i>control points</i>.  Alt-click the image to create a final point, or click the first point to close the polygon.<li>Measurements are just like polygons except that the caption dynamically changes to display the current length or area.</ul>Use the Color button to set the color of new freehand drawings, text captions, icon captions, and the lines and captions of rectangles, polygons, and measurements.<br><br>Use the View button to return to navigation mode in the current Label.<br><br><i><strong>Important:</strong><ul><li>In Add mode, multiple clicks or click-drags will create multiple Labels - to support rapid annotation authoring.<li>In Edit mode, any clicks or click-drags will simple replace the current Label in the image.<li>Alt-click any label in the image to display its values in the Annotatoin Panel for editing. (Add or Edit mode)<li>Alt-click-drag any completed label in the image to reposition it.  (Add or Edit mode)<li>Control points of rectangles, polygons, and measurments can be click-dragged to modify a polygon.</ul></i><i><strong>More Label Values:</strong></i><br><br>The Annotation Panel also displays the name, caption, tooltip, and click-URL of of the currently selected label for easy editing. Use the TAB key to implement any edits or click in another text field or in the image. <br><br>Two choice lists are also included: the first allows the caption to be positioned relative to the Label in the image while the second determines whether the click-URL (if any) will open in the current browser window or a new browser window or a specific frame in the web page. <br><br>The Scale buttons allow the Label to be sized in the image.  The Rollover checkbox can be used to hide a Label in the image until the cursor is over it (not supported by mobile devices).<br><br>The Save, Cancel, and Delete buttons for Labels work just as they do with Points of Interest, as described above. And remember, changing the selected Label in the Label list will automatically save any edits to the current Label. Alt-clicking or alt-click-dragging a Label in the image will also change the current Label in the Label list and cause any edits to be saved (see the first two Special Tips below).<br><br><i><strong>Important:</strong><ul><li>Changing the selected Label by clicking or click-dragging it in the image will change the selected Point Of Interest if the newly selected Label is associated with a different POI - if editing is in progress the edits will be automatically saved.<li>If using a mouse, hold the cursor over any button to see a helpful reminder.</ul></i><strong>Notes</strong><br><br>To add a new Note to the current Point Of Interest, click the Add button beneath the Note section of the Annotation Panel. Or, click the Edit button to edit the current Note. If no Notes have been created yet, the Note list will be empty.<br><br>Use the name and text fields to easily add or edit the Note values. Notes can hold a virtually unlimited number of characters (spaces included). A vertical scrollbar automatically appears when a note requires more lines than fit in the note area. Notes can contain carriage returns.<br><br>The Save, Cancel, and Delete buttons for Notes work just as they do with Points of Interest, as described above. And remember, changing the selected Note in the Note list will automatically save any edits to the current Note.</font></p>";break;case"CONTENT_HELPCONCATENATOR":t="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>\\/ \\/ \\/</strong></font></p>";break;case"CONTENT_HELPANNOTATIONVIEWING":t="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Annotation Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>The Annotation Panel provides an intuitive display of <i>Points of Interest</i> in a zoomable image, along with associated <i>Labels</i> and <i>Notes</i>, if any.<br><br>A Point Of Interest (POI) is a place in the image that is named and listed so that it can be navigated to easily.<br><br>A Label is a visual element in the image: a freehand drawing, text caption, rectangle or other polygon, or a measurement.<br><br>A Note is text associated with a Point Of Interest. Notes can hold a virtually unlimited number of characters (spaces included). A vertical scrollbar automatically appears when a note requires more lines than fit in the note area.</font></p>";break;case"CONTENT_SKIPUSERNAMENAME":t="Anonymous";break;case"CONTENT_FIRSTPOINAME":t="Whole Image";break;case"CONTENT_POINAME":t="New Point Of Interest ";break;case"CONTENT_POIUSER":t=this.getResource("CONTENT_SKIPUSERNAMENAME");break;case"CONTENT_HOTSPOTNAME":t="New Hotspot ";break;case"CONTENT_HOTSPOTCAPTION":t="Caption for hotspot ";break;case"CONTENT_LABELNAME":t="New Label ";break;case"CONTENT_LABELCAPTION":t="Caption for label ";break;case"CONTENT_LABELCOMMENT":t="Comment for label ";break;case"CONTENT_ANNOTATIONPLACEHOLDERCOMMENTTEXT":t="";break;case"CONTENT_POLYGONCAPTION":t="Polygon ";break;case"CONTENT_LABELTOOLTIP":t="Tooltip for label ";break;case"CONTENT_LABELCLICKURL":t="";break;case"CONTENT_LABELUSER":t=this.getResource("CONTENT_SKIPUSERNAMENAME");break;case"CONTENT_CAPTIONTEXTCOLOR":t=Z.captionTextColor?Z.captionTextColor:"#FFFFFF";break;case"CONTENT_CAPTIONBACKCOLOR":t=Z.captionBackColor?Z.captionBackColor:"#000000";break;case"CONTENT_POLYGONLINECOLOR":t=Z.polygonLineColor?Z.polygonLineColor:"#FFFFFF";break;case"CONTENT_POLYGONFILLCOLOR":t=Z.polygonFillColor?Z.polygonFillColor:"#FFFFFF";break;case"CONTENT_CAPTIONTEXTVISIBLE":t=Z.captionTextVisible?"1":"0";break;case"CONTENT_CAPTIONBACKVISIBLE":t=Z.captionBackVisible?"1":"0";break;case"CONTENT_POLYGONLINEVISIBLE":t=Z.polygonLineVisible?"1":"0";break;case"CONTENT_POLYGONFILLVISIBLE":t=Z.polygonFillVisible?"1":"0";break;case"CONTENT_CAPTIONPOSITION":t="8";break;default:t="Unexpected resource request"}return t},clearDisplay:function(e){if(e)if(Z.useCanvas&&"CANVAS"==e.tagName)Z.Utils.clearCanvas(e);else for(;e.hasChildNodes();)e.removeChild(e.lastChild)},clearCanvas:function(e){var t=e.getContext("2d");t.save();try{t.setTransform(1,0,0,1,0,0)}catch(i){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SETTINGTRANSFORMONCANVASFORUNCONVERTEDIMAGE")),console.log("In function clearCanvas setting transform on canvas:  "+i)}t.clearRect(0,0,t.canvas.width,t.canvas.height),t.restore()},colorCanvas:function(e,t){var i=e.getContext("2d");i.save(),i.setTransform(1,0,0,1,0,0),i.fillStyle=t,i.fillRect(0,0,i.canvas.width,i.canvas.height),i.restore()},deleteDiv:function(e){for(var t=document.getElementById(e);t.hasChildNodes();)t.removeChild(t.lastChild);t.parentNode.removeChild(t)},createCallback:function(e,t){for(var i=[],a=2,n=arguments.length;n>a;a++)i[i.length]=arguments[a];return function(){for(var a=i.concat([]),n=0,l=arguments.length;l>n;n++)a[a.length]=arguments[n];return t.apply(e,a)}},validateCallback:function(e){var t=Z.callbacks.slice(0);Z.Utils.functionCallWithDelay(function(){Z.Utils.validateCallbackDelayed(e,t)},10)},validateCallbackDelayed:function(e,t){for(var i=0,a=t.length;a>i;i++){var n=t[i];if(n&&n.callbackEvent==e&&"object"==typeof n&&"function"==typeof n.callbackFunction)switch(e){case"viewZoomingGetCurrentZoom":var l=Z.Viewport.getZoom();n.callbackFunction(l);break;case"viewUpdateCompleteGetLabelIDs":var o=Z.Viewport.getLabelIDsInCurrentView(!1,!0,!0);n.callbackFunction(o);break;case"viewUpdateCompleteGetLabelInternalIDs":var r=Z.Viewport.getLabelIDsInCurrentView(!0,!0,!0);n.callbackFunction(r);break;default:n.callbackFunction()}}Z.Utils.arrayClear(t)},getContainerSize:function(e,t){var i=Z.Utils.getElementStyle(e),a=parseFloat(i.width),n=parseFloat(i.height);return Z.Utils.stringValidate(i.width)&&-1!=i.width.indexOf("%")&&(a=parseFloat(Z.Utils.getElementStyleProperty(e,"width"))),Z.Utils.stringValidate(i.height)&&-1!=i.height.indexOf("%")&&(n=parseFloat(Z.Utils.getElementStyleProperty(e,"height"))),isNaN(a)&&(a=t.clientWidth),isNaN(n)&&(n=t.clientHeight),(0==a||0==n)&&(winDimensions=Z.Utils.getWindowSize(),0==a&&(e.parentNode.style.width=winDimensions.x+"px",a=e.clientWidth),0==n&&(e.parentNode.style.height=winDimensions.y+"px",n=e.clientHeight)),new Z.Utils.Point(a,n)},createContainerElement:function(e,t,i,a,n,l,o,r,s,u,d,p,c,g,m,h,f){var T=document.createElement(e);this.stringValidate(t)&&(T.id=t);var b=T.style;return b.display=this.stringValidate(i)?i:"inline-block",b.position=this.stringValidate(a)?a:"static",b.overflow=this.stringValidate(n)?n:"hidden","canvas"==e?(this.stringValidate(l)&&T.setAttribute("width",l),this.stringValidate(o)&&T.setAttribute("height",o)):(this.stringValidate(l)&&(b.width=l),this.stringValidate(o)&&(b.height=o)),this.stringValidate(r)&&(b.left=r),this.stringValidate(s)&&(b.top=s),b.borderStyle=this.stringValidate(u)?u:"none",b.borderWidth=this.stringValidate(d)?d:"0px",b.borderColor="#696969",b.background=this.stringValidate(p)?p:"transparent none",b.margin=this.stringValidate(c)?c:"0px",b.padding=this.stringValidate(g)?g:"0px",b.whiteSpace=this.stringValidate(m)?m:"normal",this.stringValidate(h)&&(b.cursor=h),"undefined"!==f&&f&&(Z.Utils.addEventListener(T,"touchstart",Z.Utils.preventDefault),Z.Utils.addEventListener(T,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(T,"contextmenu",Z.Utils.preventDefault)),T},createCenteredElement:function(e,t){var i=this.createContainerElement("div"),a=[];a[a.length]='<div style="#position:relative; display:table; height:100%; width:100%; border:none; margin:0px; padding:0px; overflow:hidden; text-align:left;">',a[a.length]='<div style="#position:absolute; display:table-cell; #top:50%; width:100%; border:none; margin:0px; padding:0px; vertical-align:middle;">',a[a.length]='<div id="'+t+'"; style="#position:relative; width:100%; #top:-50%; border:none; margin:0px; padding:0px; text-align:center;"></div></div></div>',i.innerHTML=a.join(""),i=i.firstChild;for(var n=i,l=i.getElementsByTagName("div");l.length>0;)n=l[0],l=n.getElementsByTagName("div");return n.appendChild(e),i},createTextElement:function(e,t,i,a,n,l,o,r,s,u,d,p,c,g,m,h,f,T){var b=Z.Utils.createContainerElement("div","textBoxFor-"+e,"inline-block","absolute","hidden",i,a,n,l,r,s,"white","0px",o,"normal"),E=document.createElement("textarea");b.appendChild(E);var v=E,I=v.style;return v.id=e,v.value=t,v.readOnly=u,I.width="100%",I.height="100%",I.margin="0",I.border="0",this.stringValidate(d)&&(I.fontFamily=d),this.stringValidate(p)&&(I.fontSize=p),this.stringValidate(c)&&(I.resize=c),this.stringValidate(g)&&(v.columns=g),this.stringValidate(m)&&(v.rows=m),this.stringValidate(h)&&(I.overflowX=h),this.stringValidate(f)&&(I.overflowY=f),this.stringValidate(T)&&(v.wrap=T,"off"==T&&(I.whiteSpace="nowrap")),b},createSelectElement:function(e,t,i,a,n,l,o,r,s,u){var d=document.createElement("select");d.id=e,Z.Utils.stringValidate(t)&&"none"!=t&&(d.options[0]=new Option(t,null));for(var p=0,c=i.length;c>p;p++)d.options[d.options.length]=new Option(i[p].text,i[p].value);var g="undefined"!=typeof u&&null!==u?u:"change";Z.Utils.addEventListener(d,g,s);var m=d.style;return m.width=a+"px",m.position="absolute",m.left=n+"px",m.top=l+"px",m.fontSize=null==o?"11px":o+"px",m.fontFamily="verdana",m.visibility=r,d},updateSelectElement:function(e,t,i){if(e){var a=-1!=e.selectedIndex?e.selectedIndex:0;e.innerHTML="";for(var n=0,l=t.length;l>n;n++)e.options[e.options.length]=new Option(t[n].text,t[n].value.toString());if("undefined"!=typeof i&&null!==i){var o=parseInt(Z.Utils.arrayIndexOfObjectValue(t,"value",i),10);-1!=o&&(a=o)}var r=e.options.length-1;e.selectedIndex=r>=a?a:r}},getChildElementByID:function(e,t){for(var i=null,a=0,n=e.childNodes.length;n>a;a++){var l=e.childNodes[a];if(l.id==t)return i=l;if(i=Z.Utils.getChildElementByID(l,t),null!==i)return i}return i},getElementPosition:function(e){for(var t=0,i=0,a="fixed"==this.getElementStyle(e).position,n=this.getOffsetParent(e,a);n;){if(t+=e.offsetLeft,i+=e.offsetTop,a){var l=this.getPageScroll();t+=l.x,i+=l.y}e=n,a="fixed"==this.getElementStyle(e).position,n=this.getOffsetParent(e,a)}return new this.Point(t,i)},getOffsetParent:function(e,t){return t&&e!=document.body?document.body:e.offsetParent},getElementSize:function(e){return new this.Point(e.clientWidth,e.clientHeight)},getElementStyle:function(e){return e.currentStyle?e.currentStyle:window.getComputedStyle?window.getComputedStyle(e,""):void this.showMessage(this.getResource("ERROR_UNKNOWNELEMENTSTYLE"))},getElementStyleProperty:function(e,t){return window.getComputedStyle?window.getComputedStyle(e,null).getPropertyValue(t):e.currentStyle?e.currentStyle[t]:void this.showMessage(this.getResource("ERROR_UNKNOWNELEMENTSTYLE"))},isElementFluid:function(e){var t,i,a,n,l,o=e.cloneNode(!1),r=!1,s=!1;return window.getComputedStyle?value=window.getComputedStyle(o,null).width:o.currentStyle&&(value=o.currentStyle.width),"undefined"!=typeof value&&null!==value&&""!==value?r=-1!=value.toString().indexOf("%")||"auto"==value:(o.style.margin="0",o.style.padding="0",o.style.maxWidth="none",o.style.minWidth="none",t=document.createElement("testContainer"),t.style.display="block",t.style.width="800px",t.style.padding="0",t.style.margin="0",t.appendChild(o),e.parentNode.insertBefore(t,e),i=o.offsetWidth,t.style.width="900px",o.offsetWidth==i?(e.parentNode.removeChild(t),r=!1):(n=Math.floor(.125*i),l=Math.floor(100/900*o.offsetWidth),e.parentNode.removeChild(t),r=n==l?!0:!1)),0==s&&(window.getComputedStyle?value=window.getComputedStyle(o,null).height:o.currentStyle&&(value=o.currentStyle.height),"undefined"!=typeof value&&null!==value&&""!=value?s=-1!=value.toString().indexOf("%")||"auto"==value:(o.style.margin="0",o.style.padding="0",o.style.maxHeight="none",o.style.minHeight="none",t=document.createElement("testContainer"),t.style.display="block",t.style.height="800px",t.style.padding="0",t.style.margin="0",t.appendChild(o),e.parentNode.insertBefore(t,e),a=o.offsetHeight,t.style.height="900px",o.offsetHeight==a?(e.parentNode.removeChild(t),s=!1):(n=Math.floor(.125*a),l=Math.floor(100/900*o.offsetHeight),e.parentNode.removeChild(t),s=n==l?!0:!1))),r||s},getEventTargetCoords:function(e){return getElementPosition(Z.Utils.target(e))},getFirstTouch:function(e){var t=null,i=e.touches,a=e.changedTouches;return"undefined"!=typeof i?t=i[0]:"undefined"!=typeof a&&(t=a[0]),t},getMousePosition:function(e){var t=0,i=0;return"DOMMouseScroll"==e.type&&Z.browser==Z.browsers.FIREFOX&&Z.browserVersion<3?(t=e.screenX,i=e.screenY):"number"==typeof e.pageX?(t=e.pageX,i=e.pageY):"number"==typeof e.clientX?(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=e.clientY+document.body.scrollTop+document.documentElement.scrollTop):this.showMessage(this.getResource("ERROR_UNKNOWNMOUSEPOSITION")),new this.Point(t,i)},getMouseScroll:function(e){var t=0;return"number"==typeof e.wheelDelta?t=e.wheelDelta:"number"==typeof e.detail?t=-1*e.detail:this.showMessage(this.getResource("ERROR_UNKNOWNMOUSESCROLL")),t?t/Math.abs(t):0},getPageScroll:function(){var e=0,t=0,i=document.documentElement||{},a=document.body||{};return"number"==typeof window.pageXOffset?(e=window.pageXOffset,t=window.pageYOffset):a.scrollLeft||a.scrollTop?(e=a.scrollLeft,t=a.scrollTop):(i.scrollLeft||i.scrollTop)&&(e=i.scrollLeft,t=i.scrollTop),new this.Point(e,t)},getScreenSize:function(){var e=screen.width,t=screen.height;return new this.Point(e,t)},getWindowSize:function(){var e=0,t=0,i=document.documentElement||{},a=document.body||{};return"number"==typeof window.innerWidth?(e=window.innerWidth,t=window.innerHeight):i.clientWidth||i.clientHeight?(e=i.clientWidth,t=i.clientHeight):a.clientWidth||a.clientHeight?(e=a.clientWidth,t=a.clientHeight):this.showMessage(this.getResource("ERROR_UNKNOWNWINDOWSIZE")),new this.Point(e,t)},Button:function(e,t,i,a,n,l,o,r,s,u,d,p,c,g,m,h,f,T,b,E){var v=Z.Utils.createContainerElement("span",e,"inline-block","absolute","hidden",o,r,s,u,g,m,h,f,T,b,E);if(Z.Utils.stringValidate(t)){var I=document.createTextNode(t);v.appendChild(Z.Utils.createCenteredElement(I)),Z.Utils.setTextNodeStyle(I,"black","verdana","13px","none","normal","normal","normal","normal","1em","center","none")}else{i=Z.Utils.stringRemoveTrailingSlashCharacters(i);var y=Z.Utils.createGraphicElement(i+"/"+a),U=Z.Utils.createGraphicElement(i+"/"+n),S=Z.Utils.createGraphicElement(i+"/"+l);y.style.width=U.style.width=S.style.width=o,y.style.height=U.style.height=S.style.height=r,y.style.position=U.style.position=S.style.position="absolute",Z.browser==Z.browsers.FIREFOX&&Z.browserVersion<3&&(y.style.top=U.style.top=S.style.top=""),U.style.visibility=S.style.visibility="hidden",y.alt=U.alt=S.alt="","undefined"!=typeof c&&Z.Utils.stringValidate(c)&&(y.alt=Z.Utils.getResource(c)),v.appendChild(y),v.appendChild(U),v.appendChild(S)}Z.Utils.addEventListener(v,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(v,"mouseover",Z.Utils.stopPropagation),Z.Utils.addEventListener(v,"mousedown",Z.Utils.stopPropagation),Z.Utils.addEventListener(v,"mouseup",Z.Utils.stopPropagation),Z.Utils.addEventListener(v,"mouseout",Z.Utils.stopPropagation),"undefined"!=typeof imageUp&&(Z.Utils.addEventListener(y,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(U,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(S,"contextmenu",Z.Utils.preventDefault)),Z.Utils.addEventListener(v,"touchstart",Z.Utils.preventDefault),Z.Utils.addEventListener(v,"touchend",Z.Utils.preventDefault),Z.Utils.addEventListener(v,"touchcancel",Z.Utils.preventDefault),Z.Utils.stringValidate(t)||(Z.Utils.disableTextInteraction(I),Z.Utils.addEventListener(v,"contextmenu",Z.Utils.preventDefault)),Z.tooltipsVisible&&Z.Utils.stringValidate(c)&&(v.title=Z.Utils.getResource(c)),Z.Utils.setButtonHandler(v,d,p),this.elmt=v},buttonSize:function(e,t,i){var a=e.style;a.width=t+"px",a.height=i+"px";var n=e.firstChild,l=e.childNodes[1],o=e.childNodes[2];n&&l&&o&&(n.style.width=l.style.width=o.style.width=t+"px",n.style.height=l.style.height=o.style.height=t+"px")},setButtonDefaults:function(e){Z.Utils.clearButtonSettings(e),Z.Utils.setButtonState(e,"up"),Z.Utils.setButtonHandler(e,"mouseover",Z.Toolbar.buttonEventsHandler)},clearButtonSettings:function(e){var t=e.firstChild,i=e.childNodes[1],a=e.childNodes[2];t&&i&&a&&(t.style.visibility=i.style.visibility=a.style.visibility="hidden",Z.Utils.removeEventListener(t,"mouseover",Z.Toolbar.buttonEventsHandler),Z.Utils.removeEventListener(i,"mousedown",Z.Toolbar.buttonEventsHandler),Z.Utils.removeEventListener(i,"mouseout",Z.Toolbar.buttonEventsHandler),Z.Utils.removeEventListener(a,"mouseup",Z.Toolbar.buttonEventsHandler),Z.Utils.removeEventListener(e,"touchstart",Z.Toolbar.buttonEventsHandler),Z.Utils.removeEventListener(e,"touchend",Z.Toolbar.buttonEventsHandler),Z.Utils.removeEventListener(e,"touchcancel",Z.Toolbar.buttonEventsHandler)),Z.Utils.removeEventListener(e,"mouseover",Z.Toolbar.buttonEventsHandler),Z.Utils.removeEventListener(e,"mousedown",Z.Toolbar.buttonEventsHandler),Z.Utils.removeEventListener(e,"mouseout",Z.Toolbar.buttonEventsHandler),Z.Utils.removeEventListener(e,"mouseup",Z.Toolbar.buttonEventsHandler)},setButtonState:function(e,t){var i="up"==t?e.firstChild:"down"==t?e.childNodes[1]:e.childNodes[2];i&&(i.style.visibility="visible")},setButtonHandler:function(e,t,i){var a="undefined"!==i?i:Z.Toolbar.buttonEventsHandler,n="undefined"!==t?t:"mouseover",l="mousedown"==t?"touchstart":"touchend",e=e;"mouseover"==t&&"undefined"!=typeof e.firstChild?e=e.firstChild:"mousedown"==t&&"undefined"!=typeof e.childNodes[1]||("mouseup"==t&&"undefined"!=typeof e.childNodes[2]?e=e.childNodes[2]:"mouseout"==t&&"undefined"!=typeof e.childNodes[1]&&(e=e.childNodes[1])),Z.Utils.addEventListener(e,l,a),Z.Utils.addEventListener(e,n,a)},Checkbox:function(e,t,i,a,n,l,o,r,s){var u=Z.Utils.createContainerElement("div","containerFor-"+e,"inline-block","absolute","hidden",i,a,n,l,"none","0px","transparent none","0px","0px","normal"),d=document.createElement("input");u.appendChild(d),d.type="checkbox",d.id=e,d.value=t,d.width=i,d.height=a;var p=u.style;return p.width=i+"px",p.height=a+"px",p.left=n+"px",p.top=l+"px",Z.Utils.addEventListener(d,o,r),Z.Utils.addEventListener(d,"touchstart",r),Z.tooltipsVisible&&Z.Utils.stringValidate(s)&&(d.title=Z.Utils.getResource(s)),u},Graphic:function(e,t,i,a,n,l,o,r){t=Z.Utils.stringRemoveTrailingSlashCharacters(t);var s=i?t+"/"+i:t,u=Z.Utils.createGraphicElement(s),d=u.style;d.width=a,d.height=n,u.alt="undefined"!=typeof r&&Z.Utils.stringValidate(r)?Z.Utils.getResource(r):"";var i=Z.Utils.createContainerElement("span",e,"inline-block","absolute","hidden",a,n,l,o,"none","0px","transparent none","0px","0px","normal");i.appendChild(u),this.elmt=i,Z.Utils.addEventListener(u,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(u,"touchstart",Z.Utils.preventDefault),Z.Utils.addEventListener(u,"contextmenu",Z.Utils.preventDefault)},createGraphicElement:function(e){var t=this.createContainerElement("img"),i=null;return Z.browser==Z.browsers.IE&&Z.browserVersion<7?(i=this.createContainerElement("span",null,"inline-block"),t.onload=function(){i.style.width=i.style.width||t.width+"px",i.style.height=i.style.height||t.height+"px",t.onload=null,t=null},i.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+e+'", sizingMethod="scale")'):(i=t,i.src=e),i},graphicSize:function(e,t,i){var a=e.style;a.width=t+"px",a.height=i+"px";var n=e.firstChild,l=n.style;l.width=t+"px",l.height=i+"px"},Point:function(e,t){this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0},Point3D:function(e,t,i){this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0,this.z="number"==typeof i?i:0},Trio:function(e,t,i){this.a=e,this.b=t,this.c=i},Range:function(e,t){this.start="number"==typeof e?e:0,this.end="number"==typeof t?t:0},swapZIndices:function(e,t){var i=Z.Utils.getElementStyleProperty(e,"z-index"),a=Z.Utils.getElementStyleProperty(t,"z-index");e.style.zIndex=a,t.style.zIndex=i},stringValidate:function(e){return"undefined"!=typeof e&&null!==e&&""!==e&&"null"!==e},stringReadable:function(e){var t,i,a,n;return t="%20",i=new RegExp(t,"g"),a=" ",n=e.replace(i,a)},stringLowerCaseFirstLetter:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},stringUpperCaseFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},stringMultiply:function(e,t){var i=Math.ceil(Math.log(t)/Math.LN2),a=e;do a+=a;while(0<--i);return a.slice(0,e.length*t)},stringRemoveTrailingSlashCharacters:function(e){var t="/"==e.slice(-1,e.length)?e.slice(0,e.length-1):e;return t},stringRemoveTabAndLineWrapCharacters:function(e){var t=e.replace(/\n/g,"");return t=t.replace(/\r/g,""),t=t.replace(/\t/g,"")},stringUnescapeAmpersandCharacters:function(e){var t=e.replace(/\n/g,"");return t=t.replace(/&#38;/g,"&"),t=t.replace(/&#038;/g,"&"),t=t.replace(/&/g,"&")},setHTMLTextDefaultCaptionStyle:function(e,t,i,a,n,l,o,r,s,u,d,p,c){var Z=e.style;-1==t.indexOf("color=")&&(Z.color=i),-1==t.indexOf("font-family=")&&(Z.fontFamily=a),-1==t.indexOf("font-size=")&&(Z.fontSize=n),-1==t.indexOf("font-size-adjust=")&&(Z.fontSizeAdjust=l),-1==t.indexOf("font-style=")&&(Z.fontStyle=o),-1==t.indexOf("font-stretch=")&&(Z.fontStretch=r),-1==t.indexOf("font-variant=")&&(Z.fontVariant=s),-1==t.indexOf("font-weight=")&&(Z.fontWeight=u),-1==t.indexOf("line-height=")&&(Z.lineHeight=d),-1==t.indexOf("text-align=")&&(Z.textAlign=p),-1==t.indexOf("text-decoration=")&&(Z.textDecoration=c)},setHTMLTextStyle:function(e,t,i,a,n,l,o,r,s,u,d,p){var c=e.style;c.color=t,c.fontFamily=i,c.fontSize=a,c.fontSizeAdjust=n,c.fontStyle=l,c.fontStretch=o,c.fontVariant=r,c.fontWeight=s,c.lineHeight=u,c.textAlign=d,c.textDecoration=p},setTextAreaStyle:function(e,t,i,a,n,l,o,r,s,u,d,p,c){var Z=e.firstChild.style;Z.color=t,Z.fontFamily=i,Z.fontSize=a,Z.fontSizeAdjust=n,Z.fontStyle=l,Z.fontStretch=o,Z.fontVariant=r,Z.fontWeight=s,Z.lineHeight=u,Z.textAlign=d,Z.textDecoration=p,Z.padding=c},setTextNodeStyle:function(e,t,i,a,n,l,o,r,s,u,d,p){var c=e.parentNode.style;c.color=t,c.fontFamily=i,c.fontSize=a,c.fontSizeAdjust=n,c.fontStyle=l,c.fontStretch=o,c.fontVariant=r,c.fontWeight=s,c.lineHeight=u,c.textAlign=d,c.textDecoration=p},stringValidateColorValue:function(e){return Z.Utils.stringValidate(e)||(e="#000000"),0!=e.indexOf("#")&&(e="#"+e),e},hexToRGB:function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,i,a){return t+t+i+i+a+a});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null},xmlConvertTextToDoc:function(e){var t=null;if(window.ActiveXObject)try{t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(e)}catch(i){this.showMessage(i.name+this.getResource("ERROR_CONVERTINGXMLTEXTTODOC")+i.message)}else if(window.DOMParser)try{var a=new DOMParser;t=a.parseFromString(e,"text/xml")}catch(i){this.showMessage(i.name+this.getResource("ERROR_CONVERTINGXMLTEXTTODOC")+i.message)}else this.showMessage(this.getResource("ERROR_XMLDOMUNSUPPORTED"));return t},xmlConvertDocToText:function(e){var t=null;if(window.ActiveXObject)try{t=e.xml}catch(i){this.showMessage(i.name+this.getResource("ERROR_CONVERTINGXMLDOCTOTEXT")+i.message)}else if(window.DOMParser)try{t=(new XMLSerializer).serializeToString(e)}catch(i){this.showMessage(i.name+this.getResource("ERROR_CONVERTINGXMLDOCTOTEXT")+i.message)}else this.showMessage(this.getResource("ERROR_XMLDOMUNSUPPORTED"));return t},xmlEscapeMinimal:function(e){var t=null;return"undefined"!=typeof e&&null!==e&&(t=e.replace(/&/g,"&").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\r?\n/g,"%0A")),t},xmlUnescapeMinimal:function(e){var t=null;return"undefined"!=typeof e&&null!==e&&(t=e.replace(/%0A/g,"\n").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&/g,"&")),t},jsonConvertObjectToXMLText:function(e){var t=function(e,i){var a="";if(e instanceof Array)for(var n=0,l=e.length;l>n;n++)a+=t(e[n],i)+"\n";else if("object"==typeof e){var o=!1;
a+="<"+i;for(var r in e)"object"!=typeof e[r]?a+=" "+r+'="'+e[r].toString()+'"':o=!0;if(a+=">",o)for(var r in e)"#text"==r?a+=e[r]:"object"==typeof e[r]&&(a+=t(e[r],r));a+="</"+i+">"}else a+="<"+i+">"+e.toString()+"</"+i+">";return a},i="";for(var a in e)i+=t(e[a],a);var n=i.replace(/\t|\n/g,"");return n},jsonConvertXMLTextToJSONText:function(e){var t={convertToObject:function(e){var i={};if(1==e.nodeType){if(e.attributes.length)for(var a=0,n=e.attributes.length;n>a;a++)i[e.attributes[a].nodeName]=(e.attributes[a].nodeValue||"").toString();if(e.firstChild){for(var l=0,o=!1,r=e.firstChild;r;r=r.nextSibling)1==r.nodeType?o=!0:3==r.nodeType&&r.nodeValue.match(/[^ \f\n\r\t\v]/)&&l++;if(o)if(2>l){t.reduceWhitespace(e);for(var r=e.firstChild;r;r=r.nextSibling)3==r.nodeType?i["#text"]=t.escapeMinimal(r.nodeValue):i[r.nodeName]?i[r.nodeName]instanceof Array?i[r.nodeName][i[r.nodeName].length]=t.convertToObject(r):i[r.nodeName]=[i[r.nodeName],t.convertToObject(r)]:i[r.nodeName]=t.convertToObject(r)}else e.attributes.length?i["#text"]=t.escapeMinimal(t.innerXML(e)):i=t.escapeMinimal(t.innerXML(e));else l&&(e.attributes.length?i["#text"]=t.escapeMinimal(t.innerXML(e)):i=t.escapeMinimal(t.innerXML(e)))}e.attributes.length||e.firstChild||(i=null)}else 9==e.nodeType?i=t.convertToObject(e.documentElement):alert("This node type not supported : "+e.nodeType);return i},convertToJSONText:function(e,i){var a=i?'"'+i+'"':"";if(e instanceof Array){for(var n=0,l=e.length;l>n;n++)e[n]=t.convertToJSONText(e[n],"","	");a+=(i?":[":"[")+(e.length>1?"\n	"+e.join(",\n	")+"\n":e.join(""))+"]"}else if(null==e)a+=(i&&":")+"null";else if("object"==typeof e){var o=[];for(var r in e)o[o.length]=t.convertToJSONText(e[r],r,"	");a+=(i?":{":"{")+(o.length>1?"\n	"+o.join(",\n	")+"\n":o.join(""))+"}"}else a+="string"==typeof e?(i&&":")+'"'+e.toString()+'"':(i&&":")+e.toString();return a},reduceWhitespace:function(e){e.normalize();for(var i=e.firstChild;i;)if(3==i.nodeType)if(i.nodeValue.match(/[^ \f\n\r\t\v]/))i=i.nextSibling;else{var a=i.nextSibling;e.removeChild(i),i=a}else 1==i.nodeType?(t.reduceWhitespace(i),i=i.nextSibling):i=i.nextSibling;return e},escapeMinimal:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},innerXML:function(e){var t="";if("innerHTML"in e)t=e.innerHTML;else for(var i=function(e){var t="";if(1==e.nodeType){t+="<"+e.nodeName;for(var a=0,n=e.attributes.length;n>a;a++)t+=" "+e.attributes[a].nodeName+"='"+(e.attributes[a].nodeValue||"").toString()+"'";if(e.firstChild){t+=">";for(var l=e.firstChild;l;l=l.nextSibling)t+=i(l);t+="</"+e.nodeName+">"}else t+="/>"}else 3==e.nodeType&&(t+=e.nodeValue);return t},a=e.firstChild;a;a=a.nextSibling)t+=i(a);return t}};9==e.nodeType&&(xml=xml.documentElement);var i=t.convertToJSONText(t.convertToObject(t.reduceWhitespace(e)),e.nodeName,"	");return jsonTextOut="{\n  "+i.replace(/\t/g,"  ")+"\n}",jsonTextOut},arrayClear:function(e){if(e)for(;e.length>0;)e.pop()},arrayClone:function(e,t,i){switch(i=[],e){case"pois":for(var a=0,n=t.length;n>a;a++)i[i.length]={text:t[a].text,value:t[a].value,id:t[a].id,x:t[a].x,y:t[a].y,z:t[a].z};break;case"labels":for(var a=0,n=t.length;n>a;a++)i[i.length]={text:t[a].text,value:t[a].value,poiID:t[a].poiID,id:t[a].id};break;case"hotspots":for(var a=0,n=t.length;n>a;a++)i[i.length]={id:t[a].id,internalID:t[a].internalID,poiID:t[a].poiID,name:t[a].name,mediaType:t[a].mediaType,media:t[a].media,audio:t[a].audio,image:t[a].image,iW:t[a].iW,iH:t[a].iH,x:t[a].x,y:t[a].y,z:t[a].z,xScale:t[a].xScale,yScale:t[a].yScale,clickURL:t[a].clickURL,urlTarget:t[a].urlTarget,rollover:t[a].rollover,caption:t[a].caption,tooltip:t[a].tooltip,user:t[a].user,date:t[a].date,textColor:t[a].textColor,backColor:t[a].backColor,lineColor:t[a].lineColor,fillColor:t[a].fillColor,textVisible:t[a].textVisible,backVisible:t[a].backVisible,lineVisible:t[a].lineVisible,fillVisible:t[a].fillVisible,captionPosition:t[a].captionPosition,saved:t[a].saved,visibility:t[a].visibility,captionHTML:t[a].captionHTML,tooltipHTML:t[a].tooltipHTML,polyClosed:t[a].polyClosed,polygonPts:t[a].polygonPts,showFor:t[a].showFor,transition:t[a].transition,changeFor:t[a].changeFor,rotation:t[a].rotation};break;case"polygon":for(var a=0,n=t.length;n>a;a++)i[i.length]={x:t[a].x,y:t[a].y};break;case"notes":for(var a=0,n=t.length;n>a;a++)i[i.length]={text:t[a].text,value:t[a].value,noteText:t[a].noteText,poiID:t[a].poiID,id:t[a].id};break;case"magnifications":for(var a=0,n=t.length;n>a;a++)i[i.length]={text:t[a].text,value:t[a].value}}return i},arrayIndexOf:function(e,t,i){i?0>i&&(i=Math.max(0,e.length+i)):i=0;for(var a=i,n=e.length;n>a;a++)if(e[a]===t)return a;return-1},arrayIndexOfObjectValue:function(e,t,i,a){if("undefined"!=typeof e){a?0>a&&(a=Math.max(0,e.length+a)):a=0;for(var n=a,l=e.length;l>n;n++)if(e[n][t]===i)return n}return-1},arrayIndexOfObjectTwoValues:function(e,t,i,a,n,l){if("undefined"!=typeof e){a?0>a&&(a=Math.max(0,e.length+a)):a=0;for(var o=a,r=e.length;r>o;o++)if(e[o][t]===i&&e[o][n].toString()===l.toString())return o}return-1},arrayIndexOfObjectValueSubstring:function(e,t,i,a,n){a?0>a&&(a=Math.max(0,e.length+a)):a=0;for(var l=a,o=e.length;o>l;l++)if(n){if(-1!=e[l][t].toLowerCase().indexOf(i))return l}else if(-1!=e[l][t].indexOf(i))return l;return-1},arraySplice:function(e,t,i){if(Z.arraySpliceSupported)if(arguments.length>3)for(var a=3,n=arguments.length;n>a;a++)e.splice(t,i,arguments[a]);else e.splice(t,i);else{0>i&&(i=0);var l=[];if(arguments.length>3)for(var a=3,n=arguments.length;n>a;a++)l[l.length]=arguments[a];var o=Z.Utils.arraySubarray(e,0,t),r=Z.Utils.arraySubarrayLen(e,t,i),s=Z.Utils.arraySubarray(e,t+i),u=o.concat(l,s);e.length=0;for(var a=0,n=u.length;n>a;a++)e[e.length]=u[a];e=r}return e},arraySubarraySimple:function(e,t){return this.slice(e,t)},arraySortNumericAscending:function(e){return e.sort(function(e,t){return e-t}),e},arraySubarray:function(e,t,i){if(0>t&&(t=0),(!i||i>e.length)&&(i=e.length),t==i)return[];for(var a=[],n=t;i>n;n++)a[a.length]=e[n];return a},arraySubarrayLen:function(e,t,i){if(t>=e.length||i&&0>=i)return[];0>t&&(t=Math.abs(t)>e.length?0:e.length+t),(!i||i+t>e.length)&&(i=e.length-t);for(var a=[],n=t;t+i>n;n++)a[a.length]=e[n];return a},arrayToArrayOfStrings:function(e){for(var t=[],i=0,a=e.length;a>i;i++)t[i]="undefined"!=typeof e[i]&&"undefined"!=e[i]&&null!==e[i]?e[i].toString():"";return t},arrayUnique:function(e){for(var t=1;t<e.length;)e[t-1]==e[t]?e=Z.Utils.arraySplice(e,t,1):t++;return e},arrayUniqueByObjectValue:function(e,t){if("undefined"!=typeof e)for(var i=1;i<e.length;)e[i-1][t]==e[i][t]?e=Z.Utils.arraySplice(e,i,1):i++;return e},playAudio:function(e,t){if(!Z.audioMuted)if("undefined"!=typeof e&&null!==e)e.play();else if(Z.Utils.stringValidate(t)){var i=new Audio(t);i.play()}},loadAudio:function(e){if(Z.Utils.stringValidate(e)){var t=new Audio(e);t.load()}},calculatePointsDistance:function(e,t,i,a){return Math.sqrt((e-=i)*e+(t-=a)*t)},convertPixelsToUnits:function(e,t,i){var a=1;"undefined"!=typeof t&&null!==t&&0!=t?a=t:"undefined"!=typeof i&&null!==i&&0!=i&&(a=Z.imageW/i);var n=e/a;return n},polygonArea:function(e,t,i,a){("undefined"==typeof a||null===a)&&(a=4);var n=e.slice(0);t?n[n.length]={x:n[0].x,y:n[0].y}:"undefined"!=typeof i&&null!==i&&(n[n.length]={x:i.x,y:i.y});for(var l=0,o=0,r=0,s=n.length-1;s>r;r++)l+=n[r].x*n[r+1].y,o+=n[r].y*n[r+1].x;var u=(l-o)/2;return u=Z.Utils.convertPixelsToUnits(u,Z.pixelsPerUnit,Z.unitsPerImage),u=Z.Utils.convertPixelsToUnits(u,Z.pixelsPerUnit,Z.unitsPerImage),u=Z.Utils.roundToFixed(Math.abs(u),a)},polygonCenter:function(e,t,i){var a=0,n=0;if("undefined"!=typeof e&&null!==e&&e.length>0){var l=e.slice(0);t?l[l.length]={x:l[0].x,y:l[0].y}:"undefined"!=typeof i&&null!==i&&(l[l.length]={x:i.x,y:i.y});for(var o=l[0],r=o.x,s=o.y,u=o.x,d=o.y,p=1,c=l.length;c>p;p++)o=l[p],r=Math.min(r,o.x),s=Math.min(s,o.y),u=Math.max(u,o.x),d=Math.max(d,o.y);a=r+(u-r)/2,n=s+(d-s)/2}return new Z.Utils.Point(a,n)},polygonDimensions:function(e,t){var i=0,a=0;if("undefined"!=typeof e&&null!==e&&e.length>0){var n=e.slice(0);if("undefined"!=typeof t&&null!==t){var l=.1*(n[n.length-1].x-t.x),o=.1*(n[n.length-1].y-t.y);n[n.length]={x:t.x+l,y:t.y+o}}for(var r=n[0].x,s=n[0].y,u=n[0].x,d=n[0].y,p=1,c=n.length;c>p;p++)n[p].x<r&&(r=n[p].x),n[p].x>u&&(u=n[p].x),n[p].y<s&&(s=n[p].y),n[p].y>d&&(d=n[p].y);i=u-r,a=d-s}return new Z.Utils.Point(i,a)},polygonPerimeter:function(e,t,i,a){("undefined"==typeof a||null===a)&&(a=5);var n=e.slice(0);t?n[n.length]={x:n[0].x,y:n[0].y}:"undefined"!=typeof i&&null!==i&&(n[n.length]={x:i.x,y:i.y});for(var l=0,o=0,r=n.length-1;r>o;o++)l+=Z.Utils.calculatePointsDistance(n[o].x,n[o].y,n[o+1].x,n[o+1].y);return l=Z.Utils.convertPixelsToUnits(l,Z.pixelsPerUnit,Z.unitsPerImage),l=Z.Utils.roundToFixed(Math.abs(l),a)},fullScreenView:function(e,t,i){if("undefined"==typeof i||null===i)var i=!1;if(t){var a=document.documentElement;a.requestFullScreen?(e.requestFullScreen(),Z.Utils.addEventListener(document,"fullscreenchange",Z.Viewport.fullScreenEscapeHandler)):a.mozRequestFullScreen?(e.mozRequestFullScreen(),Z.Utils.addEventListener(document,"mozfullscreenchange",Z.Viewport.fullScreenEscapeHandler)):a.webkitRequestFullScreen?(e.webkitRequestFullScreen(),Z.Utils.addEventListener(document,"webkitfullscreenchange",Z.Viewport.fullScreenEscapeHandler)):a.msRequestFullscreen&&(e.msRequestFullscreen(),Z.Utils.addEventListener(document,"MSFullscreenChange",Z.Viewport.fullScreenEscapeHandler))}else document.cancelFullScreen?(i||document.cancelFullScreen(),Z.Utils.removeEventListener(document,"fullscreenchange",Z.Viewport.fullScreenEscapeHandler)):document.msExitFullscreen?(i||document.msExitFullscreen(),Z.Utils.removeEventListener(document,"MSFullscreenChange",Z.Viewport.fullScreenEscapeHandler)):document.mozCancelFullScreen?(i||document.mozCancelFullScreen(),Z.Utils.removeEventListener(document,"mozfullscreenchange",Z.Viewport.fullScreenEscapeHandler)):document.webkitCancelFullScreen&&(i||document.webkitCancelFullScreen(),Z.Utils.removeEventListener(document,"webkitfullscreenchange",Z.Viewport.fullScreenEscapeHandler))},rotatePoint:function(e,t,i){var a=Math.PI/180,n=-i*a,l=e*Math.cos(n)-t*Math.sin(n),o=e*Math.sin(n)+t*Math.cos(n);return new Z.Utils.Point(l,o)},rotateElement:function(e,t,i){if(t!=Z.imageR||i){var a="rotate("+t.toString()+"deg)";e.transform=a,e.msTransform=a,e.mozTransform=a,e.webkitTransform=a,e.oTransform=a}},getDisplayPositionRotated:function(e,t){("undefined"==typeof t||null===t)&&(t=Z.imageR),0>t&&(t+=360);var i=parseFloat(e.width)/2,a=parseFloat(e.height)/2,n=Z.Utils.rotatePoint,l=new Z.Utils.Point(0,0);return 0!=t&&(90==t?l=n(-i,a,-t):180==t?l=n(i,a,-t):270==t&&(l=n(i,-a,-t)),l.x+=i,l.y+=a),new Z.Utils.Point(l.x,l.y)},translateElement:function(e,t,i){var a="translate("+t.toString()+"px,"+i.toString()+"px)";e.transform=a,e.msTransform=a,e.mozTransform=a,e.webkitTransform=a,e.oTransform=a},intValue:function(e,t){return(e[t]+(e[t+1]<<8)|e[t+2]<<16)+16777216*e[t+3]},longValue:function(e,t){var i=(e[t]+(e[t+1]<<8)|e[t+2]<<16)+16777216*e[t+3];return 0!=e[t+4]&&(i+=4294967296*e[t+4]),i},shortValue:function(e,t){return e[t]+(e[t+1]<<8)},createUint8Array:function(e,t){return Z.uInt8ArraySupported?new Uint8Array(e,t):new Z.Utils.TypedArray(e,t)},TypedArray:function(e){var t;if("number"==typeof e){t=new Array(e);for(var i=0;e>i;++i)t[i]=0}else t=e.slice(0);return t.subarray=Z.Utils.arraySubarraySimple,t.buffer=t,t.byteLength=t.length,t.set=Z.Utils.setSimple,"object"==typeof e&&e.buffer&&(t.buffer=e.buffer),t},setSimple:function(e,t){arguments.length<2&&(t=0);for(var i=0,a=e.length;a>i;++i,++t)this[t]=255&e[i]},encodeBase64:function(e){var t,i,a,n,l,o,r,s,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,p=0,c="",Z=[];if(!e)return e;do t=e[d++],i=e[d++],a=e[d++],s=t<<16|i<<8|a,n=s>>18&63,l=s>>12&63,o=s>>6&63,r=63&s,Z[p++]=u.charAt(n)+u.charAt(l)+u.charAt(o)+u.charAt(r);while(d<e.length);c=Z.join("");var g=e.length%3;return(g?c.slice(0,g-3):c)+"===".slice(g||3)},validateResponseArrayFunctionality:function(){"ZoomifyImageFile"!=Z.tileSource||Z.responseArraySupported||Z.responseArrayPrototyped||(Z.Utils.defineObjectProperty(XMLHttpRequest.prototype,"response",{get:function(){return new VBArray(this.responseBody).toArray()}}),Z.responseArrayPrototyped=!0)},defineObjectProperty:function(e,t,i){Z.definePropertySupported?Object.defineProperty(e,t,i):(delete e[t],"get"in i&&e.__defineGetter__(t,i.get),"set"in i&&e.__defineSetter__(t,i.set),"value"in i&&(e.__defineSetter__(t,function(e){return this.__defineGetter__(t,function(){return e}),e}),e[t]=i.value))},createImageElementFromBytes:function(e,t){function i(){a.onload=null,a.onabort=null,a.onerror=null,n&&window.clearTimeout(n),window.setTimeout(function(){t(a)},1)}var a=new Image,n=null,l=parseFloat(this.getResource("DEFAULT_IMAGELOADTIMEOUT")),o=function(){console.log(Z.Utils.getResource("ERROR_IMAGEREQUESTTIMEDOUT")),i(!1)},r=function(){i(!0)},s=function(){i(!1)};a.onload=r,a.onabort=s,a.onerror=s,n=window.setTimeout(o,l),a.src=e},getCurrentUTCDateAsString:function(){var e=new Date,t=(e.getUTCMonth()+1<10?"0":"")+(e.getUTCMonth()+1),i=(e.getUTCDate()<10?"0":"")+e.getUTCDate(),a=(e.getUTCHours()<10?"0":"")+e.getUTCHours(),n=(e.getUTCMinutes()<10?"0":"")+e.getUTCMinutes(),l=(e.getUTCSeconds()<10?"0":"")+e.getUTCSeconds();return e.getUTCFullYear()+t+i+a+n+l},cacheProofPath:function(e){return e+="?t"+(new Date).getTime().toString()+"n"+Z.cacheProofCounter.toString(),Z.cacheProofCounter+=1,e},easing:function(e,t,i,a){var n=t-e;return(i/=a/2)<1?n/2*i*i*i*i*i+e:n/2*((i-=2)*i*i*i*i+2)+e},functionCallWithDelay:function(e,t){window.setTimeout(e,t)},nodeIsInViewer:function(e){for(var t=!1,i=e;0==t&&i;)i.id&&"ViewerDisplay"==i.id?t=!0:i=i.parentNode;return t},roundToFixed:function(e,t){var i=Math.round(e).toString().length,a=t-i,n=0>a?0:a,l=Math.pow(10,n);return e=Math.round(e*l)/l},getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},getSign:function(e){return e?0>e?-1:1:0},drawCrosshairs:function(e,t,i){var a=Z.Utils.createContainerElement("div","viewportCenterLineVertical","inline-block","absolute","visible","1px",i+"px",t/2+"px","0px","solid","1px","transparent none","0px","0px","normal",null,!0),n=Z.Utils.createContainerElement("div","viewportCenterLineHorizontal","inline-block","absolute","visible",t+"px","1px","0px",i/2+"px","solid","1px","transparent none","0px","0px","normal",null,!0);e.appendChild(n),e.appendChild(a)},configureHelpDisplay:function(){var e=80,t=80,i=parseInt(this.getResource("UI_HELPDISPLAYWIDTH"),10),a=parseInt(this.getResource("UI_HELPDISPLAYHEIGHT"),10);i>=Z.viewerW&&(i=Z.viewerW-e,e-=40),a>=Z.viewerH&&(a=Z.viewerH-t,t-=40);var n=Z.viewerW-i-e,l=Z.viewerH-a-t,o=this.getResource("DEFAULT_HELPSCREENCOLOR"),r=this.getResource("DEFAULT_HELPBUTTONCOLOR");Z.HelpDisplay=this.createContainerElement("div","HelpDisplay","inline-block","absolute","hidden",i+"px",a+"px",n+"px",l+"px","solid","1px",o,"0px","0px","normal",null,!0),Z.ViewerDisplay.appendChild(Z.HelpDisplay);var s=Z.Utils.createContainerElement("div","helpTextBox","inline-block","absolute",null,i-50+"px",a-74+"px","4px","4px","solid","1px","white","0px","20px",null);s.style.overflowY="auto",Z.HelpDisplay.appendChild(s),Z.help=document.getElementById("helpTextBox");var u=parseInt(Z.Utils.getResource("DEFAULT_UIELEMENTBASEZINDEX"),10);Z.HelpDisplay.style.zIndex=(u+9).toString();var d,p=56,c=18,g=10,m=5,h=i,f=a-c-m;h-=p+g,d=this.getResource("UI_HELPOKBUTTONTEXT");var T=new Z.Utils.Button("buttonHelpOk",d,null,null,null,null,p+"px",c+"px",h+"px",f+"px","mousedown",this.helpOkButtonHandler,"TIP_HELPOK","solid","1px",r,"0px","0px");Z.HelpDisplay.appendChild(T.elmt)},helpOkButtonHandler:function(){return Z.Utils.hideHelp(),!0},showHelp:function(e){if(Z.HelpDisplay||Z.Utils.configureHelpDisplay(),Z.help){Z.help.innerHTML=unescape(e),Z.HelpDisplay.style.display="inline-block";var t=document.getElementById("buttonHelpOk");t.style.display="inline-block"}},hideHelp:function(){Z.HelpDisplay.style.display="none"},configureMessageDisplay:function(){var e=parseInt(this.getResource("UI_MESSAGEDISPLAYWIDTH"),10),t=parseInt(this.getResource("UI_MESSAGEDISPLAYHEIGHT"),10),i=40,a=Z.viewerH-t-40,n=this.getResource("DEFAULT_MESSAGESCREENCOLOR"),l=this.getResource("DEFAULT_MESSAGEBUTTONCOLOR");Z.MessageDisplay=this.createContainerElement("div","MessageDisplay","inline-block","absolute","hidden",e+"px",t+"px",i+"px",a+"px","solid","1px",n,"0px","0px","normal",null,!0),Z.ViewerDisplay.appendChild(Z.MessageDisplay);var o=parseInt(Z.Utils.getResource("DEFAULT_UIELEMENTBASEZINDEX"),10);Z.MessageDisplay.style.zIndex=(o+10).toString();var r=Z.Utils.createTextElement("messageBox","",e-18+"px",t-40+"px","4px","4px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.MessageDisplay.appendChild(r),Z.messages=document.getElementById("messageBox");var s,u=56,d=18,p=10,c=5,g=e,m=t-d-c;g-=u+p,s=this.getResource("UI_MESSAGEOKBUTTONTEXT");var h=new Z.Utils.Button("buttonMessageOk",s,null,null,null,null,u+"px",d+"px",g+"px",m+"px","mousedown",this.messageOkButtonHandler,"TIP_MESSAGEOK","solid","1px",l,"0px","0px");Z.MessageDisplay.appendChild(h.elmt)},messageOkButtonHandler:function(){return Z.Utils.hideMessage(),Z.Viewport&&Z.coordinatesVisible&&Z.Viewport.setCoordinatesDisplayVisibility(!1),!0},messageCancelButtonHandler:function(){return Z.Utils.hideMessage(),!1},showMessage:function(e,t,i,a,n){if(Z.messagesVisible){Z.MessageDisplay||Z.Utils.configureMessageDisplay(),Z.MessageDisplay.messageTimer&&window.clearTimeout(MessageDisplay.messageTimer);var l=!0;if(n&&(-1!=Z.Utils.arrayIndexOf(Z.messageDisplayList,e)?l=!1:Z.messageDisplayList[Z.messageDisplayList.length]=e),l){if(Z.messages&&(Z.messages.value=e),Z.MessageDisplay.style.display="inline-block","undefined"!=typeof a&&null!==a){var o=document.getElementById("textBoxFor-messageBox");o&&(o.firstChild.style.textAlign=a)}var r=document.getElementById("buttonMessageOk"),s=parseInt(this.getResource("UI_MESSAGEDISPLAYHEIGHT"),10);"undefined"!=typeof t&&null!==t&&t?(r.style.display="inline-block",Z.MessageDisplay.style.height=s+"px"):(r.style.display="none",Z.MessageDisplay.style.height=s-22+"px"),"undefined"==typeof i||null===i||isNaN(i)||("undefined"!=typeof Z.MessageDisplay.messageTimer&&null!==Z.MessageDisplay.messageTimer&&window.clearTimeout(Z.MessageDisplay.messageTimer),("undefined"==typeof i||null===i)&&(i=3e3),Z.MessageDisplay.messageTimer=window.setTimeout(Z.Utils.hideMessageTimerHandler,i))}}},getMessage:function(){var e="";return Z.messages&&Z.Utils.stringValidate(Z.messages.value)&&(e=Z.messages.value),e},hideMessage:function(){Z.MessageDisplay&&(Z.MessageDisplay.style.display="none")},hideMessageTimerHandler:function(){Z.MessageDisplay.messageTimer&&(window.clearTimeout(Z.MessageDisplay.messageTimer),Z.MessageDisplay.messageTimer=null),Z.Utils.hideMessage()},uploadProgress:function(e){var t=Z.saveImageMessage;if(e.lengthComputable){var i=Math.round(100*e.loaded/e.total);t+=i.toString()+"%"}else t+=Z.Utils.getResource("ALERT_IMAGESAVEUNABLETOCOMPUTEPROGRESS");Z.Utils.showMessage(t,!1,"none","center")},configureCoordinatesDisplay:function(){var e=parseInt(this.getResource("UI_COORDINATESDISPLAYWIDTH"),10),t=parseInt(this.getResource("UI_COORDINATESDISPLAYHEIGHT"),10),i=Z.viewerW-e-20,a=Z.viewerH-t-30,n=this.getResource("DEFAULT_COORDINATESSCREENCOLOR");Z.CoordinatesDisplay=this.createContainerElement("div","CoordinatesDisplay","inline-block","absolute","hidden",e+"px",t+"px",i+"px",a+"px","solid","1px",n,"0px","0px","normal"),Z.ViewerDisplay.appendChild(Z.CoordinatesDisplay);var l=parseInt(Z.Utils.getResource("DEFAULT_UIELEMENTBASEZINDEX"),10);Z.CoordinatesDisplay.style.zIndex=(l+8).toString();var o=Z.Utils.getResource("UI_COORDINATESDISPLAYTEXT"),r=Z.Utils.createTextElement("coordsLabelBox",o,e-18+"px","28px","4px","4px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.CoordinatesDisplay.appendChild(r);var s=document.getElementById("textBoxFor-coordsLabelBox");s&&(s.firstChild.style.textAlign="center");var u=Z.Utils.createTextElement("coordsDisplayBox","",e-18+"px","18px","4px","46px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.CoordinatesDisplay.appendChild(u),Z.coordinates=document.getElementById("coordsDisplayBox");var d=document.getElementById("textBoxFor-coordsDisplayBox");d&&(d.firstChild.style.textAlign="center");var p=Z.Utils.createTextElement("coordsSaveBox","",e-18+"px",t-92+"px","4px","78px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.CoordinatesDisplay.appendChild(p),Z.coordinatesSave=document.getElementById("coordsSaveBox");var c=document.getElementById("textBoxFor-coordsSaveBox");c&&(c.firstChild.style.textAlign="center")},showCoordinates:function(e){Z.CoordinatesDisplay||Z.Utils.configureCoordinatesDisplay(),Z.coordinates&&(Z.coordinates.value=e)},saveCoordinates:function(e){Z.CoordinatesDisplay||Z.Utils.configureCoordinatesDisplay(),Z.coordinatesSave&&(Z.coordinatesSave.value+=e+"\n")},configureTraceDisplay:function(){if("undefined"!=typeof Z.Viewport&&null!==Z.Viewport){var e=280,t=280,i=10,a=Z.viewerH-330,n=125,l=this.getResource("DEFAULT_TRACEDISPLAYSCREENCOLOR");Z.TraceDisplay=this.createContainerElement("div","TraceDisplay","inline-block","absolute","hidden",e+"px",t+"px",i+"px",a+"px","solid","1px",l,"0px","10px","normal"),Z.ViewerDisplay.appendChild(Z.TraceDisplay);var o=parseInt(Z.Utils.getResource("DEFAULT_UIELEMENTBASEZINDEX"),10);Z.TraceDisplay.style.zIndex=(o+12).toString();var r=Z.Utils.getResource("UI_TRACEDISPLAYTITLE"),s=Z.Utils.createTextElement("debugTraces",r,e-15+"px",t-n+"px","10px","10px","5px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.TraceDisplay.appendChild(s),Z.traces=document.getElementById("debugTraces");var u=parseInt(Z.Utils.getResource("DEFAULT_TRACEDISPLAYTEXTFONTSIZE"),10),d=parseInt(Z.Utils.getResource("DEFAULT_TRACEDISPLAYTEXTPADDINGSMALL"),10),p=37,c=p+8,g=e-5,m=textH=16,h=10,f=u-2,T=97,b=82,E=15,v=85,I=50,y=56,U=60,S=Z.Utils.createContainerElement("div","labelTileStatusTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent none","0px","0px","nowrap",null,!0),A=document.createTextNode(Z.Utils.getResource("UI_TRACEDISPLAYTILESTATUSTEXT"));S.appendChild(A),Z.TraceDisplay.appendChild(S);var L=document.getElementById("labelTileStatusTextBox");if(L){var x=L.style;x.width=g+"px",x.height=m+"px",x.left=h+"px",x.top=t-T+"px",Z.Utils.setTextNodeStyle(L,"black","verdana",f+"px","none","normal","normal","normal","normal","1em","center","none")}var w=h+7,O=Z.Utils.createTextElement("tilesRequiredTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(O);var R=document.getElementById("textBoxFor-tilesRequiredTextElement");if(R){var P=R.style;P.width=p+"px",P.height=textH+"px",P.left=w+"px",P.top=t-b+"px",Z.Utils.setTextAreaStyle(R,"black","verdana",u+"px","none","normal","normal","normal","normal","1em","center","none",d+"px"),w+=c}var D=Z.Utils.createTextElement("tilesCachedTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(D);var C=document.getElementById("textBoxFor-tilesCachedTextElement");if(C){var N=C.style;N.width=p+"px",N.height=textH+"px",N.left=w+"px",N.top=t-b+"px",Z.Utils.setTextAreaStyle(C,"black","verdana",u+"px","none","normal","normal","normal","normal","1em","center","none",d+"px"),w+=c}var V=Z.Utils.createTextElement("tilesRequestedTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(V);var k=document.getElementById("textBoxFor-tilesRequestedTextElement");if(k){var M=k.style;M.width=p+"px",M.height=textH+"px",M.left=w+"px",M.top=t-b+"px",Z.Utils.setTextAreaStyle(k,"black","verdana",u+"px","none","normal","normal","normal","normal","1em","center","none",d+"px"),w+=c}var F=Z.Utils.createTextElement("tilesLoadedTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(F);var _=document.getElementById("textBoxFor-tilesLoadedTextElement");if(_){var H=_.style;H.width=p+"px",H.height=textH+"px",H.left=w+"px",H.top=t-b+"px",Z.Utils.setTextAreaStyle(_,"black","verdana",u+"px","none","normal","normal","normal","normal","1em","center","none",d+"px"),w+=c}var B=Z.Utils.createTextElement("tilesDisplayedTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(B);var z=document.getElementById("textBoxFor-tilesDisplayedTextElement");if(z){var X=z.style;X.width=p+"px",X.height=textH+"px",X.left=w+"px",X.top=t-b+"px",Z.Utils.setTextAreaStyle(z,"black","verdana",u+"px","none","normal","normal","normal","normal","1em","center","none",d+"px"),w+=c}var G=Z.Utils.createTextElement("tilesWaitingTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(G);var W=document.getElementById("textBoxFor-tilesWaitingTextElement");if(W){var Y=W.style;Y.width=p+"px",Y.height=textH+"px",Y.left=w+"px",Y.top=t-b+"px",Z.Utils.setTextAreaStyle(W,"black","verdana",u+"px","none","normal","normal","normal","normal","1em","center","none",d+"px")}var K=Z.Utils.createContainerElement("div","labelElapsedTimeTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent none","0px","0px","nowrap",null,!0),j=document.createTextNode(Z.Utils.getResource("UI_TRACEDISPLAYELAPSEDTIMETEXT"));K.appendChild(j),Z.TraceDisplay.appendChild(K);var q=document.getElementById("labelElapsedTimeTextBox");if(q){var Q=q.style;Q.width=v+"px",Q.height=m+"px",Q.left=E+"px",Q.top=t-y+"px",Z.Utils.setTextNodeStyle(q,"black","verdana",f+"px","none","normal","normal","normal","normal","1em","left","none")}var J=Z.Utils.createTextElement("tilesTimeElapsedTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(J);var $=document.getElementById("textBoxFor-tilesTimeElapsedTextElement");if($){var et=$.style;et.width=I+"px",et.height=textH+"px",et.left=E+v/2+10+"px",et.top=t-U+"px",Z.Utils.setTextAreaStyle($,"black","verdana",u+"px","none","normal","normal","normal","normal","1em","center","none",d+"px")}var tt=Z.Utils.createContainerElement("div","labelTilesPerSecondTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent none","0px","0px","nowrap",null,!0),it=document.createTextNode(Z.Utils.getResource("UI_TRACEDISPLAYTILESPERSECONDTEXT"));tt.appendChild(it),Z.TraceDisplay.appendChild(tt);var at=document.getElementById("labelTilesPerSecondTextBox");if(at){var nt=at.style;nt.width=v+"px",nt.height=m+"px",nt.left=E+v+I-20+"px",nt.top=t-y+"px",Z.Utils.setTextNodeStyle(at,"black","verdana",f+"px","none","normal","normal","normal","normal","1em","left","none")}var lt=Z.Utils.createTextElement("tilesPerSecondTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(lt);var ot=document.getElementById("textBoxFor-tilesPerSecondTextElement");if(ot){var rt=ot.style;rt.width=I+"px",rt.height=textH+"px",rt.left=E+2*v+I-20+"px",rt.top=t-U+"px",Z.Utils.setTextAreaStyle(ot,"black","verdana",u+"px","none","normal","normal","normal","normal","1em","center","none",d+"px")}var st=58,ut=42,dt=10,pt=t-ut/2-10,ct=10,Zt=this.getResource("DEFAULT_TRACEDISPLAYBUTTONCOLOR"),gt=this.getResource("UI_TRACEDISPLAYSHOWGLOBALSBUTTONTEXT"),mt=new this.Button("buttonShowGlobals",gt,null,null,null,null,st+"px",ut+"px",dt+"px",pt+"px","mousedown",this.showGlobals,"TIP_SHOWGLOBALS","solid","1px",Zt,"0px","0px");Z.TraceDisplay.appendChild(mt.elmt),dt+=st+ct;var gt=this.getResource("UI_TRACEDISPLAYTOGGLEDISPLAYBUTTONTEXT"),ht=new this.Button("buttonToggleDisplay",gt,null,null,null,null,st+"px",ut+"px",dt+"px",pt+"px","mousedown",Z.Viewport.toggleDisplay,"TIP_TOGGLEDISPLAY","solid","1px",Zt,"0px","0px");Z.TraceDisplay.appendChild(ht.elmt),dt+=st+ct;var gt=this.getResource("UI_TRACEDISPLAYTOGGLEBACKFILLBUTTONTEXT"),ft=new this.Button("buttonToggleBackfill",gt,null,null,null,null,st+"px",ut+"px",dt+"px",pt+"px","mousedown",Z.Viewport.toggleBackfill,"TIP_TOGGLEBACKFILL","solid","1px",Zt,"0px","0px");Z.TraceDisplay.appendChild(ft.elmt),dt+=st+ct,st+=12;var gt=this.getResource("UI_TRACEDISPLAYTOGGLECONSTRAINPANBUTTONTEXT"),Tt=new this.Button("buttonToggleConstrainPan",gt,null,null,null,null,st+"px",ut+"px",dt+"px",pt+"px","mousedown",Z.Viewport.toggleConstrainPan,"TIP_TOGGLECONSTRAINPAN","solid","1px",Zt,"0px","0px");Z.TraceDisplay.appendChild(Tt.elmt)}else{window.setTimeout(function(){Z.Utils.configureTraceDisplay()},100)}},showTraces:function(){Z.TraceDisplay?Z.TraceDisplay.style.display="inline-block":Z.Utils.configureTraceDisplay()},hideTraces:function(){Z.TraceDisplay.style.display="none"},trace:function(e,t,i){var a=t?"\n":"",n=i?"\n\n":"\n";Z.TraceDisplay||Z.Utils.configureTraceDisplay(),Z.traces&&(Z.traces.value+=a+e+n,2==Z.debug&&(Z.traces.scrollTop=Z.traces.scrollHeight))},traceTileStatus:function(e,t,i,a,n,l){if(!(o&&r&&s&&u&&d&&p))var o=document.getElementById("tilesRequiredTextElement"),r=document.getElementById("tilesCachedTextElement"),s=document.getElementById("tilesRequestedTextElement"),u=document.getElementById("tilesLoadedTextElement"),d=document.getElementById("tilesDisplayedTextElement"),p=document.getElementById("tilesWaitingTextElement");o&&r&&s&&u&&d&&p&&("undefined"!=typeof e&&null!==e&&(o.value=e.toString()),"undefined"!=typeof t&&null!==t&&(r.value=t.toString()),"undefined"!=typeof i&&null!==i&&(s.value=i.toString()),"undefined"!=typeof a&&null!==a&&(u.value=a.toString()),"undefined"!=typeof n&&null!==n&&(d.value=n.toString()),"undefined"!=typeof l&&null!==l&&(p.value=l.toString()))},traceTileSpeed:function(e,t){if(!i||!a)var i=document.getElementById("tilesTimeElapsedTextElement"),a=document.getElementById("tilesPerSecondTextElement");i&&a&&("undefined"!=typeof e&&null!==e&&(i.value=e.toString()),"undefined"!=typeof t&&null!==t&&(a.value=Math.round(t).toString()))},showGlobals:function(){var e="";e+="\n",e+="                            ZOOMIFY IMAGE VIEWER - CURRENT VALUES\n",e+="\n",e+="VIEW:    ",e+="Z.imageX="+Z.imageX+",   ",e+="Z.imageY="+Z.imageY+",   ",e+="Z.imageZ="+Z.imageZ+",   ",e+="Z.imageR="+Z.imageR+",   ",e+="Z.priorX="+Z.priorX+",   ",e+="Z.priorY="+Z.priorY+",   ",e+="Z.priorZ="+Z.priorZ+",   ",e+="Z.priorR="+Z.priorR+",   ",e+="\n",e+="IMAGE & SKIN:    ",e+="Z.imagePath="+Z.imagePath+",   ",e+="Z.skinPath="+Z.skinPath+",   ",e+="Z.skinMode="+Z.skinMode+",   ",e+="Z.imageW="+Z.imageW+",   ",e+="Z.imageH="+Z.imageH+",   ",e+="tierCount="+Z.Viewport.getTierCount()+",   ",e+="TILE_WIDTH="+Z.Viewport.getTileW()+",   ",e+="TILE_HEIGHT="+Z.Viewport.getTileH()+"\n",e+="\n",e+="PAGE & BROWSER:    ",e+="Z.pageContainer="+Z.pageContainer+",   ",e+="Z.browser="+Z.browser+",   ",e+="Z.browserVersion="+Z.browserVersion+",   ",e+="Z.canvasSupported="+Z.canvasSupported+",   ",e+="Z.cssTransformsSupported="+Z.cssTransformsSupported+",   ",e+="Z.cssTransformProperty="+Z.cssTransformProperty+",   ",e+="Z.cssTransformNoUnits="+Z.cssTransformNoUnits+",   ",e+="Z.alphaSupported="+Z.alphaSupported+",   ",e+="Z.renderQuality="+Z.renderQuality+",   ",e+="Z.rotationSupported="+Z.rotationSupported+",   ",e+="Z.fullScreenSupported="+Z.fullScreenSupported+",   ",e+="Z.float32ArraySupported="+Z.float32ArraySupported+",   ",e+="Z.uInt8ArraySupported="+Z.uInt8ArraySupported+",   ",e+="Z.xmlHttpRequestSupport="+Z.xmlHttpRequestSupport+",   ",e+="Z.definePropertySupported="+Z.definePropertySupported+",   ",e+="Z.responseArraySupported="+Z.responseArraySupported+",   ",e+="Z.responseArrayPrototyped="+Z.responseArrayPrototyped+",   ",e+="Z.mobileDevice="+Z.mobileDevice+",   ",e+="Z.zifSupported="+Z.zifSupported+",   ",e+="Z.localUse="+Z.localUse+"\n",e+="\n",e+="VIEWER OPTIONS & DEFAULTS:    ",e+="Z.initialX="+Z.initialX+",   ",e+="Z.initialY="+Z.initialY+",   ",e+="Z.initialZ="+Z.initialZ+",   ",e+="Z.minZ="+Z.minZ+",   ",e+="Z.maxZ="+Z.maxZ+",   ",e+="Z.fitZ="+Z.fitZ+",   ",e+="Z.zoomSpeed="+Z.zoomSpeed+",   ",e+="Z.panSpeed="+Z.panSpeed+",   ",e+="Z.fadeInSpeed="+Z.fadeInSpeed+",   ",e+="Z.toolbarVisible="+Z.toolbarVisible+",   ",e+="Z.toolbarW="+Z.toolbarW+",   ",e+="Z.toolbarCurrentW="+Z.toolbarCurrentW+",   ",e+="Z.toolbarH="+Z.toolbarH+",   ",e+="Z.toolbarPosition="+Z.toolbarPosition+",   ",e+="Z.tooltipsVisible="+Z.tooltipsVisible+",   ",e+="Z.helpVisible="+Z.helpVisible+",   ",e+="Z.navigatorVisible="+Z.navigatorVisible+",   ",e+="Z.navigatorW="+Z.navigatorW+",   ",e+="Z.navigatorH="+Z.navigatorH+",   ",e+="Z.navigatorL="+Z.navigatorL+",   ",e+="Z.navigatorT="+Z.navigatorT+",   ",e+="Z.navigatorFit="+Z.navigatorFit+",   ",e+="Z.clickZoom="+Z.clickZoom+",   ",e+="Z.clickPan="+Z.clickPan+",   ",e+="Z.mousePan="+Z.mousePan+",   ",e+="Z.keys="+Z.keys+",   ",e+="Z.constrainPan="+Z.constrainPan+",   ",e+="Z.constrainPanStrict="+Z.constrainPanStrict+",   ",e+="Z.smoothPan="+Z.smoothPan+",   ",e+="Z.smoothPanEasing="+Z.smoothPanEasing+",   ",e+="Watermark alpha = "+Z.Utils.getResource("DEFAULT_WATERMARKALPHA")+",   ",e+="Z.watermarkPath="+Z.watermarkPath+",   ",e+="Z.copyrightPath="+Z.copyrightPath+",   ",e+="Z.hotspotPath="+Z.hotspotPath+",   ",e+="Z.tourPath="+Z.tourPath+",   ",e+="Z.slidePath="+Z.slidePath+",   ",e+="Z.slideTransitionSpeed="+Z.slideTransitionSpeed+",   ",e+="Z.audioContent="+Z.audioContent+",   ",e+="Z.audioMuted="+Z.audioMuted+",   ",e+="Z.annotationPath="+Z.annotationPath+",   ",e+="Z.saveHandlerPath="+Z.saveHandlerPath+",   ",e+="Z.minimizeVisible="+Z.minimizeVisible+",   ",e+="Z.sliderZoomVisible="+Z.sliderZoomVisible+",   ",e+="Z.panButtonsVisible="+Z.panButtonsVisible+",   ",e+="Z.resetVisible="+Z.resetVisible+",   ",e+="Z.fullScreenVisible="+Z.fullScreenVisible+",   ",e+="Z.fullPageVisible="+Z.fullPageVisible+",   ",e+="Z.initialFullPage="+Z.initialFullPage+",   ",e+="Z.measureVisible="+Z.measureVisible+",   ",e+="Z.captionTextColor="+Z.captionTextColor+",   ",e+="Z.captionBackColor="+Z.captionBackColor+",   ",e+="Z.polygonLineColor="+Z.polygonLineColor+",   ",e+="Z.polygonFillColor="+Z.polygonFillColor+",   ",e+="Z.captionTextVisible="+Z.captionTextVisible+",   ",e+="Z.captionBackVisible="+Z.captionBackVisible+",   ",e+="Z.polygonFillVisible="+Z.polygonFillVisible+",   ",e+="Z.polygonLineVisible="+Z.polygonLineVisible+",   ",e+="Z.rotationVisible="+Z.rotationVisible+",   ",e+="Z.initialRotation="+Z.initialRotation+",   ",e+="Z.virtualPointerVisible="+Z.virtualPointerVisible+",   ",e+="Z.crosshairsVisible="+Z.crosshairsVisible+",   ",e+="Z.rulerVisible="+Z.rulerVisible+",   ",e+="Z.units="+Z.units+",   ",e+="Z.unitsPerImage="+Z.unitsPerImage+",   ",e+="Z.pixelsPerUnit="+Z.pixelsPerUnit+",   ",e+="Z.sourceMagnification="+Z.sourceMagnification+",   ",e+="Z.rulerListType="+Z.rulerListType+",   ",e+="Z.rulerW="+Z.rulerW+",   ",e+="Z.rulerH="+Z.rulerH+",   ",e+="Z.rulerL="+Z.rulerL+",   ",e+="Z.rulerT="+Z.rulerT+",   ",e+="Z.coordinatesVisible="+Z.coordinatesVisible+",   ",e+="Z.progressVisible="+Z.progressVisible+",   ",e+="Z.logoVisible="+Z.logoVisible+",   ",e+="Z.logoLinkURL="+Z.logoLinkURL+",   ",e+="Z.logoCustomPath="+Z.logoCustomPath+",   ",e+="Z.canvas="+Z.canvas+",   ",e+="Z.debug="+Z.debug+",   ",e+="Z.imageProperties="+Z.imageProperties+",   ",e+="Z.serverIP="+Z.serverIP+",   ",e+="Z.serverPort="+Z.serverPort+",   ",e+="Z.tileSource="+Z.tileSource+",   ",e+="Z.tileType="+Z.tileType+",   ",e+="\n",e+="INTERNAL VALUES:    ",e+="\n",e+="displayW="+Z.Viewport.getDisplayW()+",   ",e+="displayH="+Z.Viewport.getDisplayH()+",   ",e+="tierCurrent="+Z.Viewport.getTierCurrent()+",   ",e+="tierBackfill="+Z.Viewport.getTierBackfill()+",   ",e+="tierBackfillDynamic="+Z.Viewport.getTierBackfillDynamic()+",   ",e+="tierBackfillOversize="+Z.Viewport.getTierBackfillOversize()+",   ",e+="tierScale="+Z.Viewport.getTierScale()+",   ",e+="TIERS_SCALE_UP_MAX="+Z.Viewport.getTiersScaleUpMax()+",   ",e+="TIERS_SCALE_DOWN_MAX="+Z.Viewport.getTiersScaleDownMax()+",   ",e+="TILES_CACHE_MAX="+Z.Viewport.getTilesCacheMax()+",   ",e+="Z.useCanvas="+Z.useCanvas+"\n",e+="Z.editMode="+Z.editMode+"\n",e+="Z.labelMode="+Z.labelMode+"\n",e+="Z.editing="+Z.editing+"\n",e+="\n",e+="INTERNAL LISTS:    ",e+="tierWs="+Z.Viewport.getTierWs()+",   ",e+="tierHs="+Z.Viewport.getTierHs()+",   ",e+="tierTileCounts="+Z.Viewport.getTierTileCounts()+",   ",e+="tilesLoadingNames="+Z.Viewport.getTilesLoadingNames()+"\n",e+="\n",alert(e)
}};